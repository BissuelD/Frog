<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>5.1. How to create Diagram? &#8212; Frog 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../_static/_static/css/s4defs-roles.css" />
    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="5.2. Diagram available" href="diagram_list.html" />
    <link rel="prev" title="5. Diagram" href="diagram_index.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <blockquote>
<div></div></blockquote>
<section id="how-to-create-diagram">
<span id="how-to-creat-diagram-page"></span><h1><span class="section-number">5.1. </span>How to create Diagram?<a class="headerlink" href="#how-to-create-diagram" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#declare-diagrams" id="id3">Declare diagrams</a></p></li>
<li><p><a class="reference internal" href="#geometry-selection" id="id4">Geometry selection</a></p>
<ul>
<li><p><a class="reference internal" href="#averaged" id="id5">Averaged</a></p></li>
<li><p><a class="reference internal" href="#plane" id="id6">Plane</a></p></li>
<li><p><a class="reference internal" href="#layer" id="id7">Layer</a></p></li>
<li><p><a class="reference internal" href="#special-selection" id="id8">Special selection</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#optical-analysis" id="id9">Optical Analysis</a></p></li>
</ul>
</nav>
<section id="declare-diagrams">
<h2><a class="toc-backref" href="#id3" role="doc-backlink"><span class="section-number">5.1.1. </span>Declare diagrams</a><a class="headerlink" href="#declare-diagrams" title="Link to this heading">¶</a></h2>
<p>To declare a new analysis for a MT, a diagram should be declared using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">input_for_diagram_1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">,</span> <span class="s1">&#39;Plane_xy&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
<span class="n">input_for_diagram_2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;molecular_orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;Plane_xz&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="s1">&#39;independent&#39;</span><span class="p">]</span>
<span class="n">L_diagram_analysis_to_perform</span><span class="o">=</span><span class="p">[</span><span class="n">input_for_diagram_1</span><span class="p">,</span> <span class="n">input_for_diagram_2</span><span class="p">]</span>
<span class="n">moleculetype</span><span class="o">.</span><span class="n">read_diagram_input</span><span class="p">(</span><span class="n">GP</span><span class="p">,</span> <span class="n">L_diagram_analysis_to_perform</span><span class="p">)</span>
</pre></div>
</div>
<p>The <span class="incremental">read_diagram_input</span> function takes as first argument the GlobalParameter of the calculation, and as second argument the list containing the user-input for every diagram – <span class="incremental">L_diagram_analysis_to_perform</span>. An extra optional argument can also be added, see bellow.</p>
<p>Each element of the <span class="incremental">L_diagram_analysis_to_perform</span> list defines the parameter for one diagram. The order does not matter. The standard shape have at least 3 parameters:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">analysis_type</span><span class="p">,</span> <span class="n">geometrical_discretization</span><span class="p">,</span> <span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>
</pre></div>
</div>
<p>Where ‘analysis_type’ is one of the <a class="reference internal" href="diagram_list.html#diagram-list-page"><span class="std std-ref">analysis available</span></a> (‘density’ or ‘alpha’ for instance: no capital letter), ‘geometrical_discretization’ is the discretization (‘Averaged’ or ‘Plane_xy’ for instance, see <a class="reference internal" href="#diagram-geometry-selection-page"><span class="std std-ref">bellow</span></a>) and ‘N’ refers to the bin number used for the geometrical discretization. In all the documentation, ‘N’ refers always to the geometrical discretization, and is always the first element of the list defined as the third argument. For instance, the first diagram input in the previous example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">input_for_diagram_1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">,</span> <span class="s1">&#39;Plane_xy&#39;</span><span class="p">,</span> <span class="mi">100</span><span class="p">]</span>
</pre></div>
</div>
<p>declares a density analysis, with geometrical discretization along the laboratory z-axis. 100 bin are used to discretised this z-axis.  More parameters and bin number can be set after this minimal basis. For instance:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">input_for_diagram_2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;molecular_orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;Plane_xy&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="s1">&#39;independent&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>declares a ‘molecular orientation’ analysis, with geometrical discretization along the laboratory y-axis. 50 bin are used to discretised this y-axis.  The independent probability distribution will be computed for the molecular orientation – see  <a class="reference internal" href="diagram_list.html#autodoc-diagram-molecular-orientation"><span class="std std-ref">the molecular orientation diagram documentation</span></a> for more information. 100 bins are used to discretize each molecular orientation dimension. For the case of water, 3 angle represents the molecule’s orientation. The final diagram will be a list of size 100x50x50x50.</p>
<p>To sumarize: the third argument is a <strong>list</strong> containing the bin number for each discretization: [N, M1, M2…]. The first number N allways refers to the geometrical discretization, defined by the second argument <span class="incremental">geometrical_discretization</span>. The other number are used to discretize the observable relative to the analysis required and <strong>depends</strong> on the analysis type. See the <a class="reference internal" href="diagram_list.html#diagram-list-page"><span class="std std-ref">analysis available page</span></a> for more informations.</p>
<p>For concrete example of how the discretization is performed, see <a class="reference internal" href="#diagram-geometry-selection-page"><span class="std std-ref">bellow</span></a> or <a class="reference internal" href="diagram_structure.html#autodoc-diagram-value"><span class="std std-ref">here</span></a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parameters relative to a diagram generated by the <span class="incremental">moleculetype.read_diagram_input</span> function is stored in a <a class="reference internal" href="diagram_structure.html#single-diagram-parameter-page"><span class="std std-ref">single diagram parameter object</span></a>.</p>
</div>
<p>Given the previous arguments, the <a class="reference internal" href="diagram_structure.html#autodoc-diagram-name"><span class="std std-ref">name of the diagramm</span></a> is constructed. The name of any diagram starts with the analysis type, then the discretization of the space and finally other properties depending of the analysis type. For instance, the diagram obtained with the input <span class="incremental">[‘density’, ‘Plane_xy’, [100]]</span> will have the name <span class="incremental">density_slice_z</span>, the diagram with input <span class="incremental">[‘molecular_orientation’, ‘Averaged’, [1, 45]]</span> will have the name molecular_orientation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>For the optical analysis, the name can be also update later on depending on the optical parameter set.</p>
</div>
<p>You may define several diagram of the same analysis for a given MT as long as the diagram name are different. For instance, for a ‘molecular orientation’ analysis, you can define an ’Averaged’ diagram and one discretized in space:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">input_for_diagram_1</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;molecular_orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;Averaged&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">180</span><span class="p">],</span> <span class="s1">&#39;independent&#39;</span><span class="p">]</span>
<span class="n">input_for_diagram_2</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;molecular_orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;Plane_xy&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">50</span><span class="p">,</span> <span class="mi">45</span><span class="p">],</span> <span class="s1">&#39;independent&#39;</span><span class="p">]</span>
</pre></div>
</div>
<p>The first diagram name is <span class="incremental">molecular_orientation</span>, and the second <span class="incremental">molecular_orientation_slice_z</span>. In this case, the first one will have very hight discretization of the observable (180 bin), and will give a nice distribution for all the molecule in the box. The second shows how the molecular orientation evolve along the laboratory z-axis.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>If you declare 2 times a diagram with the same name, problems may (very probably) happens. There is a safeguard  to prevent this.</p>
</div>
<p>In the following is presented how the geometrical selection works in details.</p>
</section>
<section id="geometry-selection">
<span id="diagram-geometry-selection-page"></span><h2><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">5.1.2. </span>Geometry selection</a><a class="headerlink" href="#geometry-selection" title="Link to this heading">¶</a></h2>
<p>To define every diagram, you have to set the geometric selection type, <em>i.e.</em> the second argument of every diagram declaration:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L_diagram_analysis_to_perform</span> <span class="o">=</span> <span class="p">[[</span><span class="n">analysis_type</span><span class="p">,</span> <span class="n">geometrical_discretization</span><span class="p">,</span> <span class="nb">bin</span><span class="p">,</span> <span class="n">other</span> <span class="n">parameters</span><span class="o">...</span><span class="p">],</span> <span class="o">...</span><span class="p">]</span>
<span class="n">moleculetype</span><span class="o">.</span><span class="n">read_diagram_input</span><span class="p">(</span><span class="n">GP</span><span class="p">,</span> <span class="n">L_diagram_analysis_to_perform</span><span class="p">,</span> <span class="n">special_selection</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<p>The <span class="incremental">geometrical_discretization</span> can have the value:</p>
<blockquote>
<div><ul class="simple">
<li><p>‘Averaged’</p></li>
<li><p>‘Plane_ij’</p></li>
<li><p>‘Layer’</p></li>
</ul>
</div></blockquote>
<p>and are explained bellow. If you want to refine your geometrical discretization, you can use the <a class="reference internal" href="#special-selection-page"><span class="std std-ref">special_selection</span></a> option.</p>
<section id="averaged">
<h3><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">5.1.2.1. </span>Averaged</a><a class="headerlink" href="#averaged" title="Link to this heading">¶</a></h3>
<p>If you do not want to have all the molecule of the MT contributing indistinguishibly use the ‘Averaged’ input. Then, the mean and the distribution of this analysis will be made over all the molecule available. In the code and in this doc, this configuration is often refers to ‘no geometrical selection’ or ‘no space-discretization’.</p>
<p>This case is used for bulk simulation for instance.</p>
</section>
<section id="plane">
<h3><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">5.1.2.2. </span>Plane</a><a class="headerlink" href="#plane" title="Link to this heading">¶</a></h3>
<p>If you want to discretize over a given axis of the laboratory frame, use the ‘Plane_ij’ selection – where i,j are
x,y,z.
The ‘Plane_ij ‘options  means that space discretization along one axis is done. For instance, if ’Plane_yz’ is set, an extra discretization with respect to the molecule’s mean position along the x-axis is done. Note that the discretization is done with respect to the box size of every time step.</p>
<p>In this example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L_diagram_analysis_to_perform</span> <span class="o">=</span> <span class="p">[</span>
<span class="p">[</span><span class="s1">&#39;chi&#39;</span><span class="p">,</span> <span class="s1">&#39;Averaged&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">100</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">15</span><span class="p">,</span> <span class="mi">15</span><span class="p">]],</span>
<span class="p">[</span><span class="s1">&#39;chi&#39;</span><span class="p">,</span> <span class="s1">&#39;Plane_xy&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],</span>
<span class="p">]</span>
<span class="n">moleculetype</span><span class="o">.</span><span class="n">read_diagram_input</span><span class="p">(</span><span class="n">GP</span><span class="p">,</span> <span class="n">L_diagram_analysis_to_perform</span><span class="p">)</span>
</pre></div>
</div>
<p>2 diagrams with the same total information are created, but with not the same distribution parameters. The chi analysis represent 3x3x3 matrices, and are stored using 27 elements.</p>
<p>The first diagram contains the information of all the molecule in the MD box. Its name is ‘chi’ 100 bins is used to discretized each chi components and the discretisation of each component is made between the value -15 and 15 a.u. . Each bin correspond to an extention of 0.3 a.u. . The distribution (<a class="reference internal" href="diagram_structure.html#autodoc-diagram-value"><span class="std std-ref">value attribute of the diagram</span></a>) is a 27x100 array. <span class="incremental">mydiagram.value[4][0]</span> contains how many molecule has its 5th chi components between -15 and -14.7 a.u. . The <a class="reference internal" href="diagram_structure.html#autodoc-diagram-mean"><span class="std std-ref">mean value</span></a> is an array with 27 elements. <span class="incremental">mydiagram.mean[1]</span> is the mean value of the second chi component.</p>
<p>The second diagram contains the information of all the molecule in the MD box, but discretized along the z laboratory axis. Its name is ‘chi_slice_z’. The individual chi value of the molecule contribute to a specific part of the distribution according to the molecule’s position along the z-axis. Here, 100 bin are used to discretized this z-axis. The size of the bin depends on the MD box-size (updated for every time step). These bin are often called ‘altitude’ in the rest of the documentation. The total number of molecule which have participated to a given ‘altitude’ in the general case be obtained by summing over all the other bin for a given altitude – see below for example. Moreover, in most of the analysis, the <a class="reference internal" href="diagram_structure.html#autodoc-diagram-axis-population"><span class="std std-ref">mean value</span></a> are also computed. This <a class="reference internal" href="diagram_structure.html#autodoc-diagram-mean"><span class="std std-ref">axis_population attribute</span></a> contains directly the number of molecule which have contributed to this altitude.</p>
<p>As for the first diagram, the discretization over the chi element value is also performed: 50 bins are used. The discretisation of each component is made between the value -10 and 10 a.u. . Each bin correspond to an extention of 0.4 a.u. . The distribution (<a class="reference internal" href="diagram_structure.html#autodoc-diagram-value"><span class="std std-ref">value attribute of the diagram</span></a>) is a 100x27x50 array.  <span class="incremental">mydiagram.value[5][4][0]</span> contains how many molecule has its 5th chi components between -10 and -9.6 a.u. and their mean position within the 6th altitude. For example, if the MD box size along the z-direction is 100 A, it correspond to molecule within 5 and 6 A along the z-direction.  The <a class="reference internal" href="diagram_structure.html#autodoc-diagram-mean"><span class="std std-ref">mean value</span></a> is an 100x27 array. <span class="incremental">mydiagram.mean[5][1]</span> is the mean value of the second chi component for the molecule within the 6th altitude.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The altitude attribution is made over each frame. Both the position of the molecule at each time step and the MD box size are updated.</p>
</div>
<p>To plot the results, an <a class="reference internal" href="diagram_structure.html#autodoc-diagram-axis-space"><span class="std std-ref">axis_space</span></a> is created: it contains the altitudes values expressed in angstrom. For instance, if you want to plot the mean value of the chi third component along the z-axis:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">my_diagram</span><span class="o">..</span><span class="n">axis_space</span><span class="o">.</span><span class="n">value</span><span class="p">,</span> <span class="n">my_diagram</span><span class="o">.</span><span class="n">mean</span><span class="o">.</span><span class="n">T</span><span class="p">[</span><span class="mi">2</span><span class="p">])</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="diagram_analysis.html#diagram-analysis-page"><span class="std std-ref">this page</span></a> for more information about ploting diagrams.</p>
</section>
<section id="layer">
<span id="diagram-space-discretization-layer-subpage"></span><h3><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">5.1.2.3. </span>Layer</a><a class="headerlink" href="#layer" title="Link to this heading">¶</a></h3>
<p><strong>General informations:</strong></p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Je commence par expliquer en quoi la description par layer est interressante. J enfonce peut etre des portes ouvertes, au pire cette explication servira aussi pour autre chose que je devrait ecrire!</p>
</div>
<p>Using the molecule position with respect to the laboratory frame is unambigious, but may not be the best space-description possible. Indeed, what is important is not the position of the molecule in the box, but the position of the molecule with respect to the interface. In some cases, the interface landscape can flucutates, for instance in liquid-vapor interfaces due to thermal effects, and this distance can be hard to compute.</p>
<p>A new standard is to describes the molecule by layers. Indeed, for the most external part of the interface, the molecule’s characteristics can be more accuretly described using the molecule layer then the molecule position with respect to the interface. Bellow is presented for the water at the liquid-air interface (TIP4P/2005 force field, 300K) the population of the different ‘layer’ with respect to the laboratory out-of-plane direction. In black the total density, the larger the layer number, the more external is the molecule.</p>
<a class="reference internal image-reference" href="../_images/density_layer.png"><img alt="../_images/density_layer.png" class="align-center" src="../_images/density_layer.png" style="width: 1200px;" /></a>
<p>The total density close to the interface follows a tanh shape. The differents ‘layers’ cover few angstrom and overlaps. Note that for an solid-liquid interface, the layer would overlap less and the more external one would be closer to a dirac. The widith of each layer and the overlaping are due to thermal fluctuations of the interface. Therefore, if for some system the molecule absolute position and its layer give the same information (solid-liquid interfaces for instance), in the general case the layer attribution can provide a finner molecule-oriented description.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In <img class="math" src="../_images/math/64ce76395a21d936e0f8a927bf1facabfed5a750.png" alt="\texttt{FROG}"/> may not have to choose: you can use both!</p>
</div>
<p>In <img class="math" src="../_images/math/64ce76395a21d936e0f8a927bf1facabfed5a750.png" alt="\texttt{FROG}"/>, it is made possible by the use of the module pytim. ADD REF. Here is explained briefly how to use this module within <img class="math" src="../_images/math/64ce76395a21d936e0f8a927bf1facabfed5a750.png" alt="\texttt{FROG}"/>, but for more information, we warmly recommand to see the original pytim documentation. ADD REF. This method aims to define for an MD frame the interfaces, and for each interface the different layer: from the most external one to the almost bulk like.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The layer attribution has been tested only for 2D liquid-vacuum interfaces where there are only 2 interfaces. If you are using other type of interfaces please contact us. We are quite confident that it would work for other types of interface, but some numerical adjustment may be needed.</p>
</div>
<p><strong>In practice:</strong></p>
<p>As for the other type of space-discretization, you should use ‘Layer’ and declare the number of layer you want to use for each interfaces:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L_diagram_analysis_to_perform</span> <span class="o">=</span> <span class="p">[</span>
<span class="p">[</span><span class="s1">&#39;chi&#39;</span><span class="p">,</span> <span class="s1">&#39;Layer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],</span>
<span class="p">]</span>
<span class="n">moleculetype</span><span class="o">.</span><span class="n">read_diagram_input</span><span class="p">(</span><span class="n">GP</span><span class="p">,</span> <span class="n">L_diagram_analysis_to_perform</span><span class="p">)</span>
</pre></div>
</div>
<p>Here, a diagram with name ‘molecular_orientation_layer’ is created. The size of the diagram is 7x3x50. The 7=2*3+1 is used to discretize over the layer. The first 3 elements are the layers of the bottom interface, the 4th element stands for the bulk-like phase, and the last 3 elements are the layers of the upper interface. In <img class="math" src="../_images/math/64ce76395a21d936e0f8a927bf1facabfed5a750.png" alt="\texttt{FROG}"/>, the layer number can be negative or positive for the bottom and upper interface respectively. The more the layer number is away from 0, the more the laye is far from the bulk-like phase. The other dimension of the diagram are given independently of the space-discretization.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>for more information about how the layer value are stored for each molecule, see the <a class="reference internal" href="../MoleculeType/mt_structure.html#single-molecule-object-page"><span class="std std-ref">singlemolecule attribute layer</span></a></p>
</div>
<p>If several layer discretization type are required, a attribute, <a class="reference internal" href="../GlobalParameter/none_user_defined.html#autodoc-gp-layer-nbr-max"><span class="std std-ref">GP.layer_nbr_max</span></a> tracks the maximal layer number declared – acrros all over the declaration: diagrams, QM calculation or other MTs. The layer attribution for each molecule is done once using this GP.layer_nbr_max value. For the diagrams, the layers are reassigned properly.</p>
<p>Example:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">L_diagram_analysis_to_perform</span> <span class="o">=</span> <span class="p">[</span>
<span class="p">[</span><span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;Layer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],</span>
<span class="p">[</span><span class="s1">&#39;chi&#39;</span><span class="p">,</span> <span class="s1">&#39;Layer&#39;</span><span class="p">,</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">50</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">]],</span>
<span class="p">]</span>
<span class="n">moleculetype</span><span class="o">.</span><span class="n">read_diagram_input</span><span class="p">(</span><span class="n">GP</span><span class="p">,</span> <span class="n">L_diagram_analysis_to_perform</span><span class="p">)</span>
</pre></div>
</div>
<p>In this example (assuming that no other layer space-discretization are set elsewhere), GP.layer_nbr_max = 4. Therefore, each molecule layer number go from -4 to 4. 0 being the ‘bulk-like’ attribution. For the chi diagram space-discretization, the attribution is straightforeward since the number of layer used matches GP.layer_nbr_max.</p>
<p>For the beta diagram, the discretization is smaller then the GP.layer_nbr_max. For the upper interface for instance, there are 4+1 layers values (+4, +3, +2, +1 and 0, 0 being the bulk like phase) possible for every molecule. But, for the beta diagram, only 2+1 value are required (+2, +1 and 0). Therefore, a reasignation is needed. The most inner layers are thus considerated as ‘bulk’, to keep the outter ones in the discretization. In this example, a molecule with layer assigment +4 is assigned in the diagram as +2, +3 becomes +1, and +2 or +1 becomes 0.</p>
<p>In other words, the most outter layers are considerated as the most important: there are always the first and last element (for the bottom and upper interface respectively) of the space-discretization in the case of layer.</p>
<p>An important parameter for the layer attribution is the VDW radius used by pytim. The ways it is handle by <img class="math" src="../_images/math/64ce76395a21d936e0f8a927bf1facabfed5a750.png" alt="\texttt{FROG}"/> is described in the attribute definition used to set the method: <a class="reference internal" href="../GlobalParameter/usual_parameters.html#autodoc-gp-layer-which-radii-mt"><span class="std std-ref">GP.layer_which_radii_MT</span></a>. In short:</p>
<blockquote>
<div><ul class="simple">
<li><p>GP.layer_which_radii_MT = ‘MD’: the VDW radius are guessed from the MD simulation.</p></li>
<li><p>GP.layer_which_radii_MT = ‘MT’: the VDW radius are defined for each MTs using the molecular library files.</p></li>
<li><p>GP.layer_which_radii_MT = mydict: where mydict is a user-defined dictionary defining the radii.</p></li>
</ul>
</div></blockquote>
<p>For more information, see the <a class="reference external" href="https://marcello-sega.github.io/pytim/guessing_radii.html">https://marcello-sega.github.io/pytim/guessing_radii.html</a> pytim documentation page.</p>
<p>Finally, see the tutorial TODO for pratical example of the layer attribution uses.</p>
</section>
<section id="special-selection">
<span id="special-selection-page"></span><h3><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">5.1.2.4. </span>Special selection</a><a class="headerlink" href="#special-selection" title="Link to this heading">¶</a></h3>
<p><strong>The phylosophy:</strong></p>
<p>For interfaces analysis, in fact most of the system is not of primor interest. Indeed, the bulk-like phase built during the MD is not the part where the observable are often made. Therefore, in <img class="math" src="../_images/math/64ce76395a21d936e0f8a927bf1facabfed5a750.png" alt="\texttt{FROG}"/>, 2 options have been made to reduce the computation time and to help focus on the relevent part. One is this specital selection acting on the diagram analysis level, and the other is the optical option TODO – which determines which molecule should be QM-treated.</p>
<p>All the molecule of the MD simulation shall be assigned to an MT: some analysis may required to built neigborhood up to several nanometers and indistinguishably of the MT neigbors type. This special selection set for each MD frame and for a given MT which molecule should be analysis using the diagram declared for this MT. The selection is made over the usual space-discretization type keywords and options. Indeed, no matter what the position of each molecule (and the layer if any layer discretization is required) are computed for each frame.</p>
<p>If a molecule does not match the special requirement at a given time step, the analysis for this molecule will not be perfromed, and thus the diagram will not be impact by this molecule.</p>
<p><strong>Pratical use:</strong></p>
<p>An example of the special selection use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>L_diagram_analysis_to_perform = [
[&#39;density&#39;, &#39;Plane_xy&#39;, [100]],
[&#39;density&#39;, &#39;Plane_yz&#39;, [100]],
[&#39;beta&#39;, &#39;Averaged&#39;, [1, 50], [-10, 10]],
[&#39;chi&#39;, &#39;Layer&#39;, [4, 50], [-10, 10]],
]
special_selection = [’Plane_xy’, 100, [50, 63, 64]]
moleculetype.read_diagram_input(GP, L_diagram_analysis_to_perform, special_selection=special_selection)
</pre></div>
</div>
<p>The special selection acts as a Plane space discretization: each molecule’s position is discretize along it z-laboratory axis value using 100 bins. If the obtained bin number is 50, 63 or 64, all the analysis are performed. If not, no analysis is performed for this molecule and all the diagram are not update.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This procedure is repeated each time step. The molecule of the MTs which participate to the analysis are stored in <span class="incremental">myMT.mtparameter.dparameter.L_allowed_molecule&lt;autodoc_diagramparameter_L_allowed_molecule&gt;</span>.</p>
</div>
<p>The diagram are impacted differently according to theire space-discretization. If there space discretization is different, then the diagram size is not changed. For the Averaged one, like the beta analysis, the population is reduced. But since no space discretization is used here, it is as if the MD simulation have been reduced to a smaller part.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An input like: moleculetype.read_diagram_input(GP, [[‘beta’, ‘Averaged’, [1, 50], [-10, 10]]], special_selection = [’Plane_xy’, 100, [50]]) will return the same information as the 50th bins of an input like: moleculetype.read_diagram_input(GP, [[‘beta’, ‘Plane_xy’, [100, 50], [-10, 10]]], special_selection = False)</p>
</div>
<p>For the Plane discretization with <strong>different</strong> axis or layer, the diagram size is not changed. The population participating to each bin will be different.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>An input like: moleculetype.read_diagram_input(GP, [[‘density’, ‘Plane_xy’, [100]]], special_selection = [’Layer’, 4, [4]]) shows the density along the z-axis of the layer 4.)</p>
</div>
<p>For the Plane discretization with the <strong>same</strong> axis, the diagram size is set to match with the authorised one. Indeed, in this case <img class="math" src="../_images/math/64ce76395a21d936e0f8a927bf1facabfed5a750.png" alt="\texttt{FROG}"/> can knows which bin will be by definition not used. In this case, the diagram.space_axis will also be update to match with the new assignment. In this case, the density_slice_z diagram will have only 3 bins, describing the 50th, 63th and 64th absolute altitudes.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This option is also handy to reduce the size of the diagrams, meaning less memory-demanding.</p>
</div>
<p>Here is breifly described all the possible argument of the special_selection:</p>
<blockquote>
<div><ul class="simple">
<li><p>No selection: Just set the special_selection to False, or do not set it at all as it the default value.</p></li>
<li><p>Plane: special_selection = [’Plane_ij’, bin_number, lis_of_authorised_bin], where i, j are x, y, z. The bin_number is the number of bin used to discretize the k-laboratory axis. The lis_of_authorised_bin defines which bin should be treated.</p></li>
<li><p>Layer: special_selection = [’Layer’, layer_number, list_of_authorised_layer], where layer_number is the number of layer to attribute per interface. The list_of_authorised_layer can go from -layer_number to +layer_number. For more information about the layer attribution behaviour, see the previous section about the layer type space-discretization.</p></li>
</ul>
</div></blockquote>
<p>For more complete information about the special selection, see the relative attributes in the diagram parameter object: <a class="reference internal" href="diagram_structure.html#autodoc-diagramparameter-special-selection"><span class="std std-ref">spcial_selection</span></a>.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>finir d ecrire les L_reassignation_selection et real_space_discretization_bin_number dans le diagram structure (cf python les derniers objects de SingleDiagramParameter).</p>
</div>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>verifier que le L_allowed_molecule est bien documente dans le diagram structure, pareil pour le spcial_selection</p>
</div>
</section>
</section>
<section id="optical-analysis">
<h2><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">5.1.3. </span>Optical Analysis</a><a class="headerlink" href="#optical-analysis" title="Link to this heading">¶</a></h2>
<p>To conclude this page, in <img class="math" src="../_images/math/64ce76395a21d936e0f8a927bf1facabfed5a750.png" alt="\texttt{FROG}"/> is defined two different types of analysis: “structural” and “optical”. The structural ones demand only the MD trajectory as input, whereas “optical” ones also demand additional inputs – mainly to perform QM calculation. In more details : the analysis ’density’, ’molecular_orientation’, ’hbond’, ’rdf’ and ’electric_field’ are “structural” while ’alpha’, ’iota’, ’beta’, ’chi’ are ’optical’. The procedure to initialize the “structural” properties are defined in the <a class="reference internal" href="diagram_list.html#diagram-list-page"><span class="std std-ref">available analysis page</span></a>, while the “optical” ones demand more parameters, described Here.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/frog_logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Installation/how_to_install_frog.html">1. How to Install Frog?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials/tutorial_index.html">2. Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GlobalParameter/gp_index.html">3. Global Parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../MoleculeType/mt_index.html">4. Molecule Type</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="diagram_index.html">5. Diagram</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">5.1. How to create Diagram?</a></li>
<li class="toctree-l2"><a class="reference internal" href="diagram_list.html">5.2. Diagram available</a></li>
<li class="toctree-l2"><a class="reference internal" href="diagram_analysis.html">5.3. Diagram analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="diagram_structure.html">5.4. Diagram Structure</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../OpticalAnalysis/optical_analysis_index.html">6. Optical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Frog.html">7. Frog package</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Guillaume Le Breton.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/Diagram/how_to_creat_diagram.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>