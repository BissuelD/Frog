<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Frog.class_DiagramParameter &#8212; Frog 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../../_static/_static/css/s4defs-roles.css" />
    <script src="../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for Frog.class_DiagramParameter</h1><div class="highlight"><pre>
<span></span><span class="c1">##############################################################################</span>
<span class="c1">#                                                                            #</span>
<span class="c1">#    FROG: FROm molecular dynamics to second harmonic Generation             #</span>
<span class="c1">#    Copyright (C) 2024                                                      #</span>
<span class="c1">#    Author list                                                             #</span>
<span class="c1">#                                                                            #</span>
<span class="c1">#    Guillaume Le Breton                                                     #</span>
<span class="c1">#    Oriane Bonhomme                                                         #</span>
<span class="c1">#    Emmanuel Benichou                                                       #</span>
<span class="c1">#    Claire Loison                                                           #</span>
<span class="c1">#                                                                            # </span>
<span class="c1">#    This program is free software: you can redistribute it and/or modify    #</span>
<span class="c1">#    it under the terms of the GNU General Public License as published by    #</span>
<span class="c1">#    the Free Software Foundation, either version 3 of the License, or       #</span>
<span class="c1">#    (at your option) any later version.                                     #</span>
<span class="c1">#                                                                            #</span>
<span class="c1">#    This program is distributed in the hope that it will be useful,         #</span>
<span class="c1">#    but WITHOUT ANY WARRANTY; without even the implied warranty of          #</span>
<span class="c1">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the           #</span>
<span class="c1">#    GNU General Public License for more details.                            #</span>
<span class="c1">#                                                                            #</span>
<span class="c1">#    You should have received a copy of the GNU General Public License       # </span>
<span class="c1">#    along with this program.  If not, see &lt;https://www.gnu.org/licenses/    #</span>
<span class="c1">#                                                                            #</span>
<span class="c1">##############################################################################</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">logging</span>

<span class="kn">import</span> <span class="nn">Frog.class_modules</span> <span class="k">as</span> <span class="nn">class_modules</span>
<span class="kn">import</span> <span class="nn">Frog.class_Diagrams</span> <span class="c1"># as class_Diagrams</span>

<span class="kn">import</span> <span class="nn">Frog.geometry_manager</span> <span class="k">as</span> <span class="nn">geometry_manager</span>
<span class="kn">import</span> <span class="nn">Frog.messages</span> <span class="k">as</span> <span class="nn">messages</span>
<span class="kn">import</span> <span class="nn">Frog.error_messages</span> <span class="k">as</span> <span class="nn">error_messages</span>
<span class="kn">from</span> <span class="nn">Frog.error_messages</span> <span class="kn">import</span> <span class="n">NotAnOptionError</span>

<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################            </span>

<div class="viewcode-block" id="DiagramParameter">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.DiagramParameter">[docs]</a>
<span class="k">class</span> <span class="nc">DiagramParameter</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This class holds the diagrams parameters to be performed for all molecule types. </span>
<span class="sd">        </span>
<span class="sd">        In the attribute &#39;L_possible_diagram&#39; is stored all the possible values of diagrams available in the code. Please note that if you want to develop another type of analysis, you have to add the name of the analysis in this list and also add a subclass of Diagram with the name: Dia_&lt;your analysis name &gt;. The way the subclass name is defined with the analysis name  given in the function Frog.class_module.give_class_diagram_name. </span>
<span class="sd">        </span>
<span class="sd">        In the attribute &#39;L_diagram&#39; is stored all the parameter for all the type of analysis. See each subclass for the list of parameter.  The number of analysis to performed is given by the function nbr_analysis. </span>
<span class="sd">        </span>
<span class="sd">        The attribute &#39;IS_&#39; + analysis_type is a shortcut variable to help the code know quickly what analysis should be done or not. It is a boolean. Some of them are useless or redondant (today) but the authors prefere to have them for all the possible analysis so that it can used later on if needed (without having to update various part of the code). </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_possible_diagram</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;density&#39;</span><span class="p">,</span> <span class="s1">&#39;molecular_orientation&#39;</span><span class="p">,</span> <span class="s1">&#39;hbond&#39;</span><span class="p">,</span> <span class="s1">&#39;rdf&#39;</span><span class="p">,</span> <span class="s1">&#39;electric_field&#39;</span><span class="p">,</span> <span class="s1">&#39;alpha&#39;</span><span class="p">,</span> <span class="s1">&#39;iota&#39;</span><span class="p">,</span> <span class="s1">&#39;beta&#39;</span><span class="p">,</span> <span class="s1">&#39;chi&#39;</span><span class="p">]</span> <span class="c1"># update this list to declare new analysis type. Note that effective_field has been kicked out of the available ones. </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;L_diagram&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_rot_mat&#39;</span><span class="p">,</span> <span class="s1">&#39;special_selection&#39;</span><span class="p">,</span> <span class="s1">&#39;L_allowed_molecule&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_diagram</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">diagramtype</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_possible_diagram</span><span class="p">:</span>
            <span class="n">IS_diagram</span> <span class="o">=</span> <span class="s1">&#39;IS_&#39;</span> <span class="o">+</span> <span class="n">diagramtype</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">IS_diagram</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">IS_diagram</span><span class="p">)</span>
        
        <span class="c1"># extra security to avoid any bad calling of the effective part of the code which is not working in today&#39;s version</span>
        <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;IS_effective_field&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="s1">&#39;IS_effective_field&#39;</span><span class="p">)</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">IS_rot_mat</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">special_selection</span> <span class="o">=</span> <span class="kc">False</span>
        
        
        <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Prevent the attribution of undefine object to the class. This help avoiding bad spelling mistakes.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">NotAnOptionError</span><span class="p">(</span><span class="s1">&#39;The name </span><span class="si">%r</span><span class="s1"> is not a valide attribute for the Diagram.&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">NotAnOptionError</span><span class="p">(</span><span class="s1">&#39;The name </span><span class="si">%r</span><span class="s1"> is not a valide attribute for the Diagram.&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>

            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
 <span class="c1">#################################################################################################################################           </span>
<span class="c1">#################################################################################################################################    </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">L_possible_diagram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [list]  </span>
<span class="sd">        </span>
<span class="sd">        All the possible value of analysis/diagrams available in the code. Please note that if you want to develop another type of analysis, you have to add the name of the analysis in this list and also add a subclass of Diagram with the name: Dia_&lt;your analysis name &gt;. The way the subclass name is defined with the analysis name given in the function Frog.class_module.give_class_diagram_name. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_L_possible_diagram</span><span class="p">)</span>
    
    <span class="nd">@L_possible_diagram</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">L_possible_diagram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute DiagramParameter.L_possible_diagram values can only be list.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting the DiagramParameter.L_possible_diagram  name to </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_L_possible_diagram</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">#################################################################################################################################    </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">L_diagram</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [list]  </span>
<span class="sd">        </span>
<span class="sd">        All the Single Diagram Parameter object relative to the diagrams declared. See Single Diagram Parameter object for more information.</span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        The number of analysis to performed is given by the function DiagramParameter.nbr_analysis -- which is just len(L_diagram).</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_L_diagram</span><span class="p">)</span>
    
    <span class="nd">@L_diagram</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">L_diagram</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute DiagramParameter.L_diagram values can only be list.&#39;</span><span class="p">)</span>
        <span class="c1"># We rather not define a logging.info because many info regarding the diagram definition is printed in the main output while running the initialization part of FROG run.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_L_diagram</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">#################################################################################################################################  </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">IS_rot_mat</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [bool]  </span>
<span class="sd">        </span>
<span class="sd">        Shortcut to help Frog know if the &#39;rotational matrix&#39; for this MT should be computed. Many analysis required this matrix, therefore it is set not during the diagram initialization but later on during the checks, see Frog.class_molecule.end_initialize.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_IS_rot_mat</span><span class="p">)</span>
    
    <span class="nd">@IS_rot_mat</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">IS_rot_mat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute DiagramParameter.IS_rot_mat can only be int.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting the DiagramParameter.IS_rot_mat  to </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span> <span class="c1"># in Frog.class_molecule.end_initialize</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_IS_rot_mat</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">IS_density</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [bool]</span>
<span class="sd">        </span>
<span class="sd">        Shortcut to help Frog know which analysis should be performed. There is as many IS\_ + analysis type as analysis type. For instance IS_density or IS_alpha. If this analysis is required, set to True, otherwise set to False.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_IS_density</span><span class="p">)</span>
    
    <span class="nd">@IS_density</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">IS_density</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute DiagramParameter.IS_density can only be int.&#39;</span><span class="p">)</span>
        <span class="c1"># logging.info(&#39;Setting the DiagramParameter.L_diagram  name to %s&#39;, value) not usefull at all</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_IS_density</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">#################################################################################################################################  </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">special_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [bool or list]  </span>
<span class="sd">        </span>
<span class="sd">        The single diagram parameters defines which analysis should be performed to this MT, and how. </span>
<span class="sd">        </span>
<span class="sd">        This attribute defines which molecule of this MT should contribute to the analysis. The advantage is to speed up the calculation time: you may not be interested by all the molecules!</span>
<span class="sd">        Note that this selection applies to *all* the diagrams of this MT.</span>
<span class="sd">        </span>
<span class="sd">        The format of this attribute is very similar to the geometrical discretisation option when declaring a diagram. As an user, when adding a new list of diagram to performed, you can define this special geometrical selection using: :: </span>
<span class="sd">            </span>
<span class="sd">            myMT.read_diagram_input(GP, L_diagram_analysis_to_perform, special_selection=my_special_selection)</span>
<span class="sd">            </span>
<span class="sd">        Here are the available values for `my_special_selection`:</span>
<span class="sd">        </span>
<span class="sd">           + `False` or `True`:</span>
<span class="sd">        </span>
<span class="sd">        No extra special selection is made. All the molecule of the MT contributes to all the analysis and diagrams. </span>
<span class="sd">        </span>
<span class="sd">        In this case, the DiagramParameter.special_selection object is set to False.</span>
<span class="sd">           </span>
<span class="sd">           + `[&#39;All&#39;]`: </span>
<span class="sd">        </span>
<span class="sd">        No extra special selection is made. All the molecule of the MT contributes to all the analysis and diagrams. </span>
<span class="sd">        </span>
<span class="sd">        In this case, the DiagramParameter.special_selection object is set to False.</span>
<span class="sd">            </span>
<span class="sd">           + `[&#39;Plane_ij&#39;, bin_number, list_of_bin]`: </span>
<span class="sd">        </span>
<span class="sd">        For each time step, the box is discretized along plane with the axis ij. bin_number number of bin is used. Every molecules are assigned to one of these bin according to there mean position. If this bin is within the list_of_bin, the molecule is analyse.   </span>
<span class="sd">        </span>
<span class="sd">        In this case, the DiagramParameter.special_selection object is set to [axis where the space is decretize (0, 1 or 2), bin_number, list_of_bin]</span>
<span class="sd">        </span>
<span class="sd">            + `[&#39;Layer&#39;, nbr_layer, list_layer]`:</span>
<span class="sd">        </span>
<span class="sd">        For each time step, the molecule are assigned to a layer, using &#39;nbr_layer&#39; number of layer. If a molecule is in the layer number given by list_layer, it is treated analysis by Frog. Otherwise not. </span>
<span class="sd">         </span>
<span class="sd">        In this case,  the DiagramParameter.special_selection object is set to [10, 2*nbr_layer+1, list_layer]</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        `my_special_selection = [&#39;Plane_xy&#39;, 100, [60, 61, 62, 63, 64, 65, 66]]`</span>
<span class="sd">        </span>
<span class="sd">        The box in discretize along the z axis using 100 bins. Only the molecule within the 60 to 66 bin are analysed. Note that the list of authorized bin can not be continous. </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        `my_special_selection = [&#39;Layer&#39;, 4, [-4, -3, 0, 1, 4]]`</span>
<span class="sd">        </span>
<span class="sd">        Here, nbr_layer = 4. A molecule can be assigned to the layer number 4, 3, 2 or 1 for the upper interface (the 1st is the closest to the bulk phase, the 4th the farthest), to -4, -3, -2, -1 for the lower interface (the -4 is the farest from the bulk phase) or to 0 for the molecule in the bulk-like phase. Only molecule with layer number -4, -3, 0, 1 or 4 will be treated by Frog. </span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        This condition is made before the one regarding the QM calculations parameters. If QM calculation should be made, a molecule has to respect both conditions (given in special_selection and the optical parameter parameters). </span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        If a diagram uses a Plane type discretization and with the same direction as special_selection, then the diagram size will be modified. Indeed, one major use of this attribute is to reduce the size of the diagram. For example, if a Plane_xy with  100 bins is required for a digram, and `my_special_selection = [&#39;Plane_xy&#39;, 100, [60, 61, 62, 63, 64, 65, 66]]`, the size of the diagram object attributes along the geometrical dimension will be 7 instead of 100. </span>
<span class="sd">        In case the diagram (or special_selection) is Layer type, no size reallocation is done: the size of diagram using Layer type is often small anyway. </span>
<span class="sd">        In case there is no diagram spatial discretization, nothing happens to the diagram size. </span>
<span class="sd">         </span>
<span class="sd">        In any case, the diagram will be built only by the molecule respecting the special_selection requirement -- and thus the analysis done within FROG are done only to these selected molecules. </span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        For devellopers: the most concrete action of  DiagramParameter.special_selection is made in geometry_manager.special_selection_assignement_for_molecules. Use this function to update new option for this attribute. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_special_selection</span><span class="p">)</span>
    
    <span class="nd">@special_selection</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">special_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">,</span> <span class="nb">list</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute DiagramParameter.special_selection values can only be list.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting the DiagramParameter.special_selection  to </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_special_selection</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">L_allowed_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [list]  </span>
<span class="sd">        </span>
<span class="sd">        Defined for each time step. Contain the molecule of this MT which should be treated according to the special_selection defined. If not special_selection is set, all the molecule can be treated. </span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        For advance user: The logging.info has been disable for this attribute because too much print would be done: the list of all the molecule to compute for every time step. For debug sake, you can use the logging of this attribute setter, or in the first_part.treat_one_frame function (maybe better in the first_part.treat_one_frame because you can print more meaningfull info along with this list).</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_L_allowed_molecule</span><span class="p">)</span>
    
    <span class="nd">@L_allowed_molecule</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">L_allowed_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute DiagramParameter.L_allowed_molecule can only be list.&#39;</span><span class="p">)</span>
        <span class="c1"># logging.info(&#39;Setting the DiagramParameter.special_selection to %s&#39;, value) see the note above</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_L_allowed_molecule</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">#################################################################################################################################          </span>
<span class="c1">#################################################################################################################################</span>

<div class="viewcode-block" id="DiagramParameter.read_diagram_input">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.DiagramParameter.read_diagram_input">[docs]</a>
    <span class="k">def</span> <span class="nf">read_diagram_input</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">GP</span><span class="p">,</span> <span class="n">smparameter</span><span class="p">,</span> <span class="n">L_diagram_analysis_to_perform</span><span class="p">,</span> <span class="n">special_selection</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Initialized the Diagrams for this molecule type: read the input and update the moleculetype.mtparameter.dparameter object.</span>
<span class="sd">        </span>
<span class="sd">        The GP is used to have the simulation box sizes.</span>
<span class="sd">        </span>
<span class="sd">        L_diagram_analysis_to_perform is a list of the different input for the different type of analysis. Note that every types of analysis have its specific input, but the minimal input is: [&#39;type of analysis&#39;, &#39;how the space is discretize&#39;, &#39;numbre of bins&#39; ...]. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">messages</span><span class="o">.</span><span class="n">message_with_hashtag</span><span class="p">(</span><span class="mi">74</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Start initializing the diagrams for this molecule type&#39;</span><span class="p">)</span>
        <span class="c1"># Read the diagrams defined and initialize them</span>
        <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_diagram_analysis_to_perform</span><span class="p">)):</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_11</span><span class="p">(</span><span class="n">L_diagram_analysis_to_perform</span><span class="p">[</span><span class="n">K</span><span class="p">])</span> <span class="c1"># So that the user can check the input (or if [,] is missing in his input file....).</span>
            <span class="n">L_input_diagram</span> <span class="o">=</span> <span class="n">L_diagram_analysis_to_perform</span><span class="p">[</span><span class="n">K</span><span class="p">]</span> <span class="c1">#shortcut for writing the code. This line is useless otherwise.</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="n">L_input_diagram</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_possible_diagram</span><span class="p">:</span> <span class="c1">#check that the analysis asked is defined in the code (should be in the L_possible_diagram)</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">error_messages</span><span class="o">.</span><span class="n">e_103</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">L_input_diagram</span><span class="p">[</span><span class="mi">2</span><span class="p">],</span> <span class="nb">list</span><span class="p">):</span> <span class="c1"># to avoid small user input mistake and crashes later on.</span>
                <span class="n">L_input_diagram</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">=</span> <span class="p">[</span><span class="n">L_input_diagram</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
                
            <span class="n">sdparameter</span> <span class="o">=</span> <span class="n">SingleDiagramParameter</span><span class="p">(</span><span class="n">L_input_diagram</span><span class="p">,</span> <span class="n">GP</span><span class="p">)</span>
            <span class="c1"># Some special behaviour for the different possible diagrams:</span>
            <span class="n">class_temp_diagram</span> <span class="o">=</span> <span class="n">class_modules</span><span class="o">.</span><span class="n">give_class_diagram_name</span><span class="p">(</span><span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span><span class="p">)</span> <span class="c1">#name of the class relative to the diagram requiered: </span>
            <span class="n">Frog</span><span class="o">.</span><span class="n">class_Diagrams</span><span class="o">.</span><span class="n">str_to_class</span><span class="p">(</span><span class="n">class_temp_diagram</span><span class="p">)</span><span class="o">.</span><span class="n">read_input</span><span class="p">(</span><span class="n">L_input_diagram</span><span class="p">,</span> <span class="n">sdparameter</span><span class="p">,</span> <span class="n">smparameter</span><span class="p">)</span> <span class="c1"># see the &#39;&#39;read_input&#39;&#39; function for each diagram type</span>
            <span class="n">sdparameter</span><span class="o">.</span><span class="n">check_format</span><span class="p">()</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">L_diagram</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sdparameter</span><span class="p">)</span>
            <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Adding a new diagram for the MT </span><span class="si">%s</span><span class="s1"> in DiagramParameter.L_diagram with name </span><span class="si">%s</span><span class="s1"> of type </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">smparameter</span><span class="o">.</span><span class="n">name_mt</span><span class="p">,</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span><span class="p">)</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="s1">&#39;IS_&#39;</span> <span class="o">+</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span><span class="p">,</span> <span class="kc">True</span><span class="p">)</span> <span class="c1"># The analysis type is stored </span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_21</span><span class="p">(</span><span class="n">sdparameter</span><span class="p">)</span>
            
        <span class="c1"># Read the special section and update the diagram discretization in case their discretization type match.</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">special_selection</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A special condition to select which molecule of this molecule should be treated with the analysis defined above has been set using the optional keyword special_selection: &#39;</span><span class="p">,</span> <span class="n">special_selection</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">special_selection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;All&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">special_selection</span> <span class="o">=</span> <span class="kc">False</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Every molecule of this molecule type will be considerated according to the special_condition option. In this case you may not defined it at all!&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="n">special_selection</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Plane_&#39;</span><span class="p">:</span>
                <span class="n">nbr_bin_space</span> <span class="o">=</span> <span class="n">special_selection</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="n">axis_of_interest</span><span class="p">,</span> <span class="n">direction_toprint</span><span class="p">,</span> <span class="n">slice_size</span> <span class="o">=</span> <span class="n">geometry_manager</span><span class="o">.</span><span class="n">init_plane_axis</span><span class="p">(</span><span class="n">special_selection</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">6</span><span class="p">:],</span> <span class="n">GP</span><span class="o">.</span><span class="n">box_size</span><span class="p">,</span> <span class="n">nbr_bin_space</span><span class="p">)</span> 
                <span class="bp">self</span><span class="o">.</span><span class="n">special_selection</span> <span class="o">=</span> <span class="p">[</span><span class="n">axis_of_interest</span><span class="p">,</span> <span class="n">nbr_bin_space</span><span class="p">,</span> <span class="n">special_selection</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span>
            <span class="k">elif</span> <span class="n">special_selection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Layer&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">special_selection</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span> <span class="n">special_selection</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">*</span><span class="mi">2</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">special_selection</span><span class="p">[</span><span class="mi">2</span><span class="p">]]</span> <span class="c1"># the code 10 refers to the usual shortcut for layer space discretization in Frog</span>
                <span class="n">GP</span><span class="o">.</span><span class="n">IS_layer_selection</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">if</span> <span class="n">GP</span><span class="o">.</span><span class="n">layer_nbr_max</span> <span class="o">&lt;</span> <span class="n">special_selection</span><span class="p">[</span><span class="mi">1</span><span class="p">]:</span>
                    <span class="n">GP</span><span class="o">.</span><span class="n">layer_nbr_max</span> <span class="o">=</span> <span class="n">special_selection</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: special_condition type not understood!&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">special_selection</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">special_selection</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span> <span class="c1"># if there is a special condition, update the bin list if required. </span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">special_selection</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">special_selection</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span> <span class="c1"># Plane like special selection. Some diagram may be narrowed:</span>
                <span class="k">for</span> <span class="n">sdparameter</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_diagram</span><span class="p">:</span>
                    <span class="n">sdparameter</span><span class="o">.</span><span class="n">special_selection_reassignation_list_creation</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">special_selection</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">pass</span>
        <span class="n">messages</span><span class="o">.</span><span class="n">message_with_hashtag</span><span class="p">(</span><span class="mi">74</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;End initializing the diagrams for this molecule type&#39;</span><span class="p">)</span></div>

        
<span class="c1">#################################################################################################################################</span>
     
<div class="viewcode-block" id="DiagramParameter.nbr_analysis">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.DiagramParameter.nbr_analysis">[docs]</a>
    <span class="k">def</span> <span class="nf">nbr_analysis</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the number of analysis to perform</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">return</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">L_diagram</span><span class="p">))</span></div>
</div>

        
<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################</span>

<div class="viewcode-block" id="SingleDiagramParameter">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.SingleDiagramParameter">[docs]</a>
<span class="k">class</span> <span class="nc">SingleDiagramParameter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    This class is defined in order to have the most general option for diagrams already prepared: the name of the diagram, the anaylisis type, how should be performed the discretization and the bin number/dimension. </span>
<span class="sd">    </span>
<span class="sd">    Here is the list of argument available for the different analysis type:</span>
<span class="sd">    </span>
<span class="sd">    - density: nothing.</span>
<span class="sd">    </span>
<span class="sd">    - molecular_orientation:</span>
<span class="sd">               proba_style = [string] can be &quot;join&quot; or &quot;independent&quot;. To compute the join or independent distributon respectively. Pay attention when using the join probability: the size can grow very quickly! </span>
<span class="sd">    </span>
<span class="sd">    - hbonds:  </span>
<span class="sd">               partner = [string] The moleculartype name of the partner molecule.</span>
<span class="sd">               which_function_to_call = [string] Either &#39;Target&#39; or &#39;Partner&#39; if the compute_hbonds should be used in this molecular module or the partner one.</span>
<span class="sd">               fct_parameters = [list] An array of all the parameter to pass to the function which compute the hbounds. See the molecular module function compute_hbonds to now what is expected. </span>
<span class="sd">               max_distance = [float] Define the radius to defined the neighbourood. </span>
<span class="sd">               </span>
<span class="sd">    - rdf:    </span>
<span class="sd">               partner = [string] The moleculartype name of the partner molecule.</span>
<span class="sd">               max_distance = [float] Define the maximal radius for the rdf. </span>
<span class="sd">   </span>
<span class="sd">    - electric_field:  </span>
<span class="sd">               min_max = [list of two float] The maximal and minimal value to discretize each component of the vector.</span>
<span class="sd">               calculation_type = [string] Can be &#39;PE&#39; or &#39;on_fly&#39;. If PE is asked, it will be calculated using the PE environment. If &#39;on_fly&#39; it will be computed independently according to the parameter given</span>
<span class="sd">               max_distance = [float] Define the radius to built the neighbourood used to compute the electric field. This argument should not be defined if calculation_type = &#39;PE&#39; and should be defined if calculation_type = &#39;on_fly&#39;.</span>
<span class="sd">               </span>
<span class="sd">    -alpha, iota, beta, chi:   </span>
<span class="sd">               min_max = [list of two float] The maximal and minimal value to discretize each component of the tensors.</span>
<span class="sd">               frequency = [float or string] The frequency at which the tensor is computed. If no frequency is set (or a reference value), the frequency value is replace by &#39;REF&#39;. </span>
<span class="sd">               </span>
<span class="sd">    - beta, chi: </span>
<span class="sd">                beta_type = [str] The type of first hyperpolarizability. Either &#39;dipole-dipole&#39;, &#39;dipole-quadrupole&#39; or &#39;quadrupole-dipole&#39;. It affects the size of the diagram (and the attached SingleMolecule property) and how is read the tensor from the DALTON output file. </span>
<span class="sd">               </span>
<span class="sd">    - effective_field:</span>
<span class="sd">               min_max = [list of two float] The maximal and minimal value to discretize each component of the alpha tensor.</span>
<span class="sd">               frequency = [float or string] The frequency at which the tensor is computed. If no frequency is set (or a reference value), the frequency value is replace by &#39;REF&#39;. </span>
<span class="sd">               diff_norm = [float] Error maximal allowed which end the self-consistant iteration to solve the molecular effective field matrix. </span>
<span class="sd">               max_iter = [int] The maximal number of allowed iteration to solve the molecular effective field matrix.           </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L_input_diagram</span><span class="p">,</span> <span class="n">GP</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;name&#39;</span><span class="p">,</span> <span class="s1">&#39;analysis_type&#39;</span><span class="p">,</span> <span class="s1">&#39;discretization_type&#39;</span><span class="p">,</span> <span class="s1">&#39;bin_size&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_size&#39;</span><span class="p">,</span><span class="s1">&#39; L_reassignation_selection&#39;</span><span class="p">,</span> <span class="s1">&#39;real_space_discretization_bin_number&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">L_input_diagram</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># The minimal name for the diagram is the analysis type. More things can be added to the name.</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">analysis_type</span> <span class="o">=</span> <span class="n">L_input_diagram</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="c1"># analysis type</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">mean_size</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># default value</span>
        
        <span class="c1"># The discretization in space: </span>
        <span class="k">if</span> <span class="n">L_input_diagram</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Averaged&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discretization_type</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_12</span><span class="p">()</span>
        <span class="k">elif</span> <span class="n">L_input_diagram</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">:</span><span class="mi">6</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Plane_&#39;</span><span class="p">:</span>
            <span class="n">nbr_bin_space</span> <span class="o">=</span> <span class="n">L_input_diagram</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nbr_bin_space</span> <span class="o">&lt;=</span> <span class="mi">1</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;ERROR: Using a Plane discretization requires at least 2 bins. Otherwise, use &#39;Averaged&#39; instead&quot;</span><span class="p">)</span>
            <span class="n">axis_of_interest</span><span class="p">,</span> <span class="n">direction_toprint</span><span class="p">,</span> <span class="n">slice_size</span> <span class="o">=</span> <span class="n">geometry_manager</span><span class="o">.</span><span class="n">init_plane_axis</span><span class="p">(</span><span class="n">L_input_diagram</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">6</span><span class="p">:],</span> <span class="n">GP</span><span class="o">.</span><span class="n">box_size</span><span class="p">,</span> <span class="n">nbr_bin_space</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_slice_&#39;</span> <span class="o">+</span> <span class="n">direction_toprint</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">nbr_bin_space</span><span class="p">,)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">nbr_bin_space</span><span class="p">,)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discretization_type</span> <span class="o">=</span> <span class="n">axis_of_interest</span> <span class="c1"># either 0, 1, 2 (for x, y, z).</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_13</span><span class="p">(</span><span class="n">direction_toprint</span><span class="p">,</span> <span class="n">L_input_diagram</span> <span class="p">,</span> <span class="n">slice_size</span><span class="p">,</span> <span class="n">nbr_bin_space</span><span class="p">)</span>
        <span class="k">elif</span> <span class="n">L_input_diagram</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;Layer&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39;_layer&#39;</span>
            <span class="n">nbr_bin_space</span> <span class="o">=</span> <span class="n">L_input_diagram</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span>
            <span class="k">if</span> <span class="n">nbr_bin_space</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s2">&quot;ERROR: Using a Layer discretization requires at least 1 layer. Otherwise, use &#39;Averaged&#39; instead&quot;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">nbr_bin_space</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean_size</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="o">*</span><span class="n">nbr_bin_space</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">discretization_type</span> <span class="o">=</span> <span class="mi">10</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The values will be regrouped according to the layer attribution. &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">nbr_bin_space</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; layer are defined per interface.&#39;</span><span class="p">)</span>
            <span class="n">GP</span><span class="o">.</span><span class="n">IS_layer_selection</span> <span class="o">=</span> <span class="kc">True</span>
            <span class="k">if</span> <span class="n">GP</span><span class="o">.</span><span class="n">layer_nbr_max</span> <span class="o">&lt;</span> <span class="n">nbr_bin_space</span><span class="p">:</span>
                <span class="n">GP</span><span class="o">.</span><span class="n">layer_nbr_max</span> <span class="o">=</span> <span class="n">nbr_bin_space</span>
            
        <span class="k">else</span><span class="p">:</span> 
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">error_messages</span><span class="o">.</span><span class="n">e_104</span><span class="p">())</span>
            
        <span class="n">_</span> <span class="o">=</span> <span class="n">L_input_diagram</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">pop</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span> <span class="c1">#remove the first argument since it has been treated.</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">L_reassignation_selection</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># default value</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">real_space_discretization_bin_number</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1"># default value</span>
    
        <span class="c1"># here no setter since there are many possible attributes which can come from the analysis definition (the diagram class used). Therefore, it would be tidious for devellopers to add the name of the attribute here in top of a rigorous description on the diagram class. </span>
 <span class="c1">#################################################################################################################################           </span>
<span class="c1">#################################################################################################################################    </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [string]  </span>
<span class="sd">       </span>
<span class="sd">        The name of the diagramm. </span>
<span class="sd">        </span>
<span class="sd">        The name is composed buy several information. It always start with the analysis type, then the geometrical discretization used. From some analysis, the name can be futher update with other parameter. </span>
<span class="sd">        </span>
<span class="sd">        name = &lt;analysis_type&gt; + \_ + &lt;discretization&gt; + other parameters </span>
<span class="sd">        </span>
<span class="sd">        See the analysis documentation for more information about how the name of the diagram are created. </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        If the input to built the diagram is : ::</span>
<span class="sd">        </span>
<span class="sd">            [&#39;density&#39;, &#39;Plane_xy&#39;, [100]]</span>
<span class="sd">            </span>
<span class="sd">        Then, the name of this diagram will be &#39;density_slice_z&#39;. </span>
<span class="sd">        </span>
<span class="sd">        If no space discretization is required: [’density’, ’All’, [1]], the name is directly &#39;density&#39;. </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        For an input: :: </span>
<span class="sd">        </span>
<span class="sd">            [&#39;rdf&#39;, &#39;Plane_xz&#39;, [100, 30], &#39;Methanol_OPLSAA&#39;, 10.2]</span>
<span class="sd">            </span>
<span class="sd">        The name will be &#39;rdf_slice_y_Methanol_OPLSAA&#39;</span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        For an input: ::</span>
<span class="sd">            </span>
<span class="sd">            [&#39;beta&#39;, &#39;Averaged&#39;, [1, 100], [-10, 10]]</span>
<span class="sd">            </span>
<span class="sd">        With QM calculation at frequencies: ::</span>
<span class="sd">        </span>
<span class="sd">            qmparameter.shg_response = [0.0, 0.05686]</span>
<span class="sd">            </span>
<span class="sd">        Two diagram will be created with the name &#39;beta_0.0&#39; and &#39;beta_0.05686&#39;. </span>
<span class="sd">       </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        The name of the diagram are fixed by the parameter. Therefore, you should not define several times the set of input parameter, leading to the same diagram name. Frog may crash in unexpected way. If you want to define very similar parameters to compare the resulting diagrams (with the same name), you should run several time Frog several times. </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_name</span><span class="p">)</span>
    
    <span class="nd">@name</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">name</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute SingleDiagramParameter.name can only be str.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting the SingleDiagramParameter.name to </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_name</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">#################################################################################################################################    </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">analysis_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [string]  </span>
<span class="sd">        </span>
<span class="sd">        The analysis type of this diagram. Should be in DiagramParameter.L_possible_diagram list. </span>
<span class="sd">        </span>
<span class="sd">        The analysis type is given by the first argument of the input parameter.</span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        For an input: ::</span>
<span class="sd">            </span>
<span class="sd">            [&#39;beta&#39;, &#39;Averaged&#39;, [1, 100], [-10, 10]]</span>
<span class="sd">            </span>
<span class="sd">        The sdparameter associated analysis_type is &#39;beta&#39;.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_analysis_type</span><span class="p">)</span>
    
    <span class="nd">@analysis_type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">analysis_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute SingleDiagramParameter.analysis_type can only be str.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting the </span><span class="si">%s</span><span class="s1"> SingleDiagramParameter.analysis_type to </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_analysis_type</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">#################################################################################################################################  </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">discretization_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [integer]  </span>
<span class="sd">        </span>
<span class="sd">        A shortcut for the geometrical discretization used for the diagram. The geometrical discretization is given by the second argument of the input parameter.</span>
<span class="sd">        </span>
<span class="sd">        user input: ::</span>
<span class="sd">            </span>
<span class="sd">            [analysis type, geometrical discretization, [bin number for the geometrical discretization, other bin number], other parameters]</span>
<span class="sd">        </span>
<span class="sd">        Here are the available geometrical discretization type: </span>
<span class="sd">        </span>
<span class="sd">            + &#39;Averaged&#39;: </span>
<span class="sd">        </span>
<span class="sd">        No geometrical discretization. The bin number of the geometrical discretization should be 1. </span>
<span class="sd">        </span>
<span class="sd">        In this case, `discretization_type = -1`</span>
<span class="sd">        </span>
<span class="sd">            + &#39;Plane_ij&#39;:</span>
<span class="sd">        </span>
<span class="sd">        Where i and j are x, y or z. In this case, the discretization is made over the last axis. If Plane_xy is required, the discretization along the z axis is done. The name of the diagram is updated with &#39;slice_z&#39; in this case -- see the name attribute of the SingleDiagramParameter object.  </span>
<span class="sd">        </span>
<span class="sd">        In this case, `discretization_type = k` where k = 0, 1, 2 for a discretization along the x, y or z laboratory axis. </span>
<span class="sd">            </span>
<span class="sd">            + Layer:</span>
<span class="sd">        </span>
<span class="sd">        The geometrical discretization is made using the pytim.ITIM module. The number of layer to discretize each interface has to be given using the &lt;bin number for the geometrical discretization&gt;. Note that in the current implementation, Frog support only 2 liquid/gas interfaces. </span>
<span class="sd">        </span>
<span class="sd">        In this case, `discretization_type = 10`</span>
<span class="sd">            </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        For an input: :: </span>
<span class="sd">            </span>
<span class="sd">            [&#39;rdf&#39;, &#39;Plane_xz&#39;, [100, 30], &#39;Methanol_OPLSAA&#39;, 10.2]</span>
<span class="sd">            </span>
<span class="sd">        The discretization will be made over the y-axis. The bin number to discretize this axis is 100. </span>
<span class="sd">        </span>
<span class="sd">        For an input: :: </span>
<span class="sd">            </span>
<span class="sd">            [&#39;density&#39;, &#39;Layer&#39;, [4]]</span>
<span class="sd">        </span>
<span class="sd">        The density discretization is made over 4 layer for each interfaces.  </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_discretization_type</span><span class="p">)</span>
    
    <span class="nd">@discretization_type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">discretization_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute SingleDiagramParameter.discretization_type can only be int.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting the </span><span class="si">%s</span><span class="s1"> SingleDiagramParameter.discretization_type to </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_discretization_type</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">bin_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [tuple]  </span>
<span class="sd">        </span>
<span class="sd">        The size of the diagram.value . </span>
<span class="sd">        </span>
<span class="sd">        The first bin size is relative to the geometrical discretization. If no discretization is performed, `bin_size[0] = 1`. </span>
<span class="sd">        </span>
<span class="sd">        The other dimension are given by the user in the rest of the third argument along with the analysis required. </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        If the input to built the diagram is : ::</span>
<span class="sd">        </span>
<span class="sd">            [&#39;density&#39;, &#39;Plane_xy&#39;, [100]]</span>
<span class="sd">            </span>
<span class="sd">        The bin size is [100], since only geometrical selection dimension is required for the density analysis.  </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        For an input: :: </span>
<span class="sd">        </span>
<span class="sd">            [&#39;rdf&#39;, &#39;Plane_xz&#39;, [100, 30], &#39;Methanol_OPLSAA&#39;, 10.2]</span>
<span class="sd">            </span>
<span class="sd">        The bin size is [100, 30]. The 100 refers to the geometrical discretization, and the 30 to the observable discretization -- the RDF value for each altitude. </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        For an input: ::</span>
<span class="sd">            </span>
<span class="sd">            [&#39;beta&#39;, &#39;Averaged&#39;, [1, 100], [-10, 10]]</span>
<span class="sd">            </span>
<span class="sd">        The bin size is [1, 27, 100]. The 1 refers to the geometrical discretization (none), the 27 to the 27 elements of the beta matrix. For each matrix components, 100 bins are used to discretize the value. Here the independent discribution are computed -- i.e. the diagram have not the size 100\^27 for obvious reasons...  </span>

<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_bin_size</span><span class="p">)</span>
    
    <span class="nd">@bin_size</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">bin_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute SingleDiagramParameter.bin_size can only be tuple.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting the </span><span class="si">%s</span><span class="s1"> SingleDiagramParameter.bin_size to </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_bin_size</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">mean_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [tuple or bool]  </span>
<span class="sd">        </span>
<span class="sd">        The size of the diagram.mean . </span>
<span class="sd">        </span>
<span class="sd">        It is the same size of the bin_size, whithout the last dimension -- which is compressed into its average value. </span>
<span class="sd">       </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Some analysis have no &#39;mean&#39; value because they are not easely defined -- for instance the &#39;average value of the RDF. In this case, mean_size = False</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_mean_size</span><span class="p">)</span>
    
    <span class="nd">@mean_size</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">mean_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">tuple</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute SingleDiagramParameter.mean_size can only be tuple or bool.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting the </span><span class="si">%s</span><span class="s1"> SingleDiagramParameter.mean_size to </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_mean_size</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">L_reassignation_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [list or bool]  </span>
<span class="sd">        </span>
<span class="sd">        If no special selection is required, this is False</span>
<span class="sd">        </span>
<span class="sd">        If a special selection is required, this list track the new position of the old bin: it is used to fill the diagram with the new size. </span>
<span class="sd">        </span>
<span class="sd">        Example: if the original binning is N_bin=10, and after the special selection only the first, 3rd and 8th bin are authorized. This means that the size of the diagram along the spatial direction was orginaly 10, and now it is only 3. In this case, L_reassignation_selection = [0, 3, 1, 3, 3, 3, 3, 2, 3, 3]. There are 3 authorized bin in total (real_space_discretization_bin_number=3), the 1st bin is now the first bin, the 3rd the second and the 8th the third. This reassignation is done in geometry_manager%discretization_space.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_L_reassignation_selection</span><span class="p">)</span>   
    
    <span class="nd">@L_reassignation_selection</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">L_reassignation_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_L_reassignation_selection</span> <span class="o">=</span> <span class="n">value</span>   
<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">real_space_discretization_bin_number</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [integer] </span>
<span class="sd">        </span>
<span class="sd">        If a special condition is requested for the Diagram spatial discretization, real_space_discretization_bin_number is the number of bin that are authorized according to this special condition. Note that the current implementation only work for a Slice spatial discretization. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_real_space_discretization_bin_number</span><span class="p">)</span>   
    
    <span class="nd">@real_space_discretization_bin_number</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">real_space_discretization_bin_number</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_real_space_discretization_bin_number</span> <span class="o">=</span> <span class="n">value</span>   
<span class="c1">################################################################################################################################# </span>
<span class="c1">#################################################################################################################################</span>

<div class="viewcode-block" id="SingleDiagramParameter.check_format">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.SingleDiagramParameter.check_format">[docs]</a>
    <span class="k">def</span> <span class="nf">check_format</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Check that the format of the SingleDiagramParameter object is conform. Please feel free to add new tests. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">error_messages</span><span class="o">.</span><span class="n">e_105</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

        
<span class="c1">#################################################################################################################################</span>
        
<div class="viewcode-block" id="SingleDiagramParameter.add_bin_dimension">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.SingleDiagramParameter.add_bin_dimension">[docs]</a>
    <span class="k">def</span> <span class="nf">add_bin_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_nbr_bin</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add safely a new dimension to the bin_size.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># should not happend but better safe then sorry.</span>
            <span class="k">return</span><span class="p">((</span><span class="n">new_nbr_bin</span><span class="p">,))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span><span class="p">)</span>
            <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
                <span class="n">new_tuple</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">new_tuple</span><span class="p">[</span><span class="n">size</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_nbr_bin</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">)</span></div>

            <span class="c1">#################################################################################################################################</span>
        
<div class="viewcode-block" id="SingleDiagramParameter.change_bin_size_value">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.SingleDiagramParameter.change_bin_size_value">[docs]</a>
    <span class="k">def</span> <span class="nf">change_bin_size_value</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">bin_to_change</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Change safely the bin_size.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span> <span class="c1"># should not happend but better safe then sorry.</span>
            <span class="k">return</span><span class="p">((</span><span class="n">value</span><span class="p">,))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span><span class="p">)</span>
            <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">bin_to_change</span> <span class="o">==</span> <span class="n">k</span> <span class="p">:</span>
                    <span class="n">new_tuple</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="n">value</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">new_tuple</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">)</span></div>

            <span class="c1">#################################################################################################################################</span>
            
<div class="viewcode-block" id="SingleDiagramParameter.add_mean_dimension">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.SingleDiagramParameter.add_mean_dimension">[docs]</a>
    <span class="k">def</span> <span class="nf">add_mean_dimension</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">new_nbr_bin</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Add safely a new dimension to the mean_size.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_size</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_size</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span> 
            <span class="bp">self</span><span class="o">.</span><span class="n">mean_size</span> <span class="o">=</span> <span class="p">(</span><span class="n">new_nbr_bin</span><span class="p">,)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">mean_size</span><span class="p">)</span>
            <span class="n">new_tuple</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span>
            <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">size</span><span class="p">):</span>
                <span class="n">new_tuple</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">mean_size</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
            <span class="n">new_tuple</span><span class="p">[</span><span class="n">size</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_nbr_bin</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">mean_size</span> <span class="o">=</span> <span class="nb">tuple</span><span class="p">(</span><span class="n">new_tuple</span><span class="p">)</span></div>

    
<span class="c1">#################################################################################################################################</span>
    
<div class="viewcode-block" id="SingleDiagramParameter.special_selection_reassignation_list_creation">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.SingleDiagramParameter.special_selection_reassignation_list_creation">[docs]</a>
    <span class="k">def</span> <span class="nf">special_selection_reassignation_list_creation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">special_selection</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        The selection of which molecule should be analyze/add to the diagram is made during the first_part.treat_one_frame function. However, since a smaller part of the box is anaylize, the size of the diagram should be updated accordingly. </span>
<span class="sd">        </span>
<span class="sd">        This function prepare the list &#39;L_reassignation_selection&#39; in case there is a special selection according to an axis. It will be use later on to built the proper diagram size and axis values. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">special_selection</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">pass</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discretization_type</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span> <span class="c1"># no space averaging: nothing to do</span>
                <span class="k">pass</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">discretization_type</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">discretization_type</span> <span class="o">==</span> <span class="n">special_selection</span><span class="p">[</span><span class="mi">0</span><span class="p">]:</span><span class="c1">#same axis of discretization, not all the bin are needed in the diagram since there is an extra selection regarding this axis. </span>
                    <span class="n">L_old_assignation</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">1</span><span class="p">)]</span>
                    <span class="n">L_new_assignation</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="n">L_authorised_bin</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">bin_selection</span> <span class="ow">in</span> <span class="n">special_selection</span><span class="p">[</span><span class="mi">2</span><span class="p">]:</span> <span class="c1">#the list of authorized bin within the selection discretization:</span>
                        <span class="n">bin_authorised_diagram_discretization</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">bin_selection</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">special_selection</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span> <span class="c1"># Here is the bin value within the diagram discretization. However, the float value of this bin may be 4.2 for instance. Thereofore, to make sure all the bin are initialized in the diagram, we have to include the bin 4 and 5: </span>
                        <span class="n">bin_authorised_diagram_discretization_max</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">bin_selection</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">/</span><span class="n">special_selection</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
                        
                        <span class="k">for</span> <span class="n">bin_authorized</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">bin_authorised_diagram_discretization</span><span class="p">,</span> <span class="n">bin_authorised_diagram_discretization_max</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                            <span class="n">L_authorised_bin</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">bin_authorized</span><span class="p">)</span>
                            
                    <span class="n">trotter</span> <span class="o">=</span> <span class="mi">0</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_old_assignation</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="k">if</span> <span class="n">k</span> <span class="ow">in</span> <span class="n">L_authorised_bin</span><span class="p">:</span>
                            <span class="n">L_new_assignation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">trotter</span><span class="p">)</span>
                            <span class="n">trotter</span> <span class="o">+=</span> <span class="mi">1</span>
                        <span class="k">else</span><span class="p">:</span>
                            <span class="n">L_new_assignation</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
                    
                    <span class="k">if</span> <span class="n">trotter</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: you have request an extra selection for the diagram. However, Frog is not able to find any bin corresponding to your request. Please adjust the authorised bin list.&#39;</span><span class="p">)</span>
                        
                    <span class="bp">self</span><span class="o">.</span><span class="n">real_space_discretization_bin_number</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">trotter</span><span class="p">)</span> <span class="c1"># the number of authorized bin once the special condition applied</span>

                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_new_assignation</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span> 
                        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">L_new_assignation</span><span class="p">[</span><span class="n">k</span><span class="p">],</span> <span class="nb">bool</span><span class="p">):</span>
                            <span class="n">L_new_assignation</span><span class="p">[</span><span class="n">k</span><span class="p">]</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">real_space_discretization_bin_number</span>
                    
                    <span class="bp">self</span><span class="o">.</span><span class="n">L_reassignation_selection</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">L_new_assignation</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
                    
                <span class="k">else</span><span class="p">:</span> <span class="c1"># the extra selection is no along the same axis, nothing to do. </span>
                    <span class="k">pass</span> 
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">discretization_type</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span> <span class="c1"># layer: nothing to do</span>
                <span class="k">pass</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: the self.discretization_type value is not compatible: code error!&#39;</span><span class="p">)</span></div>
</div>

                
<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################</span>

<div class="viewcode-block" id="sdparameter_create_axis">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.sdparameter_create_axis">[docs]</a>
<span class="k">def</span> <span class="nf">sdparameter_create_axis</span><span class="p">(</span><span class="n">sdparameter</span><span class="p">,</span> <span class="n">GP</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    Create the axis list related to a Diagram. </span>
<span class="sd">    </span>
<span class="sd">    The first list is always related to the position of the molecule. For instance the position along the z-axis. </span>
<span class="sd">    The other are related to the analysis performed. For instance the number of H-bonds or the electric field value. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="n">L_xyz</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;x&#39;</span><span class="p">,</span> <span class="s1">&#39;y&#39;</span><span class="p">,</span> <span class="s1">&#39;z&#39;</span><span class="p">]</span>
    <span class="c1"># create the space discretization</span>
    <span class="n">observable_unit</span> <span class="o">=</span> <span class="n">unit</span><span class="p">(</span><span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span><span class="p">,</span> <span class="s1">&#39;distribution&#39;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">discretization_type</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No space discretization has been required for this diagram.&#39;</span><span class="p">)</span> 
        <span class="n">axis_space</span> <span class="o">=</span> <span class="n">frog_axis</span><span class="p">(</span><span class="n">sdparameter</span><span class="p">,</span> <span class="n">GP</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">discretization_type</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Space discretization along the &#39;</span> <span class="o">+</span> <span class="n">L_xyz</span><span class="p">[</span><span class="n">sdparameter</span><span class="o">.</span><span class="n">discretization_type</span><span class="p">]</span> <span class="o">+</span> <span class="s1">&#39;-axis has been required for this diagram. Thus, the first axis will be space point.&#39;</span><span class="p">)</span>
        <span class="n">axis_space</span> <span class="o">=</span> <span class="n">frog_axis</span><span class="p">(</span><span class="n">sdparameter</span><span class="p">,</span> <span class="n">GP</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">elif</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">discretization_type</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Space discretization using layer is used. Thus, the first axis will represent the different layer.&#39;</span><span class="p">)</span>
        <span class="n">axis_space</span> <span class="o">=</span> <span class="n">frog_axis</span><span class="p">(</span><span class="n">sdparameter</span><span class="p">,</span> <span class="n">GP</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Analysis type: &#39;</span> <span class="o">+</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span> <span class="o">+</span> <span class="s1">&#39;. The size of the diagram is: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">sdparameter</span><span class="o">.</span><span class="n">bin_size</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, the first value is allways assigned to the space discretization -- eventhough no space discretization has been required. If there is a space discretization, you can call the space axis using L_axis[0]. The other dimension/axis are explained bellow.&#39;</span><span class="p">)</span>
    
    <span class="c1"># create the observable discretization. </span>
    <span class="n">axis_observable</span> <span class="o">=</span> <span class="n">frog_axis</span><span class="p">(</span><span class="n">sdparameter</span><span class="p">,</span> <span class="n">GP</span><span class="p">)</span>
    
    <span class="k">return</span><span class="p">(</span><span class="n">observable_unit</span><span class="p">,</span> <span class="n">axis_observable</span><span class="p">,</span> <span class="n">axis_space</span><span class="p">)</span></div>


<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################</span>

<div class="viewcode-block" id="frog_axis">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.frog_axis">[docs]</a>
<span class="k">class</span> <span class="nc">frog_axis</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    How the units are handled by Frog: they are not! </span>
<span class="sd">    During Frog run, the unit are fixed for each quantities. This part of the code us designed to help user to plot/play with the diagrams later on (for instance in jupyter notebooks).</span>
<span class="sd">    This part of the code is still under construction and should be read as a small toolbox. </span>
<span class="sd">    If you wish to use an external library / improve the code go ahead!</span>
<span class="sd">    </span>
<span class="sd">    contains:</span>
<span class="sd">    value</span>
<span class="sd">    value2 sometimes</span>
<span class="sd">    unit</span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">sdparameter</span><span class="p">,</span> <span class="n">GP</span><span class="p">,</span> <span class="n">space</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        
        <span class="k">if</span> <span class="n">space</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">discretization_type</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;axis_space&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span><span class="p">(</span><span class="s1">&#39;axis_space&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span> 
            <span class="k">elif</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">discretization_type</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;axis_space&#39;</span>
                <span class="n">L_x_initial</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">GP</span><span class="o">.</span><span class="n">box_size</span><span class="p">[</span><span class="n">sdparameter</span><span class="o">.</span><span class="n">discretization_type</span><span class="p">],</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">real_space_discretization_bin_number</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ok axis space&#39;</span><span class="p">,</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
                    <span class="n">L_x_selection</span> <span class="o">=</span> <span class="p">[]</span>
                    <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_x_initial</span><span class="p">),</span> <span class="mi">1</span><span class="p">):</span>
                        <span class="n">discretization_space</span> <span class="o">=</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">L_reassignation_selection</span><span class="p">[</span><span class="n">k</span><span class="p">]</span>
                        <span class="k">if</span> <span class="n">discretization_space</span> <span class="o">!=</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">real_space_discretization_bin_number</span><span class="p">:</span> <span class="c1"># should be add:</span>
                            <span class="n">L_x_selection</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">L_x_initial</span><span class="p">[</span><span class="n">k</span><span class="p">])</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">L_x_selection</span> <span class="o">=</span> <span class="n">L_x_initial</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">L_x_selection</span><span class="p">)</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;axis space:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span><span class="p">(</span><span class="s1">&#39;axis_space&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span> 
            <span class="k">elif</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">discretization_type</span> <span class="o">==</span> <span class="mi">10</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s1">&#39;axis_layer&#39;</span>
                <span class="n">nbr_layer</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">sdparameter</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">-</span><span class="mi">1</span><span class="p">)</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="o">-</span><span class="n">nbr_layer</span><span class="p">,</span> <span class="n">nbr_layer</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span><span class="p">(</span><span class="s1">&#39;axis_layer&#39;</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span> 
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;axis space:&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">value</span><span class="p">)</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="c1"># cases for the different diagram type:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span>
            <span class="k">if</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span> <span class="o">==</span> <span class="s1">&#39;density&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;No more dimension are needed for the density analysis&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">]</span>
                
            <span class="k">elif</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span> <span class="o">==</span> <span class="s1">&#39;molecular_orientation&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The other dimension are related to the different orientation angle for this MT. The diagram is the join probability. The axis are the same for all the angle: from -1 to 1. You can call this axis using L_axis[1].&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

            <span class="k">elif</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span> <span class="o">==</span> <span class="s1">&#39;hbond&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The other dimension are related to the H-bond &quot;own&quot; and &quot;given&quot; by this MT with the partner MT: &#39;</span> <span class="o">+</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">partner</span> <span class="o">+</span> <span class="s1">&#39;.The diagram is the join probability. The axis may not be the same for the &quot;own&quot; and &quot;given&quot; H-bond depending on the maximal value authorized. You can call the axis for the &quot;own&quot; H-bond using L_axis[1] and for the &quot;given&quot; using L_axis[2].&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="mi">1</span><span class="p">])])</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="mi">2</span><span class="p">])])</span>

            <span class="k">elif</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span> <span class="o">==</span> <span class="s1">&#39;rdf&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The other dimension are related to number of partner MT: &#39;</span> <span class="o">+</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">partner</span> <span class="o">+</span> <span class="s1">&#39; found nearby this MT. The axis described the distance between this MT and the target ones. You can call this axis using L_axis[1].&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">max_distance</span><span class="p">,</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                
            <span class="k">elif</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span> <span class="o">==</span> <span class="s1">&#39;electric_field&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The other dimension are related to the value of the electric field and its derivative in the molecular frame or in the laboratory one. The diagram is the independent probability. The axis described the value are all the same and can be call using L_axis[1].&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">sdparameter</span><span class="o">.</span><span class="n">min_max</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">min_max</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                
            <span class="k">elif</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span> <span class="o">==</span> <span class="s1">&#39;alpha&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The other dimension are related to the value of the polarizability components in the molecular frame. The diagram is the independent probability. The axis described the value are all the same and can be call using L_axis[1].&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">sdparameter</span><span class="o">.</span><span class="n">min_max</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">min_max</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                
            <span class="k">elif</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span> <span class="o">==</span> <span class="s1">&#39;iota&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The other dimension are related to the value of the polarizability components in the laboratory frame. The diagram is the independent probability. The axis described the value are all the same and can be call using L_axis[1].&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">sdparameter</span><span class="o">.</span><span class="n">min_max</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">min_max</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                
            <span class="k">elif</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span> <span class="o">==</span> <span class="s1">&#39;beta&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The other dimension are related to the value of the hyperpolarizability components in the molecular frame. The diagram is the independent probability. The axis described the value are all the same and can be call using L_axis[1].&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">sdparameter</span><span class="o">.</span><span class="n">min_max</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">min_max</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                
            <span class="k">elif</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span> <span class="o">==</span> <span class="s1">&#39;chi&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The other dimension are related to the value of the hyperpolarizability components in the laboratory frame. The diagram is the independent probability. The axis described the value are all the same and can be call using L_axis[1].&#39;</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">sdparameter</span><span class="o">.</span><span class="n">min_max</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">min_max</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">bin_size</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
                
            <span class="k">elif</span> <span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span> <span class="o">==</span> <span class="s1">&#39;effective_field&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: Not defined yet&#39;</span><span class="p">)</span>

            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: diagram type not understood&#39;</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">unit</span> <span class="o">=</span> <span class="n">unit</span><span class="p">(</span><span class="n">sdparameter</span><span class="o">.</span><span class="n">analysis_type</span><span class="p">,</span> <span class="s1">&#39;axis&#39;</span><span class="p">)</span></div>

            
<span class="c1">#################################################################################################################################</span>

<div class="viewcode-block" id="unit">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.unit">[docs]</a>
<span class="k">class</span> <span class="nc">unit</span><span class="p">:</span>
    <span class="c1"># [&#39;density&#39;, &#39;molecular_orientation&#39;, &#39;hbond&#39;, &#39;rdf&#39;, &#39;electric_field&#39;, &#39;alpha&#39;, &#39;iota&#39;, &#39;beta&#39;, &#39;chi&#39;, &#39;effective_field&#39;]</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">name_analysis</span><span class="p">,</span> <span class="n">type_object</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">custom_name</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_unit_used</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="n">L_possible_unit</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;population&#39;</span><span class="p">,</span> <span class="s1">&#39;potential&#39;</span><span class="p">,</span> <span class="s1">&#39;polarizability&#39;</span><span class="p">,</span> <span class="s1">&#39;hyperpolarizability&#39;</span><span class="p">,</span> <span class="s1">&#39;length&#39;</span><span class="p">]</span>
        <span class="k">for</span> <span class="n">possible_unit</span> <span class="ow">in</span> <span class="n">L_possible_unit</span><span class="p">:</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">possible_unit</span> <span class="o">+</span> <span class="s1">&#39;_dim&#39;</span><span class="p">,</span> <span class="kc">False</span><span class="p">)</span>
        
        <span class="k">if</span> <span class="n">name_analysis</span> <span class="o">==</span><span class="s1">&#39;axis_space&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">length_dim</span> <span class="o">=</span> <span class="mi">1</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">length_value</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
        <span class="k">elif</span> <span class="n">name_analysis</span> <span class="o">==</span><span class="s1">&#39;axis_layer&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">custom_name</span> <span class="o">=</span> <span class="s1">&#39;Layer&#39;</span>
            
        <span class="k">elif</span> <span class="n">name_analysis</span> <span class="o">==</span> <span class="s1">&#39;density&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;axis&#39;</span> <span class="ow">or</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;distribution&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_dim</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_value</span> <span class="o">=</span> <span class="s1">&#39;Molecule&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">length_dim</span> <span class="o">=</span> <span class="o">-</span><span class="mi">3</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">length_value</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
                
        <span class="k">elif</span> <span class="n">name_analysis</span> <span class="o">==</span> <span class="s1">&#39;molecular_orientation&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">custom_name</span> <span class="o">=</span> <span class="s1">&#39;Projection&#39;</span>
            <span class="k">elif</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;distribution&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_dim</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_value</span> <span class="o">=</span> <span class="s1">&#39;Molecule&#39;</span>
            
        <span class="k">elif</span> <span class="n">name_analysis</span> <span class="o">==</span> <span class="s1">&#39;hbond&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">custom_name</span> <span class="o">=</span> <span class="s1">&#39;H-bonds&#39;</span>
            <span class="k">elif</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;distribution&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_dim</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_value</span> <span class="o">=</span> <span class="s1">&#39;Molecule&#39;</span>
            
        <span class="k">elif</span> <span class="n">name_analysis</span> <span class="o">==</span> <span class="s1">&#39;rdf&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">length_dim</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">length_value</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
            <span class="k">elif</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;distribution&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_dim</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_value</span> <span class="o">=</span> <span class="s1">&#39;Molecule&#39;</span>

        <span class="k">elif</span> <span class="n">name_analysis</span> <span class="o">==</span> <span class="s1">&#39;electric_field&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">potential_dim</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">potential_value</span> <span class="o">=</span> <span class="s1">&#39;V&#39;</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">length_dim</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">length_value</span> <span class="o">=</span> <span class="s1">&#39;A&#39;</span>
            <span class="k">elif</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;distribution&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_dim</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_value</span> <span class="o">=</span> <span class="s1">&#39;Molecule&#39;</span>
            
        <span class="k">elif</span> <span class="n">name_analysis</span> <span class="o">==</span> <span class="s1">&#39;alpha&#39;</span> <span class="ow">or</span> <span class="n">name_analysis</span> <span class="o">==</span> <span class="s1">&#39;iota&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">polarizability_dim</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">polarizability_value</span> <span class="o">=</span> <span class="s1">&#39;a.u.&#39;</span>
            <span class="k">elif</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;distribution&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_dim</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_value</span> <span class="o">=</span> <span class="s1">&#39;Molecule&#39;</span>

        <span class="k">elif</span> <span class="n">name_analysis</span> <span class="o">==</span> <span class="s1">&#39;beta&#39;</span> <span class="ow">or</span> <span class="n">name_analysis</span> <span class="o">==</span> <span class="s1">&#39;chi&#39;</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;axis&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hyperpolarizability_dim</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">hyperpolarizability_value</span> <span class="o">=</span> <span class="s1">&#39;a.u.&#39;</span>
            <span class="k">elif</span> <span class="n">type_object</span> <span class="o">==</span> <span class="s1">&#39;distribution&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_dim</span> <span class="o">=</span> <span class="mi">1</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">population_value</span> <span class="o">=</span> <span class="s1">&#39;Molecule&#39;</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: name analysis not understood!&#39;</span><span class="p">)</span>
            
        <span class="k">for</span> <span class="n">possible_unit</span> <span class="ow">in</span> <span class="n">L_possible_unit</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">possible_unit</span> <span class="o">+</span> <span class="s1">&#39;_dim&#39;</span><span class="p">),</span> <span class="nb">bool</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">L_unit_used</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">possible_unit</span><span class="p">)</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_unit_used</span> <span class="ow">and</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_name</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;name analysis:&#39;</span><span class="p">,</span> <span class="n">name_analysis</span><span class="p">)</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: this unit is empty... weird!&#39;</span><span class="p">)</span>
            
<span class="c1">################################################################################################################################# </span>
    
<div class="viewcode-block" id="unit.switch_unit">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.unit.switch_unit">[docs]</a>
    <span class="k">def</span> <span class="nf">switch_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_to_change</span><span class="p">,</span> <span class="n">new_unit</span><span class="p">,</span> <span class="n">custom_change</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">molar_mass</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">unit_to_change</span> <span class="ow">in</span>  <span class="bp">self</span><span class="o">.</span><span class="n">L_unit_used</span><span class="p">:</span>
            
            <span class="k">if</span> <span class="n">unit_to_change</span> <span class="o">==</span> <span class="s1">&#39;population&#39;</span><span class="p">:</span>
                <span class="n">unit_t</span> <span class="o">=</span> <span class="s1">&#39;population&#39;</span>
                <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">molar_mass</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: the molar mass of this specie is not yet define! See TODO!&#39;</span><span class="p">)</span>
                <span class="n">Na</span> <span class="o">=</span> <span class="mf">6.02214076</span><span class="o">*</span><span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mi">23</span><span class="p">)</span>
                <span class="n">L_unit_understood</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Molecule&#39;</span><span class="p">,</span> <span class="s1">&#39;Mol&#39;</span><span class="p">,</span> <span class="s1">&#39;g&#39;</span><span class="p">,</span> <span class="s1">&#39;kg&#39;</span><span class="p">]</span>
                <span class="n">L_corresponding_value</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="n">Na</span><span class="p">,</span> <span class="n">Na</span><span class="o">/</span><span class="n">molar_mass</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span><span class="o">*</span><span class="n">Na</span><span class="o">/</span><span class="n">molar_mass</span><span class="p">]</span>
                
            <span class="k">elif</span> <span class="n">unit_to_change</span> <span class="o">==</span> <span class="s1">&#39;length&#39;</span><span class="p">:</span>
                <span class="n">unit_t</span> <span class="o">=</span> <span class="s1">&#39;length&#39;</span>
                <span class="n">L_unit_understood</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;m&#39;</span><span class="p">,</span> <span class="s1">&#39;dm&#39;</span><span class="p">,</span> <span class="s1">&#39;cm&#39;</span><span class="p">,</span> <span class="s1">&#39;mm&#39;</span><span class="p">,</span> <span class="s1">&#39;mu&#39;</span><span class="p">,</span> <span class="s1">&#39;nm&#39;</span><span class="p">,</span> <span class="s1">&#39;A&#39;</span><span class="p">]</span>
                <span class="n">L_corresponding_value</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">),</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">),</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">9</span><span class="p">),</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">10</span><span class="p">)]</span>
                
            <span class="k">if</span> <span class="n">unit_to_change</span> <span class="o">==</span> <span class="s1">&#39;potential&#39;</span><span class="p">:</span>
                <span class="n">unit_t</span> <span class="o">=</span> <span class="s1">&#39;potential&#39;</span>
                <span class="n">L_unit_understood</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;V&#39;</span><span class="p">,</span> <span class="s1">&#39;mV&#39;</span><span class="p">]</span>
                <span class="n">L_corresponding_value</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">3</span><span class="p">)]</span>
                
            <span class="k">if</span> <span class="n">unit_to_change</span> <span class="o">==</span> <span class="s1">&#39;polarizability&#39;</span><span class="p">:</span>
                <span class="n">unit_t</span> <span class="o">=</span> <span class="s1">&#39;polarizability&#39;</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;TODO&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="n">unit_to_change</span> <span class="o">==</span> <span class="s1">&#39;hyperpolarizability&#39;</span><span class="p">:</span>
                <span class="n">unit_t</span> <span class="o">=</span> <span class="s1">&#39;hyperpolarizability&#39;</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;TODO&#39;</span><span class="p">)</span>
            
            <span class="n">coeff_to_switch</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">switch_for_given_unit</span><span class="p">(</span><span class="n">unit_to_change</span><span class="p">,</span> <span class="n">new_unit</span><span class="p">,</span> <span class="n">custom_change</span><span class="p">,</span> <span class="n">L_unit_understood</span><span class="p">,</span> <span class="n">L_corresponding_value</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The dimension you want to change is not involved in this unit (or is implemented in another way). See the documentation to see how to change the unit: &#39;</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">print_unit</span><span class="p">())</span>
            <span class="n">coeff_to_switch</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="k">return</span><span class="p">(</span><span class="n">coeff_to_switch</span><span class="p">)</span></div>

    
<span class="c1">#################################################################################################################################       </span>

<div class="viewcode-block" id="unit.switch_for_given_unit">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.unit.switch_for_given_unit">[docs]</a>
    <span class="k">def</span> <span class="nf">switch_for_given_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_to_change</span><span class="p">,</span> <span class="n">new_unit</span><span class="p">,</span> <span class="n">custom_change</span><span class="p">,</span> <span class="n">L_unit_understood</span><span class="p">,</span> <span class="n">L_corresponding_value</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">new_unit</span> <span class="o">==</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_to_change</span> <span class="o">+</span> <span class="s1">&#39;_dim&#39;</span><span class="p">):</span>
            <span class="c1"># nothing to change, same unit:</span>
            <span class="k">return</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">new_unit</span> <span class="ow">in</span> <span class="n">L_unit_understood</span><span class="p">:</span>
            <span class="n">coeff_to_switch</span> <span class="o">=</span> <span class="p">(</span><span class="n">L_corresponding_value</span><span class="p">[</span><span class="n">L_unit_understood</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">new_unit</span><span class="p">)]</span><span class="o">/</span><span class="n">L_corresponding_value</span><span class="p">[</span><span class="n">L_unit_understood</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_to_change</span> <span class="o">+</span> <span class="s1">&#39;_value&#39;</span><span class="p">))])</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_to_change</span> <span class="o">+</span> <span class="s1">&#39;_dim&#39;</span><span class="p">))</span>
            <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_to_change</span> <span class="o">+</span> <span class="s1">&#39;_value&#39;</span><span class="p">,</span> <span class="n">new_unit</span><span class="p">)</span> 
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">custom_change</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;This unit is not taken into account yet. Here are the unit understood for the &#39;</span> <span class="o">+</span> <span class="n">unit_to_change</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">L_unit_understood</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;. Your unit, &#39;</span> <span class="o">+</span> <span class="n">new_unit</span> <span class="o">+</span> <span class="s1">&#39;, will replace the old one, &#39;</span> <span class="o">+</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_to_change</span> <span class="o">+</span> <span class="s1">&#39;_value&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, using the convertion factor defined in the variable XXX : &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">custom_change</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;. Note that it is understood that: new_unit = old_unit*XXX. Example: 1m = (10**10)*1A.&#39;</span><span class="p">)</span>
                <span class="n">coeff_to_switch</span> <span class="o">=</span> <span class="n">custom_change</span><span class="o">**</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="o">*</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_to_change</span> <span class="o">+</span> <span class="s1">&#39;_dim&#39;</span><span class="p">))</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_to_change</span> <span class="o">+</span> <span class="s1">&#39;_value&#39;</span><span class="p">,</span> <span class="n">new_unit</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: Since this unit is not taken into account yet, you have to define the convertion factor defined in the optional input XXX. Note that it is understood that: new_unit = old_unit*XXX. Example: 1m = (10**10)*1A. Here are the unit understood for the &#39;</span> <span class="o">+</span> <span class="n">unit_to_change</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">L_unit_understood</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;. Your unit: &#39;</span> <span class="o">+</span> <span class="n">new_unit</span> <span class="o">+</span> <span class="s1">&#39;, the old one: &#39;</span> <span class="o">+</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_to_change</span> <span class="o">+</span> <span class="s1">&#39;_value&#39;</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
        <span class="k">return</span><span class="p">(</span><span class="n">coeff_to_switch</span><span class="p">)</span></div>

    
<span class="c1">#################################################################################################################################   </span>

<div class="viewcode-block" id="unit.print_unit">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.unit.print_unit">[docs]</a>
    <span class="k">def</span> <span class="nf">print_unit</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_name</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">custom_name</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">name</span> <span class="o">=</span> <span class="sa">r</span><span class="s1">&#39;&#39;</span>
            <span class="k">for</span> <span class="n">unit_used</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_unit_used</span><span class="p">:</span>
                <span class="n">name</span> <span class="o">+=</span> <span class="n">construct_pow_name_unit</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_used</span> <span class="o">+</span> <span class="s1">&#39;_value&#39;</span><span class="p">),</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">unit_used</span> <span class="o">+</span> <span class="s1">&#39;_dim&#39;</span><span class="p">))</span>
            <span class="n">name</span> <span class="o">=</span> <span class="n">name</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
            <span class="k">return</span><span class="p">(</span><span class="n">name</span><span class="p">)</span></div>
</div>

        
<span class="c1">#################################################################################################################################    </span>
<div class="viewcode-block" id="construct_pow_name_unit">
<a class="viewcode-back" href="../../Frog.html#Frog.class_DiagramParameter.construct_pow_name_unit">[docs]</a>
<span class="k">def</span> <span class="nf">construct_pow_name_unit</span><span class="p">(</span><span class="n">name_unit</span><span class="p">,</span> <span class="n">pow_unit</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">pow_unit</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span><span class="p">(</span><span class="n">name_unit</span> <span class="o">+</span> <span class="s1">&#39;.&#39;</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span> 
        <span class="k">return</span><span class="p">(</span><span class="n">name_unit</span> <span class="o">+</span> <span class="s1">&#39;^{&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">pow_unit</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;}.&#39;</span><span class="p">)</span></div>



<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################</span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/frog_logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Installation/how_to_install_frog.html">1. How to Install Frog?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tutorials/tutorial_index.html">2. Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GlobalParameter/gp_index.html">3. Global Parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../MoleculeType/mt_index.html">4. Molecule Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Diagram/diagram_index.html">5. Diagram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../OpticalAnalysis/optical_analysis_index.html">6. Optical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Frog.html">7. Frog package</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Guillaume Le Breton.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
    </div>

    

    
  </body>
</html>