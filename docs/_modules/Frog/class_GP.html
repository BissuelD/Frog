<!DOCTYPE html>

<html lang="en" data-content_root="../../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Frog.class_GP &#8212; Frog 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../../_static/_static/css/s4defs-roles.css" />
    <script src="../../_static/documentation_options.js?v=8d563738"></script>
    <script src="../../_static/doctools.js?v=888ff710"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
   
  <link rel="stylesheet" href="../../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <h1>Source code for Frog.class_GP</h1><div class="highlight"><pre>
<span></span><span class="c1">##############################################################################</span>
<span class="c1">#                                                                            #</span>
<span class="c1">#    FROG: FROm molecular dynamics to second harmonic Generation             #</span>
<span class="c1">#    Copyright (C) 2024                                                      #</span>
<span class="c1">#    Author list                                                             #</span>
<span class="c1">#                                                                            #</span>
<span class="c1">#    Guillaume Le Breton                                                     #</span>
<span class="c1">#    Oriane Bonhomme                                                         #</span>
<span class="c1">#    Emmanuel Benichou                                                       #</span>
<span class="c1">#    Claire Loison                                                           #</span>
<span class="c1">#                                                                            # </span>
<span class="c1">#    This program is free software: you can redistribute it and/or modify    #</span>
<span class="c1">#    it under the terms of the GNU General Public License as published by    #</span>
<span class="c1">#    the Free Software Foundation, either version 3 of the License, or       #</span>
<span class="c1">#    (at your option) any later version.                                     #</span>
<span class="c1">#                                                                            #</span>
<span class="c1">#    This program is distributed in the hope that it will be useful,         #</span>
<span class="c1">#    but WITHOUT ANY WARRANTY; without even the implied warranty of          #</span>
<span class="c1">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the           #</span>
<span class="c1">#    GNU General Public License for more details.                            #</span>
<span class="c1">#                                                                            #</span>
<span class="c1">#    You should have received a copy of the GNU General Public License       # </span>
<span class="c1">#    along with this program.  If not, see &lt;https://www.gnu.org/licenses/    #</span>
<span class="c1">#                                                                            #</span>
<span class="c1">##############################################################################</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">importlib</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">logging</span>
<span class="kn">import</span> <span class="nn">MDAnalysis</span>

<span class="kn">import</span> <span class="nn">Frog.toolbox</span> <span class="k">as</span> <span class="nn">toolbox</span>
<span class="kn">import</span> <span class="nn">Frog.messages</span> <span class="k">as</span> <span class="nn">messages</span>
<span class="kn">import</span> <span class="nn">Frog.error_messages</span> <span class="k">as</span> <span class="nn">error_messages</span>
<span class="kn">from</span> <span class="nn">Frog.error_messages</span> <span class="kn">import</span> <span class="n">NotAnOptionError</span>

<span class="kn">import</span> <span class="nn">Frog.check</span> <span class="k">as</span> <span class="nn">check</span>
<span class="kn">import</span> <span class="nn">Frog.dalton_manager_module</span> <span class="k">as</span> <span class="nn">dalton_manager_module</span>

<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################</span>

<div class="viewcode-block" id="GlobalParameter">
<a class="viewcode-back" href="../../GlobalParameter/gp_all.html#Frog.class_GP.GlobalParameter">[docs]</a>
<span class="k">class</span> <span class="nc">GlobalParameter</span><span class="p">:</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">    The GlobalParameter object is suposed to holds very basic information for the run. This object will be copied/passed to every threat if parrallel run is performed. </span>
<span class="sd">    &#39;&#39;&#39;</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39; </span>
<span class="sd">        Initialization of the global parameter object (GP). By default, all the attributes are set to &#39;NotProvided&#39; and are given by the user in the input file. During the procedure, some attributes may evolve but are close to the original one (for instance the paths for the different files). Not all the attributes have to be initialized/given by the user depending on the options used. </span>
<span class="sd">        &#39;&#39;&#39;</span>
 
        <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute_path</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;dir_mol_times&#39;</span><span class="p">,</span> <span class="s1">&#39;dir_torun_QM&#39;</span><span class="p">,</span> <span class="s1">&#39;dir_submission_file&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute_MD</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;MD_file_name_topology&#39;</span><span class="p">,</span> <span class="s1">&#39;MD_file_name_traj&#39;</span><span class="p">,</span> <span class="s1">&#39;MD_file_type&#39;</span><span class="p">,</span> <span class="s1">&#39;MD_convertion_to_angstrom&#39;</span><span class="p">,</span> <span class="s1">&#39;MD_cut_trajectory&#39;</span><span class="p">,</span> <span class="s1">&#39;nbr_time_step&#39;</span><span class="p">,</span> <span class="s1">&#39;trotter_step&#39;</span><span class="p">,</span> <span class="s1">&#39;box_size&#39;</span><span class="p">,</span> <span class="s1">&#39;total_number_molecule&#39;</span><span class="p">,</span> <span class="s1">&#39;total_time_step&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute_QM</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IS_run_QM&#39;</span><span class="p">,</span> <span class="s1">&#39;redo_QM&#39;</span><span class="p">,</span> <span class="s1">&#39;max_submission_QM&#39;</span><span class="p">,</span> <span class="s1">&#39;nbr_job_parr_QM&#39;</span><span class="p">,</span> <span class="s1">&#39;nbr_repetition_QM_perMT&#39;</span><span class="p">,</span><span class="s1">&#39;nbr_mpi_dalton&#39;</span> <span class="p">,</span><span class="s1">&#39;dalton_run_option&#39;</span> <span class="p">,</span><span class="s1">&#39;scratch_dir&#39;</span><span class="p">,</span> <span class="s1">&#39;command_launch_job&#39;</span><span class="p">,</span> <span class="s1">&#39;submit_job_array&#39;</span><span class="p">,</span> <span class="s1">&#39;submit_array_maxjobs&#39;</span><span class="p">,</span> <span class="s1">&#39;file_template_script_run_QM&#39;</span><span class="p">,</span> <span class="s1">&#39;PE_max_level&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_QM_box&#39;</span><span class="p">,</span> <span class="s1">&#39;preference_functional&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_effective_field&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute_effective_field</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;IS_effective_field&#39;</span><span class="p">,</span> <span class="s1">&#39;ef_list_frequency&#39;</span><span class="p">,</span> <span class="s1">&#39;ef_max_iter&#39;</span><span class="p">,</span> <span class="s1">&#39;ef_max_diff_norm&#39;</span><span class="p">,</span> <span class="s1">&#39;ef_max_distance_neigh&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute_other</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;general_path&#39;</span><span class="p">,</span> <span class="s1">&#39;pass_first_part&#39;</span><span class="p">,</span> <span class="s1">&#39;nbr_parra&#39;</span><span class="p">,</span> <span class="s1">&#39;nbr_time_step_core&#39;</span><span class="p">,</span> <span class="s1">&#39;env_authorised_pbc_condition&#39;</span><span class="p">,</span> <span class="s1">&#39;nbr_type_molecule&#39;</span><span class="p">,</span> <span class="s1">&#39;L_mt_key_mt&#39;</span><span class="p">,</span> <span class="s1">&#39;IS_layer_selection&#39;</span><span class="p">,</span> <span class="s1">&#39;layer_nbr_max&#39;</span><span class="p">]</span>

        <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute_path</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute_MD</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute_QM</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute_effective_field</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute_other</span> 
            
        <span class="c1"># parameters related to Frog workflow</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">general_path</span> <span class="o">=</span> <span class="s1">&#39;NotProvided&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_mol_times</span> <span class="o">=</span> <span class="s1">&#39;NotProvided&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_torun_QM</span> <span class="o">=</span> <span class="s1">&#39;NotProvided&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dir_submission_file</span> <span class="o">=</span> <span class="s1">&#39;NotProvided&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">pass_first_part</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># parameters related to the MD trajectory or molecule geometry/structure </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MD_file_name_topology</span> <span class="o">=</span> <span class="s1">&#39;NotProvided&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MD_file_name_traj</span> <span class="o">=</span> <span class="s1">&#39;NotProvided&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MD_file_type</span> <span class="o">=</span> <span class="s1">&#39;NotProvided&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MD_cut_trajectory</span> <span class="o">=</span> <span class="kc">True</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">trotter_step</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">env_authorised_pbc_condition</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">box_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MD_convertion_to_angstrom</span> <span class="o">=</span> <span class="mf">1.0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_number_molecule</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_time_step</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_parra</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span> <span class="o">=</span> <span class="p">[]</span> 
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_type_molecule</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_mt_key_mt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IS_layer_selection</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer_which_radii_MT</span> <span class="o">=</span> <span class="s1">&#39;MT&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">PE_max_level</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer_nbr_max</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="c1"># parameters related to QM calculations </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">redo_QM</span> <span class="o">=</span> <span class="s1">&#39;redo&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">file_template_script_run_QM</span> <span class="o">=</span> <span class="s1">&#39;NotProvided&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_submission_QM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">50</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_job_parr_QM</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_repetition_QM_perMT</span> <span class="o">=</span> <span class="kc">None</span> <span class="c1"># a table of int with the same length as the MT</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_mpi_dalton</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">dalton_run_option</span> <span class="o">=</span> <span class="s2">&quot;&quot;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">scratch_dir</span> <span class="o">=</span> <span class="s1">&#39;NotProvided&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">command_launch_job</span> <span class="o">=</span> <span class="s1">&#39;NotProvided&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">submit_job_array</span> <span class="o">=</span> <span class="kc">None</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">submit_array_maxjobs</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">preference_functional</span> <span class="o">=</span> <span class="s1">&#39;NotProvided&#39;</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IS_run_QM</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IS_QM_box</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="c1"># currently the only value possible: </span>
        <span class="bp">self</span><span class="o">.</span><span class="n">IS_effective_field</span> <span class="o">=</span> <span class="kc">False</span>
        
        <span class="k">def</span> <span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">            </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">            Prevent the attribution of undefine object to the class. This help avoiding bad spelling mistakes.</span>
<span class="sd">            &quot;&quot;&quot;</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">key</span><span class="p">)</span><span class="o">&gt;</span><span class="mi">1</span> <span class="ow">and</span> <span class="n">key</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;_&#39;</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">NotAnOptionError</span><span class="p">(</span><span class="s1">&#39;The name </span><span class="si">%r</span><span class="s1"> is not a valide attribute for the GlobalParameter.&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="n">key</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">NotAnOptionError</span><span class="p">(</span><span class="s1">&#39;The name </span><span class="si">%r</span><span class="s1"> is not a valide attribute for the GlobalParameter.&#39;</span> <span class="o">%</span> <span class="n">key</span><span class="p">)</span>

            <span class="nb">object</span><span class="o">.</span><span class="fm">__setattr__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">key</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">MD_file_name_topology</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [string]  </span>
<span class="sd">        </span>
<span class="sd">        The name of the molecular dynamic topology file, used to defined which atom are part of the same molecules. Apart from that, the molecule names, groups, masses or other informations is not taken into account. FROG is not designed to handle changes in the topology files in time. More informations about the supported topology files are available :ref:`here&lt;Compatible_MD_software&gt;`. Even if the file is located in the working directory, we strongly recommend to use general path::</span>

<span class="sd">            GP.MD_file_name_topology = &#39;/home/user/MD/mytopology.data&#39;</span>
<span class="sd">        </span>
<span class="sd">        Warning</span>
<span class="sd">        -------</span>
<span class="sd">        Mandatory parameter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_MD_file_name_topology</span><span class="p">)</span>
    
    <span class="nd">@MD_file_name_topology</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">MD_file_name_topology</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.MD_file_name_topology values can only be string.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.MD_file_name_topology to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_MD_file_name_topology</span> <span class="o">=</span> <span class="n">value</span>        
<span class="c1">#################################################################################################################################  </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">MD_file_name_traj</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [string] </span>
<span class="sd">        </span>
<span class="sd">        The name of the molecular dynamic trajectory file. This file should respect the topology defined in :class:`GlobalParameter.MD_file_name_topology` . More informations about the supported trajectory files are available :ref:`here&lt;Compatible_MD_software&gt;`. Even if the file is located in the working directory, we strongly recommend to use general path::</span>
<span class="sd">        </span>
<span class="sd">            GP.MD_file_name_traj = &#39;/home/user/MD/mytrajectory.dcd&#39;</span>
<span class="sd">        </span>
<span class="sd">        Warning</span>
<span class="sd">        -------</span>
<span class="sd">        Mandatory parameter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_MD_file_name_traj</span><span class="p">)</span>
    
    <span class="nd">@MD_file_name_traj</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">MD_file_name_traj</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.MD_file_name_traj values can only be string.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.MD_file_name_traj to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_MD_file_name_traj</span> <span class="o">=</span> <span class="n">value</span>        
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">MD_file_type</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [string]</span>
<span class="sd">        </span>
<span class="sd">        The type of topology and trajectory used as input, in :class:`GlobalParameter.MD_file_name_topology` and :class:`GlobalParameter.MD_file_name_traj` respectively. The type used have to be compatible with the `MDAnalysis &lt;https://www.mdanalysis.org/&gt;`_. python module. More informations about the supported MD output are available :ref:`here&lt;Compatible_MD_software&gt;`.</span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        For an LAMMPS output, use: ::</span>
<span class="sd">             </span>
<span class="sd">            GP.MD_file_name_topology = &#39;/home/user/MD/mytopology.data&#39;</span>
<span class="sd">            GP.MD_file_name_traj = &#39;/home/user/MD/mytrajectory.dcd&#39;</span>
<span class="sd">            GP.MD_file_type = &#39;LAMMPS&#39;</span>
<span class="sd">            </span>
<span class="sd">        You can try to open your topology/trajectory if you have trouble to deal with these parameters in Frog. To open the MD trajectory with MDAnalysis, Frog use: ::</span>
<span class="sd">            </span>
<span class="sd">            u = MDAnalysis.Universe(GP.MD_file_name_topology, GP.MD_file_name_traj, format=GP.MD_file_type) </span>
<span class="sd">            </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Do not hesitate to try out combinaison of topology-trajectory which would have not been yet presented in the :ref:`doc&lt;Compatible_MD_software&gt;` and to send us feedback for any working combinaison. </span>
<span class="sd">        </span>
<span class="sd">        Warning</span>
<span class="sd">        -------</span>
<span class="sd">        Mandatory parameter</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_MD_file_type</span><span class="p">)</span>
    
    <span class="nd">@MD_file_type</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">MD_file_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.MD_file_type values can only be string.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.MD_file_type to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_MD_file_type</span> <span class="o">=</span> <span class="n">value</span>     
<span class="c1">#################################################################################################################################  </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">MD_convertion_to_angstrom</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [float] </span>
<span class="sd">        </span>
<span class="sd">        The convertion to apply to get the distance of the MD trajectory in Angstrom. If not provieded, Frog assume that the unit of the MD is already Angstrom. </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        If you want to rescale your MD trajectory by 0.529177, use: ::</span>
<span class="sd">        </span>
<span class="sd">            GP.MD_convertion_to_angstrom = 0.529177</span>
<span class="sd">            </span>
<span class="sd">        Position used by frog = (Position MD) x (GP.MD_convertion_to_angstrom)</span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Use float not integer -- 1.0 instead of 1 for instance. </span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        There is no real need to use Angstrom unit. You just have to be coherent with the values defined everywhere in Frog and in the Molecular library file. Be aware that the Anstrom unit are expected in the current procedure with Dalton.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_MD_convertion_to_angstrom</span><span class="p">)</span>
    
    <span class="nd">@MD_convertion_to_angstrom</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">MD_convertion_to_angstrom</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">float</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.MD_convertion_to_angstrom values can only be float.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.MD_convertion_to_angstrom to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_MD_convertion_to_angstrom</span> <span class="o">=</span> <span class="n">value</span>        
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">MD_cut_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [boolean] </span>
<span class="sd">        </span>
<span class="sd">        If set to True, the trajectory will be cut in several file in order to have one time step per file. This option is made in order to reduce the RAM memory needed. The piece of trajectory are saved in the GP.dir_mol_times directory. By default True. </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        ::</span>
<span class="sd">            </span>
<span class="sd">            GP.MD_cut_trajectory = True</span>
<span class="sd">            </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        If you deal with a very small trajectory, it may not worth it to cut it: set GP.MD_cut_trajectory. Otherwise, it seems a good safe-guard to avoid impacting the initial trajectory. Indeed, the initial trajectory will be read at the very begining of the Frog run to perform the cut, and then will not be open again. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_MD_cut_trajectory</span><span class="p">)</span>
    
    <span class="nd">@MD_cut_trajectory</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">MD_cut_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.MD_cut_trajectory values can only be bool.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.MD_cut_trajectory to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_MD_cut_trajectory</span> <span class="o">=</span> <span class="n">value</span>        
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nbr_time_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [integer] </span>
<span class="sd">        </span>
<span class="sd">        Define the total number of frame to treat. </span>
<span class="sd">        If set to 0, treat the maximal frame number possible depending on the total number of frame available in the MD trajectory and the value of :class:`GlobalParameter.trotter_step` . The default value is 1.  </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        ::</span>
<span class="sd">        </span>
<span class="sd">            GP.nbr_time_step = 80</span>
<span class="sd">            GP.trotter_step = 4</span>
<span class="sd">            </span>
<span class="sd">        Will treat the MD snapshot each 4 available frame up to 80, ie the frame number 1, 5, 9, ...</span>
<span class="sd">        </span>
<span class="sd">        ::</span>
<span class="sd">        </span>
<span class="sd">            GP.nbr_time_step = 0 </span>
<span class="sd">            GP.trotter_step = 10</span>
<span class="sd">        </span>
<span class="sd">        If the MD trajectory contains 100 frames, FROG will treat 10 snapshot separated by 10 frames, ie the frame 1, 11, .. 101         </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nbr_time_step</span><span class="p">)</span>
    
    <span class="nd">@nbr_time_step</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">nbr_time_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.nbr_time_step values can only be interger.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.nbr_time_step to: </span><span class="si">%i</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nbr_time_step</span> <span class="o">=</span> <span class="n">value</span>
<span class="c1">#################################################################################################################################    </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">trotter_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [integer]</span>
<span class="sd">        </span>
<span class="sd">        How many consecutive frame are not treated (1 means every frame are treated, 2, only one over 2, ect..). The default is 1. See :class:`GlobalParameter.nbr_time_step` for more information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_trotter_step</span><span class="p">)</span>
    
    <span class="nd">@trotter_step</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">trotter_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">NotAnOptionError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.trotter_step values can only be interger =&gt; 1!&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.trotter_step values can only be interger =&gt; 1!&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.trotter_step to: </span><span class="si">%i</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_trotter_step</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">box_size</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [float, float, float]</span>
<span class="sd">        </span>
<span class="sd">        The first time step MD box size. Used to print some information to the user. </span>
<span class="sd">        </span>
<span class="sd">        Should not be defined by the user -- would be overwritten in any case.</span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        In Frog, the MD box size is update for every frame. This variable is used just for printing user-friendly information.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_box_size</span><span class="p">)</span>
    
    <span class="nd">@box_size</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">box_size</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.box_size values can only be list&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.box_size to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_box_size</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">total_number_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [integer]</span>
<span class="sd">        </span>
<span class="sd">        The total number of molecule read in the topology file. </span>
<span class="sd">        </span>
<span class="sd">        Should not be defined by the user -- would be overwritten in any case.</span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        The number of molecule and atom SHALL remain the same throughout all the MD trajectory. There is no safeguard to prevent Frog to make mistake if it is not the case!!!</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_total_number_molecule</span><span class="p">)</span>
    
    <span class="nd">@total_number_molecule</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">total_number_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.total_number_molecule values can only be int&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.total_number_molecule to: </span><span class="si">%i</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total_number_molecule</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">total_time_step</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [integer]</span>
<span class="sd">        </span>
<span class="sd">        The total number of time step read in the topology file. To define it, use GP.nbr_time_step and GP.trotter_step</span>
<span class="sd">        </span>
<span class="sd">        Should not be defined by the user -- would be overwritten in any case.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_total_time_step</span><span class="p">)</span>
    
    <span class="nd">@total_time_step</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">total_time_step</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values. </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.total_time_step values can only be int&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.total_time_step to: </span><span class="si">%i</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_total_time_step</span> <span class="o">=</span> <span class="n">value</span>    
<span class="c1">#################################################################################################################################</span>
<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">general_path</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [string]</span>
<span class="sd">        </span>
<span class="sd">        The general path used to defined all the other path of the directory. By default, it will be set to the working directory. </span>
<span class="sd">        You may define the directory with or without the final &#39;/&#39;: ::  </span>
<span class="sd">        </span>
<span class="sd">            GP.general_path = &#39;/home/user/MD/My_systeme/Frog_Analysis&#39;</span>
<span class="sd">            GP.general_path = &#39;/home/user/MD/My_systeme/Frog_Analysis/&#39;</span>
<span class="sd">        </span>
<span class="sd">        If you want to not use this behaviour -- for instance you want to define yourself every directory -- you can set GP.general_path to &#39;/&#39;. You may also define the other directory attribute with a starting &#39;//&#39;. For instance, If you want to set the QM datas at: `/scratch/myname/Datas/Frog/Water_QM` ::</span>
<span class="sd">            </span>
<span class="sd">            GP.general_path = &#39;/home/user/MD/My_systeme/Whatever/&#39;</span>
<span class="sd">            GP.dir_torun_QM = &#39;//scratch/myname/Datas/Frog/Water_QM&#39;</span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        The general_path does not affect the location of the GP.MD_file_name_topology and GP.MD_file_name_traj. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_general_path</span><span class="p">)</span>
    
    <span class="nd">@general_path</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">general_path</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.general_path values can only be string.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.general_path to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_general_path</span> <span class="o">=</span> <span class="n">value</span>        
<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dir_mol_times</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [string]</span>
<span class="sd">        </span>
<span class="sd">        The directory used to store the molecular properties for each time step. These data are not humain-readable intented. These datas can become heavy depending on the number of molecule, time step and the number of analysis required.  The path is updated using the GP.general_path attribute. The default value is &quot;Molecule_times&quot;.</span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        If no GP.dir_mol_times is declared, the results are saved at `GP.general_path/Molecule_times`.</span>
<span class="sd">        </span>
<span class="sd">        If `GP.dir_mol_times = Datas/Molecule_in_time`, the results are saved at :  `GP.general_path/Datas/Molecule_in_time`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dir_mol_times</span><span class="p">)</span>
    
    <span class="nd">@dir_mol_times</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">dir_mol_times</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.dir_mol_times values can only be string.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.dir_mol_times to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dir_mol_times</span> <span class="o">=</span> <span class="n">value</span>           
<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dir_torun_QM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [string]</span>
<span class="sd">        </span>
<span class="sd">        The directory used to store the QM directories: the input script and the results. A large number of directory can be created if many QM simulations are required and thus occupied large amount of space eventhough each file (input file or the result) are small. These data are humain-readable and we strongly recommand to have a look from time to time. The path is updated using the GP.general_path attribute. The default value is &quot;QM_Simulations&quot;.</span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        If no GP.dir_torun_QM is declared, the results are saved at `GP.general_path/QM_Simulations`.</span>
<span class="sd">        </span>
<span class="sd">        If you want to set the QM datas at: &quot;/scratch/myname/Datas/Frog/Water_QM&quot;, you have to set `GP.dir_torun_QM = &quot;/scratch/myname/Datas/Frog/Water_QM&quot;`.</span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        If possible, we recommand to set this directory to a place where the writting/openning of the files are easely efficient. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dir_torun_QM</span><span class="p">)</span>
    
    <span class="nd">@dir_torun_QM</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">dir_torun_QM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.dir_torun_QM values can only be string.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.dir_torun_QM to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dir_torun_QM</span> <span class="o">=</span> <span class="n">value</span>           
<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dir_submission_file</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [string]</span>
<span class="sd">        </span>
<span class="sd">        The directory used to store the script needed to launch the QM run on a cluster. A large number of file can be created if many QM simulations are required, but it should not occupy a large amount of space. These script are humain-readable. The path is updated using the GP.general_path attribute. The default value is &quot;Submission_script&quot;.</span>

<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        If no GP.dir_submission_file is declared, the results are saved at `GP.general_path/Submission_script`.</span>
<span class="sd">        </span>
<span class="sd">        If `GP.dir_submission_file = Dir_sge/`, the results are saved at :  `GP.general_path/Dir_sge`</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dir_submission_file</span><span class="p">)</span>
    
    <span class="nd">@dir_submission_file</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">dir_submission_file</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.dir_submission_file values can only be string.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.dir_submission_file to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dir_submission_file</span> <span class="o">=</span> <span class="n">value</span>                  
<span class="c1">################################################################################################################################# </span>
<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nbr_parra</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [integer]</span>
<span class="sd">        </span>
<span class="sd">        Maximal number of core on which the first and third part of the run will be parralelized. This is number is NOT related to the parralelization of the QM runs. OpenMP is required to performed this parralelization. The default value is 1.</span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        ::</span>
<span class="sd">        </span>
<span class="sd">            GP.nbr_time_step = 80</span>
<span class="sd">            GP.nbr_parra = 2 </span>
<span class="sd">        </span>
<span class="sd">        The total number of frame treat is 80, and 2 cores will be used. Each core will treat 40 frames. ::</span>
<span class="sd">        </span>
<span class="sd">            GP.nbr_time_step = 5</span>
<span class="sd">            GP.nbr_parra = 2 </span>
<span class="sd">        </span>
<span class="sd">        The total number of frame treat is 5, and 2 cores will be used. One core will treat 3 frames, the other 2.</span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        If GP.nbr_parra &gt; GP.nbr_time_step, the GP.nbr_parra is set to GP.nbr_time_step.</span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Be aware that the RAM may become important, so do not overload your (personal) computer and try small GP.nbr_parra to start with.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        If you use parallelization, it is recommanded to cut the MD trajectory to not overload the RAM and for savety (of the MD trajectory file: otherwise it would be read by several core at the same time.). Set  :ref:`GP.MD_cut_trajectory&lt;autodoc_gp_MD_cut_trajectory&gt;` to True (default value). </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nbr_parra</span><span class="p">)</span>
    
    <span class="nd">@nbr_parra</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">nbr_parra</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.nbr_parra values can only be integer.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.nbr_parra to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nbr_parra</span> <span class="o">=</span> <span class="n">value</span>       
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">pass_first_part</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [bool] </span>
<span class="sd">        </span>
<span class="sd">        Defined if the first part should be perform or not. This appribute has been created to deal with QM calculation. </span>
<span class="sd">        </span>
<span class="sd">        Default value False: Frog perform the first part and overwrite the previous results. </span>
<span class="sd">        </span>
<span class="sd">        If set to True, the first part of the run will be skiped if possible all the moleculetype file are found in the dir_mol_times directory for every time step required. </span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Frog do not check if the input file is the same for the previous calculation used for the restart, and the one provided (which have launch this calculation). The MT object are the same as the one defined in the previous calculation, while the GP is the one of the new parameters. This has been done in order to make possible to change the attribute relative to the QM management -- in the GP parameters. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_pass_first_part</span><span class="p">)</span>
    
    <span class="nd">@pass_first_part</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">pass_first_part</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">bool</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.pass_first_part values can bool.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.pass_first_part to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_pass_first_part</span> <span class="o">=</span> <span class="n">value</span>  
<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">redo_QM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [string] </span>
<span class="sd">        </span>
<span class="sd">        If set to &#39;redo&#39;, the QM calculation inputs are written in the first part for every molecule which need a QM calculation. The QM calculation should be then done in the second part to be read in the third part. This is the default.  </span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        If set to &#39;do_not_redo&#39;, Frog will try to check if the QM calculation for a molecule have been already performed. For a molecule which QM calculation have to be performed, it tries to open the expected Dalton result file. It check if the result is readable -- meaning the QM calculation endded. If it is, the QM input for this configuration are not written, and the QM calculation is considerated are already performed. The results read in the third part are the one written in this file.</span>
<span class="sd">        </span>
<span class="sd">        Warning</span>
<span class="sd">        -------</span>
<span class="sd">        Frog does not check if the QM parameter for the target molecule (like the functional used) or the neighborhood is the same in the already available file and the input parameter. If you have a doubt, you should use  redo_QM = &#39;redo&#39;. </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        ::</span>
<span class="sd">            </span>
<span class="sd">            GP.redo_QM = &#39;redo&#39;</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_redo_QM</span><span class="p">)</span>
    
    <span class="nd">@redo_QM</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">redo_QM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.redo_QM values can only be bool.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">value</span> <span class="o">!=</span> <span class="s1">&#39;do_not_redo&#39;</span> <span class="ow">and</span> <span class="n">value</span> <span class="o">!=</span><span class="s1">&#39;redo&#39;</span><span class="p">:</span>
            <span class="k">raise</span> <span class="n">NotAnOptionError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.redo_QM can only be &quot;redo&quot; or &quot;do_not_redo&quot;.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.redo_QM to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_redo_QM</span> <span class="o">=</span> <span class="n">value</span>   
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">file_template_script_run_QM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [str] </span>
<span class="sd">        </span>
<span class="sd">        The file used to create every submission script. The line relative to the QM run are added at the end of the script. Please note that the file name is update with GP.general_path. The created submission files are written in the GP.dir_submission_file directory. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_file_template_script_run_QM</span><span class="p">)</span>
    
    <span class="nd">@file_template_script_run_QM</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">file_template_script_run_QM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.file_template_script_run_QM values can str.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.file_template_script_run_QM to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_file_template_script_run_QM</span> <span class="o">=</span> <span class="n">value</span>   
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">scratch_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [str] </span>
<span class="sd">        </span>
<span class="sd">        Define the directory where the temporary Dalton file will be written. Note that this directory is NOT the one where the result of the QM simulation is stored. By default, if the QM simulation ended without an error, these temporary file will be deleted. </span>
<span class="sd">        </span>
<span class="sd">        However, if many QM calculation are running at the same time, a large amount of (disk) memory can be used. Therefore, we recommand to use a /tmp or a /scratch to perform these calculation. </span>
<span class="sd">        </span>
<span class="sd">        Today, the chosen implementation is to write in the submission script the line: &lt; &#39;export DALTON_TMPDIR=&#39; + scratch_dir &gt;. </span>
<span class="sd">        </span>
<span class="sd">        Therefore, we recommand to use: scratch_dir = &#39;$SCRATCH_DIR&#39;, and to define the variable &quot;SCRATCH_DIR&quot; in the GP.file_template_script_run_QM. This way, you can define very precisly where the temporary file should be written within your (cluister) submission file. You can for instance define an automatic selection within the submission file to chose which scratch directory to use in function of the cluster/node it is run on.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_scratch_dir</span><span class="p">)</span>
    
    <span class="nd">@scratch_dir</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">scratch_dir</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.scratch_dir values can str.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.scratch_dir to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_scratch_dir</span> <span class="o">=</span> <span class="n">value</span>  
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">max_submission_QM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [int] </span>
<span class="sd">        </span>
<span class="sd">        The number of jobs which can be prepared by the software to perform the QM simulations. This option has been made in order to avoid trouble when submitting a lot of job to a cluster -- for instance sending 100 000 jobs to a cluster...</span>
<span class="sd">        </span>
<span class="sd">        Using this option, you might not be able to perform all the QM simulation at the same time. If it is so, you should wait that the QM calculation already sent end, then re-run the programme in order to treat the rest of the QM simulation and resumit to the cluster the rest of the QM simulation. </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        ::</span>
<span class="sd">            </span>
<span class="sd">            GP.max_submission_QM = 100</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_max_submission_QM</span><span class="p">)</span>
    
    <span class="nd">@max_submission_QM</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">max_submission_QM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.max_submission_QM values can only be int above 0.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.max_submission_QM to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_max_submission_QM</span> <span class="o">=</span> <span class="n">value</span>   

<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nbr_job_parr_QM</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [int] </span>
<span class="sd">        </span>
<span class="sd">        The number of QM simulation which run at the same time on a server. </span>
<span class="sd">        </span>
<span class="sd">        For exemple, set to 1 to have one QM simulation runing for every jobs submitted to the cluster -- for monocore CPUs. </span>
<span class="sd">        </span>
<span class="sd">        Set 8 to have 8 QM simulations running for every jobs submitted to the cluster -- designed to run on multicore CPUs. Note that no memory sharing is needed to perform several QM simulation on a single server (no OpenMPi mandatory) since every QM simulation can be performed independently. </span>
<span class="sd">        </span>
<span class="sd">        The maximum number of QM simulation witch can be launched simultaneously is: nbr_job_parr_QM*max_submission_QM. </span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Please be aware that the memory needed for every QM simulation can be large: check the RAM available and where you write the temporary Dalton files. For instance, if 100 QM simulation are running on the same time on the cluster, a lot of reading/writting file will be occuring (temporary Dalton files) and may slow down the cluster. /tmp or a scratch directory should be used for these temporary file, see the scratch_dir variable.</span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        The template used to define how to send job to the cluster (GP.file_template_script_run_QM) must match with this nbr_job_parr_QM. If the template ask only for 4 cores while nbr_job_parr_QM = 8 you may have some trouble. See the Tutorials. </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        ::</span>
<span class="sd">            </span>
<span class="sd">            GP.nbr_job_parr_QM = 16</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nbr_job_parr_QM</span><span class="p">)</span>
    
    <span class="nd">@nbr_job_parr_QM</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">nbr_job_parr_QM</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.nbr_job_parr_QM values can only be int above 0.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.nbr_job_parr_QM to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nbr_job_parr_QM</span> <span class="o">=</span> <span class="n">value</span>   

<span class="c1">################################################################################################################################# </span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nbr_repetition_QM_perMT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** list of [int] of length GP.nbr_type_molecule, ie one int for each MT</span>
<span class="sd">        </span>
<span class="sd">        The number of repetitions for the bunches of (nbr_job_parr_QM)  QM simulations  run at the same time on the server. </span>
<span class="sd">        Using the parallel command that will run nbr_job_parr_QM at the same time.</span>
<span class="sd">        </span>
<span class="sd">        For exemple, set to 1 to have one bunch of nbr_job_parr_QM QM simulation runing</span>
<span class="sd">        for every jobs submitted to the cluster .</span>
<span class="sd">        </span>
<span class="sd">        Set 10 to have (10 * nbr_job_parr_QM) in each QM_todo file for the QM simulations running for every </span>
<span class="sd">        jobs submitted to the cluster .</span>
<span class="sd">        </span>
<span class="sd">        The maximum number of QM simulation witch can be launched simultaneously is NOT affected by nbr_repetition_QM_perMT !</span>
<span class="sd">        It remains nbr_job_parr_QM*max_submission_QM.</span>
<span class="sd">        But the TIME NEEDED for 1 job to be finished will be multiplied by nbr_repetition_QM_perMT.</span>
<span class="sd">        </span>
<span class="sd">        This is particularly usefull if the QM calculation times for the available MTs are quite different. Using this attribute, you can send jobs on the cluster which will last about the same time by asking for more QM calculations per jobs for the small MT and fewer for the large one. </span>
<span class="sd">           </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        ::</span>
<span class="sd">            </span>
<span class="sd">            GP.nbr_repetition_QM_perMT = [10,1] if one want 10 repetitions for the MT numbered 0,and 1 repatition for MT numbered 1</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nbr_repetition_QM_perMT</span><span class="p">)</span>
    
    <span class="nd">@nbr_repetition_QM_perMT</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">nbr_repetition_QM_perMT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.nbr_repetition_QM_perMT values can only be None or a list. If a list, it should contain int.&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">value</span><span class="p">:</span>
                    <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">item</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                        <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.nbr_repetition_QM_perMT values can only be None or a list. If a list, it should contain positif int.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Setting GP.nbr_repetition_QM_perMT to: </span><span class="si">{</span><span class="n">value</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nbr_repetition_QM_perMT</span> <span class="o">=</span> <span class="n">value</span>   

<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nbr_mpi_dalton</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [int] </span>
<span class="sd">        </span>
<span class="sd">        The number of MPI processes for each dalton calculation. </span>
<span class="sd">        </span>
<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        Please be aware that the memory needed for every QM simulation can be large: check the RAM available and where you write the temporary Dalton files. </span>

<span class="sd">        Note</span>
<span class="sd">        ----</span>
<span class="sd">        The template used to define how to send job to the cluster (GP.file_template_script_run_QM) must match with nbr_mpi_dalton. </span>
<span class="sd">        If the template ask only for 4 MPI processes while nbr_mpi_dalton = 8 you may have some trouble.</span>
<span class="sd">        The number of MPI processes  asked for the job to the job manager should be (nbr_mpi_dalton * nbr_job_parr_QM) </span>
<span class="sd">        </span>
<span class="sd">        For SLURM , if one demande one node using 8 mpi processes, the number of mpi tasks per node is given by</span>
<span class="sd">        #SBATCH --ntasks-per-node=8 </span>
<span class="sd">        The number of nodes is demanded by</span>
<span class="sd">        #SBATCH --nodes=1</span>

<span class="sd">        Alternatively, the total number of tasks can be asked with</span>
<span class="sd">        #SBATCH --ntasks=8</span>
<span class="sd">        This second possibility WAS NOT TESTED YET!</span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        ::</span>
<span class="sd">            </span>
<span class="sd">            GP.nbr_mpi_dalton = 4</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nbr_mpi_dalton</span><span class="p">)</span>
    
    <span class="nd">@nbr_mpi_dalton</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">nbr_mpi_dalton</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.nbr_mpi_dalton values can only be int above 0.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.nbr_mpi_dalton to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nbr_mpi_dalton</span> <span class="o">=</span> <span class="n">value</span>
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">dalton_run_option</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [str] </span>
<span class="sd">        </span>
<span class="sd">        option to add to the dalton command. Default = &quot;&quot; (no option). Please define this attribute only once and write all the option you need at once. </span>

<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        ::</span>
<span class="sd">            </span>
<span class="sd">            GP.dalton_run_option = &quot;-noarch&quot;</span>
<span class="sd">            GP.dalton_run_option = &quot;-D&quot;</span>
<span class="sd">            GP.dalton_run_option = &quot;-t&quot;</span>
<span class="sd">            GP.dalton_run_option = &quot;-noarch -D -t&quot;</span>
<span class="sd">            </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_dalton_run_option</span><span class="p">)</span>
    
    <span class="nd">@dalton_run_option</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">dalton_run_option</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">)</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.dalton_run_option values can only be str&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.dalton_run_option to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dalton_run_option</span> <span class="o">=</span> <span class="n">value</span>   

<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">submit_job_array</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [str] </span>
<span class="sd">            </span>
<span class="sd">        The command to launch a sumission script in your cluster waiting queue. For instance &#39;sbatch&#39; or &#39;qsub&#39;. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_submit_job_array</span><span class="p">)</span>
    
    <span class="nd">@submit_job_array</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">submit_job_array</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.submit_job_array must be None or str.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.submit_job_array to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_submit_job_array</span> <span class="o">=</span> <span class="n">value</span>  
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">submit_array_maxjobs</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [str] </span>

<span class="sd">        TODO!</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_submit_array_maxjobs</span><span class="p">)</span>
    
    <span class="nd">@submit_array_maxjobs</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">submit_array_maxjobs</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="n">value</span> <span class="p">:</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.submit_array_maxjobs must be None or a positive int.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.submit_array_maxjobs to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_submit_array_maxjobs</span> <span class="o">=</span> <span class="n">value</span>  

<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">command_launch_job</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [str] </span>
<span class="sd">            </span>
<span class="sd">        The command to launch a sumission script in your cluster waiting queue. For instance &#39;sbatch&#39; or &#39;qsub&#39;. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_command_launch_job</span><span class="p">)</span>
    
    <span class="nd">@command_launch_job</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">command_launch_job</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.command_launch_job values can str.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.command_launch_job to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_command_launch_job</span> <span class="o">=</span> <span class="n">value</span>  
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nbr_type_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [int] </span>
<span class="sd">        </span>
<span class="sd">        The number of Molecule Type defined by the user -- found in the list L_moleculetype.  </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nbr_type_molecule</span><span class="p">)</span>
    
    <span class="nd">@nbr_type_molecule</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">nbr_type_molecule</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">)</span> <span class="ow">or</span> <span class="n">value</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.nbr_type_molecule values can only be int above 0.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.nbr_type_molecule to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nbr_type_molecule</span> <span class="o">=</span> <span class="n">value</span>   
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">nbr_time_step_core</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [list] </span>
<span class="sd">        </span>
<span class="sd">         A list of integer (size of the list = GP.nbr_parra). Every component define the number of time step to perform for every cores during a parralelized run -- during the first and third part.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_nbr_time_step_core</span><span class="p">)</span>
    
    <span class="nd">@nbr_time_step_core</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">nbr_time_step_core</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.nbr_time_step_core values can only be list.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.nbr_time_step_core to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_nbr_time_step_core</span> <span class="o">=</span> <span class="n">value</span>   
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">IS_layer_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [bool] </span>
<span class="sd">        </span>
<span class="sd">        Set to True if there are any need of a layer geometry selection. It can be for a diagram or for QM selection. By default set to False. </span>
<span class="sd">        </span>
<span class="sd">        .. note:: This attribute is set by Frog and should not be define by the user. </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_IS_layer_selection</span><span class="p">)</span>
    
    <span class="nd">@IS_layer_selection</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">IS_layer_selection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.IS_layer_selection can only be bool. Note that it should not be set by the user&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.IS_layer_selection to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_IS_layer_selection</span> <span class="o">=</span> <span class="n">value</span>   
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">layer_nbr_max</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [int] </span>
<span class="sd">        </span>
<span class="sd">        If there are several layer geometric selection (for diagram or QM selction), layer_nbr_max contains the maximal number of layer required. The aim is to do the layer attribution only once with this maximal layer number. If some diagrams use less possible layer (for instance 2 instead of 5), then the molecule in deeper layer are assigned to 0 (for instance the molecule at the layer 3 is assigned to 0). </span>
<span class="sd">        </span>
<span class="sd">        .. note:: This attribute is set by Frog and should not be define by the user. </span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_layer_nbr_max</span><span class="p">)</span>
    
    <span class="nd">@layer_nbr_max</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">layer_nbr_max</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="nb">int</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.layer_nbr_max can only be int. Note that it should not be set by the user&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.layer_nbr_max to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_layer_nbr_max</span> <span class="o">=</span> <span class="n">value</span>   
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">layer_which_radii_MT</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [str or dict] </span>
<span class="sd">        </span>
<span class="sd">        Defines how to set the VDW radii used by pytim to attributes layer to the molecule. Precisely, the radii is the optional argument &#39;radii_dict&#39; of the function pytim.ITIM, see https://marcello-sega.github.io/pytim/guessing_radii.html</span>
<span class="sd">        </span>
<span class="sd">        </span>
<span class="sd">        Possible values:</span>
<span class="sd">        </span>
<span class="sd">            + &#39;MD&#39;: No values are set manually. Therefore, pytim try to use the Gromos 43A1 force field to attribute radii.</span>
<span class="sd">            </span>
<span class="sd">            + &#39;MT&#39;: default value, uses the values defines in the MT, using the function info_molecule_for_layer of the molecular library file. Note that if this option is used, the GP.MD_cut_trajectory is set to True. Indeed, Frog needs to modify the topology file in order to make this option work. </span>
<span class="sd">            </span>
<span class="sd">            + your_dict: you can pass directly a dictionary, which will be used as pytim.ITIM(u, radii_dict = your_dict). The name of the directory does not matter: it just has to be a directory so that this option is detected by Frog.</span>
<span class="sd">        </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_layer_which_radii_MT</span><span class="p">)</span>
    
    <span class="nd">@layer_which_radii_MT</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">layer_which_radii_MT</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">str</span><span class="p">,</span> <span class="nb">dict</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.layer_which_radii_MT can only be str or dict.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.layer_which_radii_MT to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_layer_which_radii_MT</span> <span class="o">=</span> <span class="n">value</span>   
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">env_authorised_pbc_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [list] </span>
<span class="sd">        </span>
<span class="sd">        Defines which direction can be used to built environment is needed. By default all 3 direction are supposed to be PBC. </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        GP.env_authorised_pbc_condition = [0, 1]</span>
<span class="sd">        </span>
<span class="sd">        In this case, only the X and Y direction are understood as PBC.</span>
<span class="sd">        </span>
<span class="sd">        WARNING</span>
<span class="sd">        -------</span>
<span class="sd">        FROG has been tested for 3D and 2D PBC. If you are using no PBC condition, you may want to be carefull...</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_env_authorised_pbc_condition</span><span class="p">)</span>
    
    <span class="nd">@env_authorised_pbc_condition</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">env_authorised_pbc_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.env_authorised_pbc_condition can only be a list.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">value</span><span class="p">)</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.env_authorised_pbc_condition should have at least one element! If you wish to not use the PBC condition, define a small radius to look for neighbors&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.env_authorised_pbc_condition to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_env_authorised_pbc_condition</span> <span class="o">=</span> <span class="n">value</span>   
<span class="c1">#################################################################################################################################</span>
    <span class="nd">@property</span>
    <span class="k">def</span> <span class="nf">preference_functional</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        **Type** [list] </span>
<span class="sd">        </span>
<span class="sd">        Defines which functional should be used in the case where several molecule or different MT are merged into one QM calculation. . </span>
<span class="sd">        </span>
<span class="sd">        Example</span>
<span class="sd">        -------</span>
<span class="sd">        GP.preference_functional = [&#39;FunctionalA&#39;, &#39;FunctionalB&#39;]</span>
<span class="sd">        </span>
<span class="sd">        In this case, if one molecule has for functional the &#39;FunctionalA&#39;, and the other has &#39;FunctionalB&#39; for its QMParameter, the final functional used for the graps of the 2 molecule will be &#39;FunctionalA&#39;. </span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">return</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">_preference_functional</span><span class="p">)</span>
    
    <span class="nd">@preference_functional</span><span class="o">.</span><span class="n">setter</span>
    <span class="k">def</span> <span class="nf">preference_functional</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Set value and avoid bad type or impossible values.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">if</span> <span class="ow">not</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="p">(</span><span class="nb">list</span><span class="p">,</span> <span class="nb">str</span><span class="p">)):</span>
            <span class="k">raise</span> <span class="ne">TypeError</span><span class="p">(</span><span class="s1">&#39;The attribute GlobalParameter.preference_functional can only be list.&#39;</span><span class="p">)</span>
        <span class="n">logging</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="s1">&#39;Setting GP.preference_functional to: </span><span class="si">%s</span><span class="s1">&#39;</span><span class="p">,</span> <span class="n">value</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_preference_functional</span> <span class="o">=</span> <span class="n">value</span>   
<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################</span>
<div class="viewcode-block" id="GlobalParameter.check_all_MT_initialized">
<a class="viewcode-back" href="../../GlobalParameter/gp_all.html#Frog.class_GP.GlobalParameter.check_all_MT_initialized">[docs]</a>
    <span class="k">def</span> <span class="nf">check_all_MT_initialized</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L_moleculetype</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39; </span>
<span class="sd">        Check that the MT has been properly initialized: at least all the function defining the key objects have been called in the input file! </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="k">for</span> <span class="n">moleculetype</span> <span class="ow">in</span> <span class="n">L_moleculetype</span><span class="p">:</span>
            <span class="n">moleculetype</span><span class="o">.</span><span class="n">input_section_check_update</span><span class="p">(</span><span class="n">for_check</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span></div>

        
<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################</span>
<div class="viewcode-block" id="GlobalParameter.MD_check_GP">
<a class="viewcode-back" href="../../GlobalParameter/gp_all.html#Frog.class_GP.GlobalParameter.MD_check_GP">[docs]</a>
    <span class="k">def</span> <span class="nf">MD_check_GP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39; </span>
<span class="sd">        MD part of the global parameter object (GP). The MD trajectory is openned and some general properties are stores in the GP objects.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">messages</span><span class="o">.</span><span class="n">message_with_hashtag</span><span class="p">(</span><span class="mi">74</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;Checking the MD file:&#39;</span><span class="p">)</span>    
        
        <span class="c1"># MD simulations general informations:</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MD_file_name_topology</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MD_file_name_traj</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">MD_file_type</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_number_molecule</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">residues</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">total_time_step</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MD_convertion_to_angstrom</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MD_convertion_to_angstrom</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The attribute GP.MD_convertion_to_angstrom has not been initialize. Frog assumes that the trajectory unit is Angstrom.&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The attribute GP.MD_convertion_to_angstrom has been set to: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MD_convertion_to_angstrom</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;, this value will be use to pass from the MD unit to Angstrom as follow: Angstrom = MD_unit * GP.MD_convertion_to_angstrom&#39;</span><span class="p">)</span>
    
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;In the following, the space unit used is Angstrom.&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span> <span class="mi">1</span><span class="p">:</span> <span class="mi">1</span><span class="p">]:</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MD_convertion_to_angstrom</span><span class="p">,</span> <span class="nb">bool</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">box_size</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">box_size</span> <span class="o">=</span> <span class="n">ts</span><span class="o">.</span><span class="n">dimensions</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">3</span><span class="p">]</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">MD_convertion_to_angstrom</span>
        <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_2</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
        <span class="c1"># MD_cut_trajectory</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MD_cut_trajectory</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">MD_cut_trajectory</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The attribute GP.MD_cut_trajectory has not been initialize. The default value False will be used. The trajectory file will not be cut to reduce the RAM utilisation. Please note that this can lead to slow the run if the trajectory is large.&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MD_cut_trajectory</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">MD_cut_trajectory</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The attribute GP.MD_cut_trajectory is set to True. For every time step which should be treated, a new trajectory file will be created at the GP.dir_mol_times directory.&#39;</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MD_cut_trajectory</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">MD_cut_trajectory</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The attribute GP.MD_cut_trajectory is set to False. The trajectory file will not be cut to reduce the RAM utilisation. Please note that this can lead to slow the run if the trajectory is large.&#39;</span><span class="p">)</span>
            
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: GP.MD_cut_trajectory should be True or False. You have provided: &#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MD_cut_trajectory</span><span class="p">)</span>
        
        <span class="c1"># nbr_time_step and trotter_step:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trotter_step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_3</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">trotter_step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_4</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">trotter_step</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">trotter_step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_5</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">trotter_step</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">trotter_step</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_time_step</span><span class="o">//</span><span class="bp">self</span><span class="o">.</span><span class="n">trotter_step</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_6</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">trotter_step</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">total_time_step</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">error_messages</span><span class="o">.</span><span class="n">e_101</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span> 
                <span class="k">else</span><span class="p">:</span>
                    <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_7</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>

        <span class="n">messages</span><span class="o">.</span><span class="n">message_with_hashtag</span><span class="p">(</span><span class="mi">74</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="s1">&#39;End Checking the MD file&#39;</span><span class="p">)</span>    </div>

        
<span class="c1">#################################################################################################################################</span>

<div class="viewcode-block" id="GlobalParameter.initializating_software_friendly_GP">
<a class="viewcode-back" href="../../GlobalParameter/gp_all.html#Frog.class_GP.GlobalParameter.initializating_software_friendly_GP">[docs]</a>
    <span class="k">def</span> <span class="nf">initializating_software_friendly_GP</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L_moleculetype</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function update the GP according to the given attributes/options. </span>
<span class="sd">           </span>
<span class="sd">        MD analysis &amp; Diagrams</span>
<span class="sd">        Preparing the molecules set</span>
<span class="sd">        Preparing the QM parts: Daltons inputs </span>
<span class="sd">        &#39;&#39;&#39;</span>
        
        <span class="bp">self</span><span class="o">.</span><span class="n">nbr_type_molecule</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">L_moleculetype</span><span class="p">)</span>
        <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_64</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L_moleculetype</span><span class="p">)</span>
        <span class="n">L_mt_key_mt</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">trotter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_type_molecule</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">L_mt_key_mt</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">L_moleculetype</span><span class="p">[</span><span class="n">trotter</span><span class="p">]</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">L_moleculetype</span><span class="p">[</span><span class="n">trotter</span><span class="p">]</span><span class="o">.</span><span class="n">L_key_mol</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">L_mt_key_mt</span> <span class="o">=</span> <span class="n">L_mt_key_mt</span>
        
        
        <span class="c1"># Layer description:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">IS_layer_selection</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;A layer description have been required. A new attribute for every molecule named &quot;layer&quot; is defined. The maximal layer number used is &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layer_nbr_max</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;. Note that the layer number goes from -GP.layer_nbr_max to +GP.layer_nbr_max. The positive value are for the upper layer, negative for the lower one. 0 is for the molecule in the bulk phase. The layer 1 is more in the bulk phase then the layer 4 -- contrarily to the original pytim definition. &#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layer_which_radii_MT</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_which_radii_MT</span> <span class="o">==</span> <span class="s1">&#39;MD&#39;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The GP.layer_which_radii_MT has been set to MD. The pytim module will try to deal with the initial topology file given without extra information regarding the atoms radii. You may want to check by yourself how it is done, see the documentation about the layer geometrical description for more informations and tips.&#39;</span><span class="p">)</span>
                <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_which_radii_MT</span> <span class="o">==</span> <span class="s1">&#39;MT&#39;</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The GP.layer_which_radii_MT has been set to MT. A new topology file is generated in the GP.dir_mol_times directory which contains the radii defined by the MT used to define the layer. Therefore, the GP.MD_file_name_topology is set to this new file: GP.dir_mol_times/frog_topology.pqr. Note that the GP.MD_cut_trajectory has also been set to True.&#39;</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">layer_radii_MT_definition</span><span class="p">(</span><span class="n">L_moleculetype</span><span class="p">)</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">MD_cut_trajectory</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="n">NotAnOptionError</span><span class="p">(</span><span class="s1">&#39;WARINING: the GP.layer_which_radii_MT can be set to &quot;MD&quot;, &quot;MT&quot;, or to a dictionary only. Please read the GP.layer_which_radii_MT documentation or the one about the geometry selection, and the layer section for more informations.&#39;</span><span class="p">)</span>
            <span class="k">elif</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">layer_which_radii_MT</span><span class="p">,</span> <span class="nb">dict</span><span class="p">):</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The GP.layer_which_radii_MT has been set to a dictionay. This dictionay will be used to define the radii to use for the layer calculation.&#39;</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer_which_radii_MT</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="n">NotAnOptionError</span><span class="p">(</span><span class="s1">&#39;WARINING: the GP.layer_which_radii_MT is not an str or a dict, which should not happen since the setattr of this attribute has been tuned. Please check the setattr of this attribute.&#39;</span><span class="p">)</span>
        
        <span class="c1"># QM part:</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">IS_run_QM</span><span class="p">:</span>
            <span class="c1"># Parrallelization of QM calculations on a server</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_51_a</span><span class="p">(</span><span class="s1">&#39;GP.nbr_repetition_QM_perMT&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="ow">not</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_repetition_QM_perMT</span><span class="p">:</span> <span class="c1"># default value</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nbr_repetition_QM_perMT</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_type_molecule</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_repetition_QM_perMT</span><span class="p">)</span> <span class="o">!=</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_type_molecule</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;ERROR: the size of GP.nbr_repetition_QM_perMT does not match the number of MTs! Please fix this by defining one value per MT (the order correspond to the ordering in the input file used).&#39;</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;GP.nbr_repetition_QM_perMT = </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_repetition_QM_perMT</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            
            <span class="c1"># QM input file check:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_65</span><span class="p">()</span>
            <span class="k">for</span> <span class="n">trotter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_type_molecule</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span> 
                <span class="n">moleculetype</span> <span class="o">=</span> <span class="n">L_moleculetype</span><span class="p">[</span><span class="n">trotter</span><span class="p">]</span>
                <span class="k">if</span> <span class="n">moleculetype</span><span class="o">.</span><span class="n">mtparameter</span><span class="o">.</span><span class="n">optparameter</span><span class="o">.</span><span class="n">IS_run_QM</span><span class="p">:</span>
                    <span class="n">moleculetype</span><span class="o">.</span><span class="n">check_qm_target</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                    
            <span class="c1"># Check that every molecule have a classical electrostatic description up to the maximal PE order asked:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">PE_max_level</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Only Vacuum-like QM calculation will be performed. No need to check if the molecule type declared have a proper electrostatic desciption.&#39;</span><span class="p">)</span> 
                
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">PE_max_level</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Since QM run will be performed within electrostatic environment, I will check that every molecule type have a proper charge description up to the PE order: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">PE_max_level</span><span class="p">))</span>
                <span class="k">for</span> <span class="n">trotter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_type_molecule</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">moleculetype</span> <span class="o">=</span> <span class="n">L_moleculetype</span><span class="p">[</span><span class="n">trotter</span><span class="p">]</span>
                    <span class="n">moleculetype</span><span class="o">.</span><span class="n">check_pe_environement</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        
        <span class="c1"># Check that if effective field calculation is required, for at least one MT, that all the MT has a minimal alpha description. Add also the rotational matrix for every MT.</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">IS_effective_field</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Since the effective calculation has to be perform for at least one MT, FROG will check that every MT have a proper polarizability description. Note that the value used during the effective field calculation can differ.&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ef_list_frequency</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: you have to initialize the frequency in at least one effective field parameter!&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The effective field calculation will be computed at the frequencies: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ef_list_frequency</span><span class="p">))</span>
                
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ef_max_iter</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: you have to initialize the max_iter value in at least one effective field parameter!&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The maximal iteration for the self consistant part of the effective calculation is set to be: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ef_list_frequency</span><span class="p">))</span>

            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ef_max_diff_norm</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: you have to initialize the max_diff_norm value in at least one effective field parameter!&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The maximal difference for the norm of the effective field matrix is set to be: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ef_max_diff_norm</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;. If the difference in norm between 2 consecutive self-consistance value of the effective field is smaller then this value, the procedure will be considerated converged and thus stoped.&#39;</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ef_max_distance_neigh</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: you have to initialize the max_distance_neigh value in at least one effective field parameter!&#39;</span><span class="p">)</span>
            
            <span class="k">for</span> <span class="n">trotter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_type_molecule</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                <span class="n">moleculetype</span> <span class="o">=</span> <span class="n">L_moleculetype</span><span class="p">[</span><span class="n">trotter</span><span class="p">]</span>
                <span class="n">moleculetype</span><span class="o">.</span><span class="n">check_polarizable_description</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                
        <span class="c1"># Initialized every MT object</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;</span><span class="se">\n</span><span class="s1">Initializating every molecule type: adding empty diagrams and empty molecule.&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">trotter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_type_molecule</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">moleculetype</span> <span class="o">=</span> <span class="n">L_moleculetype</span><span class="p">[</span><span class="n">trotter</span><span class="p">]</span>
            <span class="n">moleculetype</span><span class="o">.</span><span class="n">initialize_empty_for_frame</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span></div>

                    
<span class="c1">#################################################################################################################################        </span>
        
<div class="viewcode-block" id="GlobalParameter.check_GP">
<a class="viewcode-back" href="../../GlobalParameter/gp_all.html#Frog.class_GP.GlobalParameter.check_GP">[docs]</a>
    <span class="k">def</span> <span class="nf">check_GP</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        This function tests if the parameter set in the input file are coherent. It explicitly print the value understood by the software. It also checks that files can be written/openned in several directories.  </span>
<span class="sd">        </span>
<span class="sd">        First it checks how the path are set by creating a file and/or a directory at the given location. This is done to avoid unpleasant surprises after hours of calculation... </span>
<span class="sd">        Depending on the general options/parameters asked, some attribute/value have to be given or not.  </span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="c1">############################################## Directory checking #####################################</span>
        <span class="c1"># general_path:</span>
        <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_51_a</span><span class="p">(</span><span class="s1">&#39;GP.general_path&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">general_path</span> <span class="o">!=</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_52_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_52_b</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">general_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">getcwd</span><span class="p">()</span>
            <span class="c1"># For every attribute defined in the self.L_attribute_path list, the self.general_path value is added before. If the attribute is &#39;NotProvided&#39;, specific behaviour is defined later on.</span>
        <span class="c1">#print(&#39;Read attributes and options for path, directory, file:&#39;)</span>
        <span class="k">for</span> <span class="n">nameattribute</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_attribute_path</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="n">nameattribute</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nameattribute</span><span class="p">))</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nameattribute</span><span class="p">))</span> <span class="o">&gt;</span> <span class="mi">2</span> <span class="ow">and</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nameattribute</span><span class="p">)[</span><span class="mi">0</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span> <span class="o">==</span> <span class="s1">&#39;//&#39;</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nameattribute</span><span class="p">))</span>
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nameattribute</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nameattribute</span><span class="p">)[</span><span class="mi">1</span><span class="p">:])</span>
            <span class="k">else</span><span class="p">:</span>        
                <span class="nb">setattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nameattribute</span><span class="p">,</span> <span class="n">toolbox</span><span class="o">.</span><span class="n">concatenate_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">general_path</span><span class="p">,</span> <span class="nb">getattr</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">nameattribute</span><span class="p">),</span> <span class="n">right_unable</span><span class="o">=</span><span class="s1">&#39;NotProvided&#39;</span><span class="p">,</span> <span class="n">unable_return</span><span class="o">=</span><span class="s1">&#39;right&#39;</span><span class="p">))</span>
        
        <span class="c1">#dir_mol_times:</span>
        <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_51_a</span><span class="p">(</span><span class="s1">&#39;GP.dir_mol_times&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_mol_times</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">dir_mol_times</span> <span class="o">=</span> <span class="n">toolbox</span><span class="o">.</span><span class="n">concatenate_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">general_path</span><span class="p">,</span> <span class="s1">&#39;Molecule_times&#39;</span><span class="p">)</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_54_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>         
        <span class="k">else</span><span class="p">:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_54_b</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="n">toolbox</span><span class="o">.</span><span class="n">creat_directory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_mol_times</span><span class="p">)</span>    
        <span class="n">name_test_file</span> <span class="o">=</span> <span class="n">toolbox</span><span class="o">.</span><span class="n">concatenate_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_mol_times</span><span class="p">,</span> <span class="s1">&#39;test_file.txt&#39;</span><span class="p">)</span>    
        <span class="n">check</span><span class="o">.</span><span class="n">check_file_write_read</span><span class="p">(</span><span class="n">name_test_file</span><span class="p">,</span> <span class="s1">&#39;GP.dir_mol_times test ok&#39;</span><span class="p">)</span>
        <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_54_c</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="c1">############################################## Directory checking #####################################</span>
        <span class="c1">##############################################       QM part      #####################################</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">IS_run_QM</span><span class="p">,</span> <span class="nb">bool</span><span class="p">)</span> <span class="ow">and</span> <span class="bp">self</span><span class="o">.</span><span class="n">IS_run_QM</span><span class="p">:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_61_a</span><span class="p">()</span>
            <span class="c1"># dir_torun_QM:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_51_a</span><span class="p">(</span><span class="s1">&#39;GP.dir_torun_QM&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_torun_QM</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_55_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dir_torun_QM</span> <span class="o">=</span> <span class="n">toolbox</span><span class="o">.</span><span class="n">concatenate_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">general_path</span>  <span class="p">,</span> <span class="s1">&#39;QM_Simulations&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_55_b</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">dir_QM_exemple_name</span> <span class="o">=</span> <span class="n">dalton_manager_module</span><span class="o">.</span><span class="n">build_QM_file_localization</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_torun_QM</span><span class="p">,</span> <span class="s1">&#39;Test_dir&#39;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">creat_dir</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>   
            <span class="n">name_test_file</span> <span class="o">=</span> <span class="n">toolbox</span><span class="o">.</span><span class="n">concatenate_path</span><span class="p">(</span><span class="n">dir_QM_exemple_name</span> <span class="p">,</span> <span class="s1">&#39;daltons_input_files.txt&#39;</span><span class="p">)</span>
            <span class="n">check</span><span class="o">.</span><span class="n">check_file_write_read</span><span class="p">(</span><span class="n">name_test_file</span><span class="p">,</span> <span class="s1">&#39;GP.dir_torun_QM test ok&#39;</span><span class="p">)</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_55_c</span><span class="p">(</span><span class="n">dir_QM_exemple_name</span><span class="p">)</span>
            
            <span class="c1"># dir_submission_file:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_51_a</span><span class="p">(</span><span class="s1">&#39;GP.dir_submission_file&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">dir_submission_file</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">dir_submission_file</span> <span class="o">=</span> <span class="n">toolbox</span><span class="o">.</span><span class="n">concatenate_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">general_path</span><span class="p">,</span> <span class="s1">&#39;Submission_script&#39;</span><span class="p">)</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_56_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_56_b</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="n">toolbox</span><span class="o">.</span><span class="n">creat_directory</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_submission_file</span><span class="p">)</span>    
            <span class="n">check</span><span class="o">.</span><span class="n">check_file_write_read</span><span class="p">(</span><span class="n">toolbox</span><span class="o">.</span><span class="n">concatenate_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_submission_file</span><span class="p">,</span> <span class="s1">&#39;test_submission_dir.txt&#39;</span><span class="p">),</span> <span class="s1">&#39;GP.dir_submission_file test ok&#39;</span><span class="p">)</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_56_c</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span> 
            
            <span class="c1">#file_template_script_run_QM &amp; max_submission_QM:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_51_a</span><span class="p">(</span><span class="s1">&#39;GP.file_template_script_run_QM&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_template_script_run_QM</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">error_messages</span><span class="o">.</span><span class="n">e_129</span><span class="p">())</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">file_template_script_run_QM</span> <span class="o">=</span> <span class="n">toolbox</span><span class="o">.</span><span class="n">concatenate_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">general_path</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">file_template_script_run_QM</span><span class="p">)</span>
            <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">file_template_script_run_QM</span><span class="p">,</span> <span class="s1">&#39;r&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">the_file</span><span class="p">:</span>
                <span class="n">temp</span> <span class="o">=</span> <span class="n">the_file</span><span class="o">.</span><span class="n">readlines</span><span class="p">()</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_57</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_51_a</span><span class="p">(</span><span class="s1">&#39;GP.max_submission_QM&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_submission_QM</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_58_a</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">max_submission_QM</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">max_submission_QM</span><span class="p">)</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_58_b</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  
                
            <span class="c1"># How to launch the job to the cluster</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_51_a</span><span class="p">(</span><span class="s1">&#39;GP.command_launch_job&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">command_launch_job</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">error_messages</span><span class="o">.</span><span class="n">e_130</span><span class="p">())</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_59</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>  
                
            <span class="c1"># Parrallelization of QM calculations on a server             </span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_51_a</span><span class="p">(</span><span class="s1">&#39;GP.submit_job_array&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">submit_job_array</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The job array technics will be used to deal with the QM calculation on a servor using the command </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submit_job_array</span><span class="si">}</span><span class="s1">.&#39;</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">submit_array_maxjobs</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;ERROR: Since you are using the job array technics, you have to define GP.submit_array_maxjobs to a positive value.&#39;</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;The GP.submit_array_maxjobs value is </span><span class="si">{</span><span class="bp">self</span><span class="o">.</span><span class="n">submit_array_maxjobs</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The job array technics will not be used to deal with the QM calculation on a servor&#39;</span><span class="p">)</span>
            
            <span class="c1"># Redo or not the QM run:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_51_a</span><span class="p">(</span><span class="s1">&#39;GP.redo_QM&#39;</span><span class="p">)</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">redo_QM</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_60_a</span><span class="p">()</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">redo_QM</span> <span class="o">=</span> <span class="s1">&#39;do_not_redo&#39;</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">redo_QM</span> <span class="o">==</span> <span class="s1">&#39;redo&#39;</span><span class="p">:</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_60_b</span><span class="p">()</span>
            <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">redo_QM</span> <span class="o">==</span> <span class="s1">&#39;do_not_redo&#39;</span><span class="p">:</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_60_c</span><span class="p">()</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">error_messages</span><span class="o">.</span><span class="n">e_131</span><span class="p">())</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_61_b</span><span class="p">()</span>
        <span class="c1">##############################################       QM part      #####################################</span>
        <span class="c1">##############################################  Other parameters  #####################################</span>
        <span class="c1"># pass_first_part:</span>
        <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_51_a</span><span class="p">(</span><span class="s1">&#39;GP.pass_first_part&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">pass_first_part</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">pass_first_part</span> <span class="o">=</span> <span class="kc">False</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_62_a</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">pass_first_part</span> <span class="o">==</span> <span class="kc">False</span><span class="p">:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_62_b</span><span class="p">()</span>
        <span class="k">elif</span> <span class="bp">self</span><span class="o">.</span><span class="n">pass_first_part</span> <span class="o">==</span> <span class="kc">True</span><span class="p">:</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_62_c</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">error_messages</span><span class="o">.</span><span class="n">e_132</span><span class="p">())</span>
        
        <span class="c1"># nbr_parra &amp; nbr_time_step_core:</span>
        <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_51_a</span><span class="p">(</span><span class="s1">&#39;GP.nbr_parra&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_parra</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">nbr_parra</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_63_a</span><span class="p">()</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span> <span class="o">&lt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_parra</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nbr_parra</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span> <span class="o">=</span> <span class="p">[</span><span class="nb">int</span><span class="p">(</span><span class="mi">1</span><span class="p">)]</span>
                <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_63_b</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">nbr_parra</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_parra</span><span class="p">)</span>
                <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_parra</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span> <span class="o">=</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span><span class="o">//</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_parra</span><span class="p">]</span>
                    <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_63_c</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                <span class="k">else</span><span class="p">:</span>
                    <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span><span class="o">//</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_parra</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step</span><span class="o">%</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_parra</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="nb">int</span><span class="p">)</span>
                    <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_63_d</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
                    
        <span class="c1"># Options for building the environment:</span>
        <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_68_a</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">env_authorised_pbc_condition</span> <span class="o">==</span> <span class="s1">&#39;NotProvided&#39;</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">env_authorised_pbc_condition</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]</span>
            <span class="n">messages</span><span class="o">.</span><span class="n">user_frendly_68_b</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
            
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">env_authorised_pbc_condition</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">check</span><span class="o">.</span><span class="n">check_GP_env_authorised_pbc_condition</span><span class="p">(</span><span class="bp">self</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="n">error_messages</span><span class="o">.</span><span class="n">e_133</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span></div>

        <span class="c1">##############################################  Other parameters  #####################################</span>
        
<span class="c1">#################################################################################################################################</span>

<div class="viewcode-block" id="GlobalParameter.find_molecule_type">
<a class="viewcode-back" href="../../GlobalParameter/gp_all.html#Frog.class_GP.GlobalParameter.find_molecule_type">[docs]</a>
    <span class="k">def</span> <span class="nf">find_molecule_type</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">molecule_number</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Return the molecule type name for the molecule_number given. Return an Exception if it is was not implemented.</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">IS_found</span> <span class="o">=</span> <span class="kc">False</span>
        <span class="k">for</span> <span class="n">molecule_type_rep</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">L_mt_key_mt</span><span class="p">:</span>
            <span class="k">if</span> <span class="n">molecule_number</span> <span class="o">&lt;=</span> <span class="n">molecule_type_rep</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="ow">and</span> <span class="n">molecule_number</span> <span class="o">&gt;=</span> <span class="n">molecule_type_rep</span><span class="p">[</span><span class="mi">1</span><span class="p">][</span><span class="mi">0</span><span class="p">]:</span>
                <span class="n">IS_found</span> <span class="o">=</span> <span class="kc">True</span>
                <span class="n">molecule_type_name</span> <span class="o">=</span> <span class="n">molecule_type_rep</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
  
        <span class="k">if</span> <span class="ow">not</span> <span class="n">IS_found</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s1">&#39;WARNING: the molecule number: &#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">molecule_number</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39; is not attached to any molecule type. Please check the input: you may not have initialized all the molecule!&#39;</span><span class="p">)</span>

        <span class="k">return</span><span class="p">(</span><span class="n">molecule_type_name</span><span class="p">)</span></div>


<span class="c1">#################################################################################################################################</span>
<div class="viewcode-block" id="GlobalParameter.layer_radii_MT_definition">
<a class="viewcode-back" href="../../GlobalParameter/gp_all.html#Frog.class_GP.GlobalParameter.layer_radii_MT_definition">[docs]</a>
    <span class="k">def</span> <span class="nf">layer_radii_MT_definition</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">L_moleculetype</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&#39;&#39;&#39;</span>
<span class="sd">        Create a new topology file where the radii used by pytim to define the layer are set according to the MT values. The new topology file is savec as: GP.dir_mol_times/frog_topology.pqr</span>
<span class="sd">        &#39;&#39;&#39;</span>
        <span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MD_file_name_topology</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MD_file_name_traj</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">MD_file_type</span><span class="p">)</span>
        
        <span class="n">u</span><span class="o">.</span><span class="n">add_TopologyAttr</span><span class="p">(</span><span class="s1">&#39;radii&#39;</span><span class="p">)</span>
        
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Defining for every MT the radii used accordingly the MT library files&#39;</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">trotter</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_type_molecule</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
            <span class="n">moleculetype</span> <span class="o">=</span> <span class="n">L_moleculetype</span><span class="p">[</span><span class="n">trotter</span><span class="p">]</span>
            <span class="n">module_MT_name</span> <span class="o">=</span> <span class="n">toolbox</span><span class="o">.</span><span class="n">creat_name_for_MT_module_load</span><span class="p">(</span><span class="n">moleculetype</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
            <span class="n">molecule_type_module</span> <span class="o">=</span> <span class="n">importlib</span><span class="o">.</span><span class="n">import_module</span><span class="p">(</span><span class="n">module_MT_name</span><span class="p">)</span> <span class="c1">#Load the module for all the analysis and all the molecule of this type. </span>
            <span class="n">L_type_molecule_radii</span> <span class="o">=</span> <span class="n">molecule_type_module</span><span class="o">.</span><span class="n">info_molecule_for_layer</span><span class="p">()</span>
            <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;For the MT: &#39;</span> <span class="o">+</span> <span class="n">moleculetype</span><span class="o">.</span><span class="n">name</span> <span class="o">+</span> <span class="s1">&#39; the radii used are: &#39;</span><span class="p">,</span> <span class="n">L_type_molecule_radii</span><span class="p">)</span>
            <span class="k">for</span> <span class="n">kkk</span> <span class="ow">in</span> <span class="n">moleculetype</span><span class="o">.</span><span class="n">L_key_mol</span><span class="p">:</span> <span class="c1">#iteration over the molecule of this molecule type</span>
                <span class="n">u</span><span class="o">.</span><span class="n">residues</span><span class="p">[</span><span class="n">kkk</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">radii</span> <span class="o">=</span> <span class="n">L_type_molecule_radii</span> <span class="c1"># the kkk-1 is because the labelling start at 0 using this elment list call u.residues[kkk-1].</span>
        
        <span class="c1"># Saving the new topology file</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">MD_file_name_topology</span> <span class="o">=</span> <span class="n">toolbox</span><span class="o">.</span><span class="n">concatenate_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_mol_times</span><span class="p">,</span> <span class="s1">&#39;frog_topology.pqr&#39;</span><span class="p">)</span>
        <span class="k">with</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">PQR</span><span class="o">.</span><span class="n">PQRWriter</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MD_file_name_topology</span><span class="p">)</span> <span class="k">as</span> <span class="n">Towrite</span><span class="p">:</span>
            <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">1</span><span class="p">:</span><span class="mi">1</span><span class="p">]:</span> <span class="c1"># to write only one frame (the topology file needs only one) </span>
                <span class="n">Towrite</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">u</span><span class="p">)</span></div>

        
<span class="c1">#################################################################################################################################        </span>
        
<div class="viewcode-block" id="GlobalParameter.cut_trajectory">
<a class="viewcode-back" href="../../GlobalParameter/gp_all.html#Frog.class_GP.GlobalParameter.cut_trajectory">[docs]</a>
    <span class="k">def</span> <span class="nf">cut_trajectory</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">MD_cut_trajectory</span><span class="p">:</span>

            <span class="n">u</span> <span class="o">=</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">Universe</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">MD_file_name_topology</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">MD_file_name_traj</span><span class="p">,</span> <span class="nb">format</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">MD_file_type</span><span class="p">)</span>
            
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">L_time_step_management</span> <span class="o">=</span> <span class="p">[[</span><span class="n">K</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span> <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>  <span class="bp">self</span><span class="o">.</span><span class="n">nbr_parra</span><span class="p">,</span> <span class="mi">1</span><span class="p">)]</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">L_time_step_management</span> <span class="o">=</span> <span class="p">[[</span><span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="mi">1</span><span class="p">)]</span> <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span>  <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="mi">1</span><span class="p">)]</span> 
                <span class="k">for</span> <span class="n">K</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span>  <span class="bp">self</span><span class="o">.</span><span class="n">nbr_parra</span><span class="p">,</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">L_time_step_management</span><span class="o">.</span><span class="n">append</span><span class="p">([</span><span class="n">K</span><span class="o">*</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span> <span class="o">+</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">nbr_time_step_core</span><span class="p">[</span><span class="mi">0</span><span class="p">]])</span>
            
            <span class="k">for</span> <span class="n">time_step_management</span> <span class="ow">in</span> <span class="n">L_time_step_management</span><span class="p">:</span>
                <span class="k">for</span> <span class="n">time_step</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">time_step_management</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="p">(</span><span class="n">time_step_management</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">time_step_management</span><span class="p">[</span><span class="mi">1</span><span class="p">]),</span> <span class="mi">1</span><span class="p">):</span>
                    <span class="n">name_file_traj</span> <span class="o">=</span> <span class="n">toolbox</span><span class="o">.</span><span class="n">concatenate_path</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dir_mol_times</span><span class="p">,</span> <span class="s1">&#39;cut_trajectory_&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">time_step</span><span class="p">)</span> <span class="o">+</span> <span class="s1">&#39;.dcd&#39;</span><span class="p">)</span>
                    <span class="k">for</span> <span class="n">ts</span> <span class="ow">in</span> <span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">[</span><span class="n">time_step</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">trotter_step</span><span class="p">:</span><span class="n">time_step</span><span class="o">*</span><span class="bp">self</span><span class="o">.</span><span class="n">trotter_step</span><span class="o">+</span><span class="mi">1</span><span class="p">:</span><span class="bp">self</span><span class="o">.</span><span class="n">trotter_step</span><span class="p">]:</span>
                        <span class="k">with</span> <span class="n">MDAnalysis</span><span class="o">.</span><span class="n">coordinates</span><span class="o">.</span><span class="n">LAMMPS</span><span class="o">.</span><span class="n">DCDWriter</span><span class="p">(</span><span class="n">name_file_traj</span><span class="p">,</span> <span class="n">n_atoms</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">atoms</span><span class="o">.</span><span class="n">n_atoms</span><span class="p">)</span> <span class="k">as</span> <span class="n">Towrite</span><span class="p">:</span>
                            <span class="n">Towrite</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">u</span><span class="p">)</span></div>
</div>

            
    
<span class="c1">#################################################################################################################################       </span>
<span class="c1">#################################################################################################################################</span>
<span class="c1">#################################################################################################################################      </span>
</pre></div>

          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../../index.html">
    <img class="logo" src="../../_static/frog_logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../Installation/how_to_install_frog.html">1. How to Install Frog?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Tutorials/tutorial_index.html">2. Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../GlobalParameter/gp_index.html">3. Global Parameter</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../MoleculeType/mt_index.html">4. Molecule Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Diagram/diagram_index.html">5. Diagram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../OpticalAnalysis/optical_analysis_index.html">6. Optical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../Frog.html">7. Frog package</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Guillaume Le Breton.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
    </div>

    

    
  </body>
</html>