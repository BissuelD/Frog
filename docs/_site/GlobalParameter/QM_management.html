<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>3.4. QM Management &#8212; Frog 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../_static/_static/css/s4defs-roles.css" />
    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="3.5. None user defined" href="none_user_defined.html" />
    <link rel="prev" title="3.3. Directory Management" href="directory_management.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <blockquote>
<div></div></blockquote>
<section id="qm-management">
<span id="gp-qm-management-page"></span><h1><span class="section-number">3.4. </span>QM Management<a class="headerlink" href="#qm-management" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#scientific-parameter" id="id1">Scientific parameter</a></p></li>
<li><p><a class="reference internal" href="#numerical-parameter" id="id2">Numerical parameter</a></p></li>
</ul>
</nav>
<section id="scientific-parameter">
<h2><a class="toc-backref" href="#id1" role="doc-backlink"><span class="section-number">3.4.1. </span>Scientific parameter</a><a class="headerlink" href="#scientific-parameter" title="Link to this heading">¶</a></h2>
<dl class="py attribute" id="autodoc-gp-redo-qm">
<dt class="sig sig-object py" id="Frog.class_GP.GlobalParameter.redo_QM">
<span class="sig-prename descclassname"><span class="pre">GlobalParameter.</span></span><span class="sig-name descname"><span class="pre">redo_QM</span></span><a class="headerlink" href="#Frog.class_GP.GlobalParameter.redo_QM" title="Link to this definition">¶</a></dt>
<dd><p><strong>Type</strong> [string]</p>
<p>If set to ‘redo’, the QM calculation inputs are written in the first part for every molecule which need a QM calculation. The QM calculation should be then done in the second part to be read in the third part. This is the default.</p>
<p>If set to ‘do_not_redo’, Frog will try to check if the QM calculation for a molecule have been already performed. For a molecule which QM calculation have to be performed, it tries to open the expected Dalton result file. It check if the result is readable – meaning the QM calculation endded. If it is, the QM input for this configuration are not written, and the QM calculation is considerated are already performed. The results read in the third part are the one written in this file.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Frog does not check if the QM parameter for the target molecule (like the functional used) or the neighborhood is the same in the already available file and the input parameter. If you have a doubt, you should use  redo_QM = ‘redo’.</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GP</span><span class="o">.</span><span class="n">redo_QM</span> <span class="o">=</span> <span class="s1">&#39;redo&#39;</span>
</pre></div>
</div>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="py attribute" id="autodoc-gp-preference-functional">
<dt class="sig sig-object py" id="Frog.class_GP.GlobalParameter.preference_functional">
<span class="sig-prename descclassname"><span class="pre">GlobalParameter.</span></span><span class="sig-name descname"><span class="pre">preference_functional</span></span><a class="headerlink" href="#Frog.class_GP.GlobalParameter.preference_functional" title="Link to this definition">¶</a></dt>
<dd><p><strong>Type</strong> [list]</p>
<p>Defines which functional should be used in the case where several molecule or different MT are merged into one QM calculation. .</p>
<p class="rubric">Example</p>
<p>GP.preference_functional = [‘FunctionalA’, ‘FunctionalB’]</p>
<p>In this case, if one molecule has for functional the ‘FunctionalA’, and the other has ‘FunctionalB’ for its QMParameter, the final functional used for the graps of the 2 molecule will be ‘FunctionalA’.</p>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="numerical-parameter">
<span id="gp-qm-management-numerical-parameter-subpage"></span><h2><a class="toc-backref" href="#id2" role="doc-backlink"><span class="section-number">3.4.2. </span>Numerical parameter</a><a class="headerlink" href="#numerical-parameter" title="Link to this heading">¶</a></h2>
<p>You can change the following parameter from <img class="math" src="../_images/math/64ce76395a21d936e0f8a927bf1facabfed5a750.png" alt="\texttt{FROG}"/> call to <img class="math" src="../_images/math/64ce76395a21d936e0f8a927bf1facabfed5a750.png" alt="\texttt{FROG}"/> call to deal with the submission of QM calculation safely:</p>
<dl class="py attribute" id="autodoc-gp-file-template-script-run-qm">
<dt class="sig sig-object py" id="Frog.class_GP.GlobalParameter.file_template_script_run_QM">
<span class="sig-prename descclassname"><span class="pre">GlobalParameter.</span></span><span class="sig-name descname"><span class="pre">file_template_script_run_QM</span></span><a class="headerlink" href="#Frog.class_GP.GlobalParameter.file_template_script_run_QM" title="Link to this definition">¶</a></dt>
<dd><p><strong>Type</strong> [str]</p>
<p>The file used to create every submission script. The line relative to the QM run are added at the end of the script. Please note that the file name is update with GP.general_path. The created submission files are written in the GP.dir_submission_file directory.</p>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="py attribute" id="autodoc-gp-scratch-dir">
<dt class="sig sig-object py" id="Frog.class_GP.GlobalParameter.scratch_dir">
<span class="sig-prename descclassname"><span class="pre">GlobalParameter.</span></span><span class="sig-name descname"><span class="pre">scratch_dir</span></span><a class="headerlink" href="#Frog.class_GP.GlobalParameter.scratch_dir" title="Link to this definition">¶</a></dt>
<dd><p><strong>Type</strong> [str]</p>
<p>Define the directory where the temporary Dalton file will be written. Note that this directory is NOT the one where the result of the QM simulation is stored. By default, if the QM simulation ended without an error, these temporary file will be deleted.</p>
<p>However, if many QM calculation are running at the same time, a large amount of (disk) memory can be used. Therefore, we recommand to use a /tmp or a /scratch to perform these calculation.</p>
<p>Today, the chosen implementation is to write in the submission script the line: &lt; ‘export DALTON_TMPDIR=’ + scratch_dir &gt;.</p>
<p>Therefore, we recommand to use: scratch_dir = ‘$SCRATCH_DIR’, and to define the variable “SCRATCH_DIR” in the GP.file_template_script_run_QM. This way, you can define very precisly where the temporary file should be written within your (cluister) submission file. You can for instance define an automatic selection within the submission file to chose which scratch directory to use in function of the cluster/node it is run on.</p>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="py attribute" id="autodoc-gp-max-submission-qm">
<dt class="sig sig-object py" id="Frog.class_GP.GlobalParameter.max_submission_QM">
<span class="sig-prename descclassname"><span class="pre">GlobalParameter.</span></span><span class="sig-name descname"><span class="pre">max_submission_QM</span></span><a class="headerlink" href="#Frog.class_GP.GlobalParameter.max_submission_QM" title="Link to this definition">¶</a></dt>
<dd><p><strong>Type</strong> [int]</p>
<p>The number of jobs which can be prepared by the software to perform the QM simulations. This option has been made in order to avoid trouble when submitting a lot of job to a cluster – for instance sending 100 000 jobs to a cluster…</p>
<p>Using this option, you might not be able to perform all the QM simulation at the same time. If it is so, you should wait that the QM calculation already sent end, then re-run the programme in order to treat the rest of the QM simulation and resumit to the cluster the rest of the QM simulation.</p>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GP</span><span class="o">.</span><span class="n">max_submission_QM</span> <span class="o">=</span> <span class="mi">100</span>
</pre></div>
</div>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="py attribute" id="autodoc-gp-nbr-job-parr-qm">
<dt class="sig sig-object py" id="Frog.class_GP.GlobalParameter.nbr_job_parr_QM">
<span class="sig-prename descclassname"><span class="pre">GlobalParameter.</span></span><span class="sig-name descname"><span class="pre">nbr_job_parr_QM</span></span><a class="headerlink" href="#Frog.class_GP.GlobalParameter.nbr_job_parr_QM" title="Link to this definition">¶</a></dt>
<dd><p><strong>Type</strong> [int]</p>
<p>The number of QM simulation which run at the same time on a server.</p>
<p>For exemple, set to 1 to have one QM simulation runing for every jobs submitted to the cluster – for monocore CPUs.</p>
<p>Set 8 to have 8 QM simulations running for every jobs submitted to the cluster – designed to run on multicore CPUs. Note that no memory sharing is needed to perform several QM simulation on a single server (no OpenMPi mandatory) since every QM simulation can be performed independently.</p>
<p>The maximum number of QM simulation witch can be launched simultaneously is: nbr_job_parr_QM*max_submission_QM.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Please be aware that the memory needed for every QM simulation can be large: check the RAM available and where you write the temporary Dalton files. For instance, if 100 QM simulation are running on the same time on the cluster, a lot of reading/writting file will be occuring (temporary Dalton files) and may slow down the cluster. /tmp or a scratch directory should be used for these temporary file, see the scratch_dir variable.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The template used to define how to send job to the cluster (GP.file_template_script_run_QM) must match with this nbr_job_parr_QM. If the template ask only for 4 cores while nbr_job_parr_QM = 8 you may have some trouble. See the Tutorials.</p>
</div>
<p class="rubric">Example</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">GP</span><span class="o">.</span><span class="n">nbr_job_parr_QM</span> <span class="o">=</span> <span class="mi">16</span>
</pre></div>
</div>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="py attribute" id="autodoc-gp-command-launch-job">
<dt class="sig sig-object py" id="Frog.class_GP.GlobalParameter.command_launch_job">
<span class="sig-prename descclassname"><span class="pre">GlobalParameter.</span></span><span class="sig-name descname"><span class="pre">command_launch_job</span></span><a class="headerlink" href="#Frog.class_GP.GlobalParameter.command_launch_job" title="Link to this definition">¶</a></dt>
<dd><p><strong>Type</strong> [str]</p>
<p>The command to launch a sumission script in your cluster waiting queue. For instance ‘sbatch’ or ‘qsub’.</p>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/frog_logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Installation/how_to_install_frog.html">1. How to Install Frog?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials/tutorial_index.html">2. Tutorials</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="gp_index.html">3. Global Parameter</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="how_to_creat_GP.html">3.1. How to create GP?</a></li>
<li class="toctree-l2"><a class="reference internal" href="usual_parameters.html">3.2. Usual Parameters</a></li>
<li class="toctree-l2"><a class="reference internal" href="directory_management.html">3.3. Directory Management</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">3.4. QM Management</a></li>
<li class="toctree-l2"><a class="reference internal" href="none_user_defined.html">3.5. None user defined</a></li>
<li class="toctree-l2"><a class="reference internal" href="gp_all.html">3.6. All the GP parameters</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../MoleculeType/mt_index.html">4. Molecule Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Diagram/diagram_index.html">5. Diagram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OpticalAnalysis/optical_analysis_index.html">6. Optical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Mathematics/mathematical_index.html">7. Mathematical and Numerical Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Frog.html">8. Frog package</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Guillaume Le Breton.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/GlobalParameter/QM_management.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>