<!DOCTYPE html>

<html lang="en" data-content_root="../">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>4.2. Molecule Type structure &#8212; Frog 1.0.0 documentation</title>
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=4f649999" />
    <link rel="stylesheet" type="text/css" href="../_static/alabaster.css?v=039e1c02" />
    <link rel="stylesheet" type="text/css" href="../_static/_static/css/s4defs-roles.css" />
    <script src="../_static/documentation_options.js?v=8d563738"></script>
    <script src="../_static/doctools.js?v=888ff710"></script>
    <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="4.3. Single Molecule Parameter" href="single_molecule_parameter.html" />
    <link rel="prev" title="4.1. How to create MT" href="how_to_create_mt.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <blockquote>
<div></div></blockquote>
<section id="molecule-type-structure">
<span id="mt-structure-page"></span><h1><span class="section-number">4.2. </span>Molecule Type structure<a class="headerlink" href="#molecule-type-structure" title="Link to this heading">¶</a></h1>
<nav class="contents local" id="table-of-contents">
<p class="topic-title">Table of Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#core-information" id="id4">Core information</a></p></li>
<li><p><a class="reference internal" href="#internal-information" id="id5">Internal information</a></p></li>
<li><p><a class="reference internal" href="#molecule-type-parameter" id="id6">Molecule Type Parameter</a></p></li>
<li><p><a class="reference internal" href="#list-of-the-molecule" id="id7">List of the molecule</a></p></li>
<li><p><a class="reference internal" href="#single-molecule-object" id="id8">Single Molecule Object</a></p></li>
<li><p><a class="reference internal" href="#diagrams" id="id9">Diagrams</a></p></li>
</ul>
</nav>
<p>Here is a list of all the possible attribute of an MT object.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>These object should not be added directly since special function are defined for this purpose. However, at the end of the file, you can open this MT object in a python environment in order to check these attributes.</p>
</div>
<section id="core-information">
<h2><a class="toc-backref" href="#id4" role="doc-backlink"><span class="section-number">4.2.1. </span>Core information</a><a class="headerlink" href="#core-information" title="Link to this heading">¶</a></h2>
<p>To create the MT, you need to define the two following attributes: <a class="reference internal" href="#autodoc-mt-name"><span class="std std-ref">MoleculeType.name</span></a> and <a class="reference internal" href="#autodoc-mt-where-are-molecules"><span class="std std-ref">MoleculeType.where_are_molecules</span></a>. To do so, create the MT using:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">myMT</span> <span class="o">=</span> <span class="n">MoleculeType</span><span class="p">(</span><span class="n">GP</span><span class="p">,</span> <span class="n">name</span><span class="p">,</span> <span class="n">where_are_molecules</span><span class="p">)</span>
</pre></div>
</div>
<p>See <a class="reference internal" href="how_to_create_mt.html#how-to-create-mt-page"><span class="std std-ref">this page</span></a> for more informations.</p>
<dl class="py attribute" id="autodoc-mt-name">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">MoleculeType.</span></span><span class="sig-name descname"><span class="pre">name</span></span></dt>
<dd><p><strong>Type</strong> [string]</p>
<p>Name of the molecule type given when creating the instance (molecule_type_name argument). It is very important that this name refer to a molecule module defined in the frog library - for exemple, WaterTIP4P with the module WaterTIP4P.py. The name can be completly different from the one used during the MD simulation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Defined directly by the user when creating a new Molecule Type object. The name is the second input parameter</p>
</div>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="py attribute" id="autodoc-mt-where-are-molecules">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">MoleculeType.</span></span><span class="sig-name descname"><span class="pre">where_are_molecules</span></span></dt>
<dd><p><strong>Type</strong> [string or list]</p>
<p>Defined what molecule of the MD are considerated as a molecule of this type. 2 way of defining this is defined:</p>
<ul class="simple">
<li><p>‘all’: to assign all the molecule available in the MD to this Molecule Type.</p></li>
<li><dl class="simple">
<dt>A list of the first and the last molecule number.  It is very important to note that only concecutivelly labelled molecule can be assign to be part of the same molecule type.</dt><dd><p>Example: [1, 1700] to assign from the 1st molecule to the 1700th molecule, including the 1700th molecule.</p>
</dd>
</dl>
</li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Defined directly by the user when creating a new Molecule Type object. where_are_molecules is the third input parameter</p>
</div>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="internal-information">
<h2><a class="toc-backref" href="#id5" role="doc-backlink"><span class="section-number">4.2.2. </span>Internal information</a><a class="headerlink" href="#internal-information" title="Link to this heading">¶</a></h2>
<p>These attributes are used by <img class="math" src="../_images/math/64ce76395a21d936e0f8a927bf1facabfed5a750.png" alt="\texttt{FROG}"/> during the procedure. There are created according to the <a class="reference internal" href="#autodoc-mt-name"><span class="std std-ref">MoleculeType.name</span></a> and <a class="reference internal" href="#autodoc-mt-where-are-molecules"><span class="std std-ref">MoleculeType.where_are_molecules</span></a> attributes.</p>
<dl class="py attribute" id="autodoc-mt-l-key-mol">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">MoleculeType.</span></span><span class="sig-name descname"><span class="pre">L_key_mol</span></span></dt>
<dd><p><strong>Type</strong> [list of integer]</p>
<p>A list where every integer is the tag of a molecule of this Molecule Type. For instance, L_key_mol = [1, 2, 3] means that in the topology file, the molecule number 1, 2 and 3 are of this molecule type.</p>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="py attribute" id="autodoc-mt-l-key-selection-traj">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">MoleculeType.</span></span><span class="sig-name descname"><span class="pre">L_key_selection_traj</span></span></dt>
<dd><p><strong>Type</strong> [integer, integer]</p>
<p>The first and the last atom (labelling from the topology file) of the molecule type ensemble.</p>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="py attribute" id="autodoc-mt-population">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">MoleculeType.</span></span><span class="sig-name descname"><span class="pre">population</span></span></dt>
<dd><p><strong>Type</strong> [integer]</p>
<p>Number of molecule of this type.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The number of molecule and the topology shall not change during the MD.</p>
</div>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
</section>
<section id="molecule-type-parameter">
<h2><a class="toc-backref" href="#id6" role="doc-backlink"><span class="section-number">4.2.3. </span>Molecule Type Parameter</a><a class="headerlink" href="#molecule-type-parameter" title="Link to this heading">¶</a></h2>
<p>The MoleculeTypeParameter object (<a class="reference internal" href="#autodoc-mt-mtparameter"><span class="std std-ref">MoleculeType.mtparameter</span></a>) contains the parameters and important information relative to the MT. The mtparameter of an MT does not change after the initialization and is the same for every frame.</p>
<dl class="py attribute" id="autodoc-mt-mtparameter">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">MoleculeType.</span></span><span class="sig-name descname"><span class="pre">mtparameter</span></span></dt>
<dd><p><strong>Type</strong> [MoleculeTypeParameter]</p>
<p>The object containing the properties of this molecule type: what analysis should be perform with this molecule type as well as usefull information regarding the expected caracteristics of this molecule type. See the other object involves like SingleMoleculeParameter, DiagramParameter or OpticalParameter.</p>
</dd></dl>

<p>The mtparameter object contains the parameters relative to several part of <img class="math" src="../_images/math/64ce76395a21d936e0f8a927bf1facabfed5a750.png" alt="\texttt{FROG}"/>. There are:</p>
<ul class="simple">
<li><p>SingleMoleculeParameter: This object is fully defined in the molecular library file and contains information relative to the geometry of the molecule for instance. The <a class="reference internal" href="single_molecule_parameter.html#single-molecule-parameter-page"><span class="std std-ref">SingleMoleculeParameter object is presented here</span></a>.</p></li>
<li><p>DiagramParameter: The parameters relative to the diagrams of this MT. The <a class="reference internal" href="../Diagram/diagram_structure.html#diagram-parameter-page"><span class="std std-ref">DiagramParameter object is presented here</span></a></p></li>
<li><p>OpticalParameter: The parameters relative to the optical analysis and QM calculations. The <a class="reference internal" href="../OpticalAnalysis/optical_parameter.html#optical-parameter-page"><span class="std std-ref">OpticalParameter object is presented here</span></a>.</p></li>
</ul>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>To call an attribute from the dparameter, like L_diagram, use: <span class="incremental">myMT.mtparameter.dparameter.L_diagram</span>.</p>
</div>
<dl class="py attribute" id="autodoc-mtparameter-smparameter">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">MoleculeTypeParameter.</span></span><span class="sig-name descname"><span class="pre">smparameter</span></span></dt>
<dd><p><strong>Type</strong> [SingleMoleculeParameter]</p>
<p>Contains the SingleMoleculeParameter of this MT. See The SingleMoleculeParameter object for more information.</p>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="py attribute" id="autodoc-mtparameter-dparameter">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">MoleculeTypeParameter.</span></span><span class="sig-name descname"><span class="pre">dparameter</span></span></dt>
<dd><p><strong>Type</strong> [DiagramParameter]</p>
<p>Contains the DiagramParameter of this MT. See The DiagramParameter object for more information.</p>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<dl class="py attribute" id="autodoc-mtparameter-optparameter">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">MoleculeTypeParameter.</span></span><span class="sig-name descname"><span class="pre">optparameter</span></span></dt>
<dd><p><strong>Type</strong> [OpticalParameter]</p>
<p>Contains the OpticalParameter of this MT. See The OpticalParameter object for more information.</p>
</dd></dl>

</section>
<section id="list-of-the-molecule">
<h2><a class="toc-backref" href="#id7" role="doc-backlink"><span class="section-number">4.2.4. </span>List of the molecule</a><a class="headerlink" href="#list-of-the-molecule" title="Link to this heading">¶</a></h2>
<p>All the molecule at this time step are stored in the list: <a class="reference internal" href="#autodoc-mt-l-molecule"><span class="std std-ref">L_molecule</span></a>. Each molecules are described using an object from the class SingleMolecule REF – the object are usually called singlemolecule.</p>
<dl class="py attribute" id="autodoc-mt-l-molecule">
<dt class="sig sig-object py">
<span class="sig-prename descclassname"><span class="pre">MoleculeType.</span></span><span class="sig-name descname"><span class="pre">L_molecule</span></span></dt>
<dd><p><strong>Type</strong> [list of SingleMolecule]</p>
<p>A list of every molecule of this MT for a given time step. These object contains all the molecular properties computed by the software. For instance the molecule’s position, orientation, beta… See the SingleMolecule object.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you want to perform by yourself extra post-analysis, you may want to use this list. You can acces every molecule using myMT.L_molecule[molecule_number].whatever_individual_property. For instance,  myMT.L_molecule[100].electric_field_PE to acces the electric field felt by the 101th molecule of this MT at this time step.</p>
</div>
</dd></dl>

<div class="line-block">
<div class="line"><br /></div>
</div>
<p>You can call a molecule using: <span class="incremental">singlemolecule=myMT.L_molecule[2]</span> to have the third molecule of this MT. If you want to refer to the general labeling (for instance the molecule number 1000 from the MD may be the 2nd molecule of this Molecule Type ensemble), let’s say the label number is general_label, use:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">singlemolecule</span><span class="o">=</span><span class="n">myMT</span><span class="o">.</span><span class="n">L_molecule</span><span class="p">[</span><span class="n">general_label</span> <span class="o">-</span> <span class="n">myMT</span><span class="o">.</span><span class="n">L_key_mol</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
</pre></div>
</div>
<p>During the initialization, the list of the attribute of all these molecule will be update according to the analysis to perform. For instance, if the molecular orientation has to be computed, the attribute molecular_orientation will be initialized to False for every molecule. During the first step of the run, the value will be computed and update to the molecules. If you want to know all attribute defined for these molecules use the attribute L_attribute of a SingleMolecule object: singlemolecule.L_attribute. Each diagram will create new attribute depending of the analysis required, see HERE for more details.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some molecule may not have these attribute filled with value (therefore the value is False) if some special selection for the analysis are set. See <a class="reference internal" href="../Diagram/how_to_creat_diagram.html#diagram-geometry-selection-page"><span class="std std-ref">here</span></a> for the general diagram or <a class="reference internal" href="../OpticalAnalysis/optical_parameter.html#optical-property-which-molecule-should-be-qm-treated-subpage"><span class="std std-ref">here</span></a> for QM calculation.</p>
</div>
</section>
<section id="single-molecule-object">
<span id="single-molecule-object-page"></span><h2><a class="toc-backref" href="#id8" role="doc-backlink"><span class="section-number">4.2.5. </span>Single Molecule Object</a><a class="headerlink" href="#single-molecule-object" title="Link to this heading">¶</a></h2>
<p>Mettre:
mean position et comment on les as
layer et comment on les as et les assignements de pytim -&gt; frog
rot matrix et comment on les as</p>
<p>Pour le reste, mettre un lien vers les diagrams. C est la bas qu on defini les smolecule attribute qui sont cree par chaque analyse.</p>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<p>todo</p>
</div>
</section>
<section id="diagrams">
<span id="mt-how-diagram-are-stored-subpage"></span><h2><a class="toc-backref" href="#id9" role="doc-backlink"><span class="section-number">4.2.6. </span>Diagrams</a><a class="headerlink" href="#diagrams" title="Link to this heading">¶</a></h2>
<p>Each diagrams are directly added in the MT object using its own name as attribute name. In order to have the full list of the available diagrams, see the object myMT.dparameter.L_diagram. ADD LINK. These diagram are part of the general class Diagram. Each diagram has its own class defined, for instance Dia_density for the density, which inherite from the class Diagram. Using this architecture, each diagram as its own set of function defines.</p>
<p>To call and use the diagram, see HERE</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<p>Dans le MT on stacke directement les diagram avec comme nom d attribute le nom du diagram. Je trouve cela pratique, mais c est pas super propre. QUoique c est vraiment du details. A voir si on remet cela autre part?</p>
</div>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<p>Refaire ce paragraph in fois la partie diagram bien termine.</p>
</div>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/frog_logo.png" alt="Logo"/>
    
  </a>
</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../Installation/how_to_install_frog.html">1. How to Install Frog?</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Tutorials/tutorial_index.html">2. Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../GlobalParameter/gp_index.html">3. Global Parameter</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="mt_index.html">4. Molecule Type</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="how_to_create_mt.html">4.1. How to create MT</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">4.2. Molecule Type structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="single_molecule_parameter.html">4.3. Single Molecule Parameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="MolecularLibraryFile/available_mt.html">4.4. Available MT</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../Diagram/diagram_index.html">5. Diagram</a></li>
<li class="toctree-l1"><a class="reference internal" href="../OpticalAnalysis/optical_analysis_index.html">6. Optical Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Mathematics/mathematical_index.html">7. Mathematical and Numerical Index</a></li>
<li class="toctree-l1"><a class="reference internal" href="../Frog.html">8. Frog package</a></li>
</ul>


<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2020, Guillaume Le Breton.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 7.2.5</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="../_sources/MoleculeType/mt_structure.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>